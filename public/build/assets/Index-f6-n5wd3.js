import{r as h,h as Y,N as ae,k as O,l as ne,c as m,a as d,u as a,Z as le,w as j,b as t,e as re,g as k,t as r,o as u,n as E,f as ie,m as ce,F as A,p as de}from"./app-DBmEpP_-.js";import{_ as ue}from"./AuthenticatedLayout-D0uvWJ6p.js";import{d as B}from"./dayjs.min-Z4LNoRjb.js";import me from"./FinanceHeader-YTRt_XAW.js";import ge from"./FinanceStats-ARKltcYe.js";import fe from"./BudgetSidebar-BhYnblaR.js";import ve from"./TransactionModal-Wh9vFMl4.js";import pe from"./BudgetModal-DRKqbaMb.js";import he from"./CategoryModal-CEvsZgZg.js";import xe from"./DailyTrendChart-BSLqusQS.js";import be from"./ArchiveModal-jdKJuXdY.js";import{u as _e,F as ye}from"./FinanceInsights-BFjApyoU.js";import{u as S}from"./useFinanceFormat-CB7TYyOT.js";import"./en-B63u2pIa.js";import{u as we}from"./useFinanceHistory-CWySd9Cu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./FinanceDatePicker-ZeYbh6ar.js";import"./localeData-DZQ_ORQ7.js";import"./index-LkhnIfyr.js";import"./Modal-CtEAoQmQ.js";import"./sweetalert2.esm.all-AlKuj1Cq.js";function Me(i){const{activeLocale:c}=S(),n=h(B(i)),l=Y(()=>!c||!c.value?"en":c.value.split("-")[0]),C=v=>{let g;v==="next"?g=n.value.add(1,"month"):v==="prev"?g=n.value.subtract(1,"month"):g=B(`${v}-01`),n.value=g,ae.get(route("finance.index"),{date:g.format("YYYY-MM-DD")},{preserveState:!0,preserveScroll:!0,replace:!0,only:["transactions","budgets","stats","filters"]})},D=Y(()=>n.value.locale(l.value).format("MMMM YYYY")),F=Y(()=>n.value.format("YYYY-MM"));return{currentDate:n,changeMonth:C,formattedMonth:D,currentMonthKey:F}}const ke={class:"w-full min-h-screen bg-slate-50/50 px-4 sm:px-6 lg:px-8 py-8"},Ce={class:"mb-8"},De={class:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start"},Fe={class:"lg:col-span-3 space-y-8 w-full"},$e={class:"space-y-4"},Ye={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},Be={class:"flex items-center gap-2"},Te={class:"text-lg font-bold text-slate-800"},Oe={key:0,class:"text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded-lg"},je={key:1,class:"text-[10px] font-bold text-indigo-500 bg-indigo-50 px-2 py-1 rounded-lg"},Ee={class:"relative z-30"},Ae={class:"flex items-center gap-2"},Se={class:"absolute right-3 text-slate-400 text-[10px]"},Le={key:0,class:"absolute right-0 top-full mt-2 z-50 origin-top-right shadow-2xl rounded-3xl bg-white p-4 w-72 border border-slate-100"},Ne={key:0,class:"text-center py-12 bg-white rounded-3xl border border-dashed border-slate-200"},ze={class:"text-slate-400 text-sm font-medium"},Ie={key:1,class:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden divide-y divide-slate-50"},He=["onClick"],Ke={class:"flex items-center gap-4"},Pe={class:"w-12 h-12 rounded-xl bg-slate-50 border border-slate-100 flex flex-col items-center justify-center group-hover:bg-white transition-all shadow-sm"},Ve={class:"text-[10px] uppercase font-black text-slate-400 leading-none"},Ue={class:"text-xl font-black leading-none text-slate-700 mt-0.5"},Ze={class:"font-bold text-slate-700 text-sm capitalize"},qe={class:"text-[11px] text-slate-400 font-bold bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100 mt-1 inline-block"},Ge={class:"flex items-center gap-6"},Je={class:"pl-4 border-l border-slate-100 text-right"},Qe={class:"block text-[9px] font-bold text-slate-400 uppercase tracking-wider"},Re={key:0,class:"bg-slate-50/50 p-2.5 text-center border-t border-slate-100"},We={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},Xe={class:"lg:col-span-2 w-full md:sticky md:top-24 h-fit space-y-6"},yt={__name:"Index",props:{transactions:Array,budgets:Array,stats:Object,filters:Object,categories:Array},setup(i){const c=i,n=h([...c.transactions]),l=h([...c.budgets]);O(()=>c.transactions,e=>n.value=[...e],{deep:!0}),O(()=>c.budgets,e=>l.value=[...e],{deep:!0});const C=ne({...c,get transactions(){return n.value},get budgets(){return l.value}}),{formattedMonth:D,changeMonth:F,currentMonthKey:v}=Me(c.filters.date),{transactionForm:g,setEditTransaction:L,submitTransaction:N,deleteTransaction:z,budgetForm:f,submitBudget:I,deleteBudget:H,categoryForm:x,setEditCategory:K,submitCategory:P,deleteCategory:V,updateIncomeTarget:U}=_e(),b=h(!1),_=h(!1),y=h(!1),w=h(!1),{visibleStats:T,filterDate:p,isArchiveOpen:$,selectedDayData:Z,openDetail:q}=we(C),{formatMoney:G}=S(),J=e=>{L(e),b.value=!0},Q=e=>{const o=c.categories.find(s=>s.slug===e.category);f.id=e.id,f.category=e.category,f.name=o?o.name:e.category,f.icon=o?o.icon:"ðŸ’¸",f.limit_amount=e.limit_amount,f.month=e.month||v.value,_.value=!0},R=e=>{x.id=e.id,K(e),y.value=!0},W=()=>{x.reset(),x.id=null,y.value=!0},X=e=>{V(e.id),y.value=!1},ee=()=>{b.value=!1,N({onOptimistic:(e,o)=>{if(o){const s=n.value.findIndex(M=>M.id===e.id);s!==-1&&Object.assign(n.value[s],e)}else n.value.unshift(e)},onError:(e,o)=>{o||(n.value=n.value.filter(s=>s.id!==e)),b.value=!0}})},te=e=>{$.value=!1,z(e,{onOptimistic:o=>{n.value=n.value.filter(s=>s.id!==o)}})},se=()=>{_.value=!1,I(v.value,{onOptimistic:(e,o)=>{if(o){const s=l.value.findIndex(M=>M.id===e.id);s!==-1&&Object.assign(l.value[s],e)}else l.value.push(e)},onError:(e,o)=>{o||(l.value=l.value.filter(s=>s.id!==e)),_.value=!0}})},oe=e=>{H(e,{onOptimistic:o=>{l.value=l.value.filter(s=>s.id!==o)}})};return(e,o)=>(u(),m(A,null,[d(a(le),{title:"Finance Plan"}),d(ue,null,{default:j(()=>[d(me,{currentMonth:a(D),currentMonthKey:a(v),onChangeDate:s=>a(F)(s),onAddClick:()=>{a(g).reset(),a(g).id=null,b.value=!0}},null,8,["currentMonth","currentMonthKey","onChangeDate","onAddClick"]),t("div",ke,[t("div",Ce,[d(ge,{stats:i.stats,onUpdateTarget:s=>a(U)(a(v),s)},null,8,["stats","onUpdateTarget"])]),t("div",De,[t("div",Fe,[t("div",$e,[t("div",Ye,[t("div",Be,[t("h3",Te,r(e.$t("daily_history")),1),a(p)?(u(),m("span",je,r(e.$t("search_result")),1)):(u(),m("span",Oe,r(e.$t("last_5")),1))]),t("div",Ee,[t("div",Ae,[t("button",{onClick:o[0]||(o[0]=s=>w.value=!w.value),class:E(["pl-3 pr-8 py-2 text-xs font-bold bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-300 hover:ring-2 hover:ring-indigo-500/10 transition-all flex items-center gap-2 min-w-[150px] relative",a(p)?"text-indigo-600 border-indigo-200":"text-slate-500"])},[o[3]||(o[3]=t("span",{class:"text-base"},"ðŸ“…",-1)),t("span",null,r(a(p)?a(B)(a(p)).locale("id").format("DD MMM YYYY"):"Filter Tanggal"),1),t("span",Se,r(w.value?"â–²":"â–¼"),1)],2),a(p)?(u(),m("button",{key:0,onClick:o[1]||(o[1]=ie(s=>p.value="",["stop"])),class:"text-slate-300 hover:text-rose-500 hover:bg-rose-50 p-1.5 rounded-lg transition-all border border-transparent hover:border-rose-100",title:"Hapus Filter"},[...o[4]||(o[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])):k("",!0)]),d(ce,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:j(()=>[w.value?(u(),m("div",Le,[...o[5]||(o[5]=[t("p",{class:"text-xs text-center text-slate-400"},"Pilih Tanggal (Component Calendar Here)",-1)])])):k("",!0)]),_:1})])]),n.value.length===0?(u(),m("div",Ne,[o[6]||(o[6]=t("div",{class:"text-3xl mb-2"},"ðŸ“’",-1)),t("p",ze,r(e.$t("no_transaction")),1)])):(u(),m("div",Ie,[(u(!0),m(A,null,de(a(T),s=>(u(),m("div",{key:s.date,onClick:M=>a(q)(s),class:"group p-4 flex items-center justify-between hover:bg-indigo-50/50 transition-colors cursor-pointer"},[t("div",Ke,[t("div",Pe,[t("span",Ve,r(s.dateObj.format("MMM")),1),t("span",Ue,r(s.dateObj.format("DD")),1)]),t("div",null,[t("h4",Ze,r(s.dateObj.format("dddd")),1),t("span",qe,r(e.$t("transaction_count",{count:s.transactions.length})),1)])]),t("div",Ge,[t("div",Je,[t("span",Qe,r(e.$t("daily_net")),1),t("span",{class:E(["text-sm font-black font-mono",s.total_income-s.total_expense>=0?"text-indigo-600":"text-orange-500"])},r(s.total_income-s.total_expense>=0?"+":"")+r(a(G)(s.total_income-s.total_expense)),3)]),o[7]||(o[7]=t("span",{class:"text-slate-300 group-hover:text-indigo-400 transition-colors"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})])],-1))])],8,He))),128)),!a(p)&&a(T).length===5?(u(),m("div",Re,[t("p",We,r(e.$t("old_data_hint")),1)])):k("",!0)])),d(be,{show:a($),dayData:a(Z),categories:i.categories,close:()=>$.value=!1,onDelete:te,onEdit:J},null,8,["show","dayData","categories","close"])]),n.value.length?(u(),re(xe,{key:0,transactions:n.value,currentDate:i.filters.date},null,8,["transactions","currentDate"])):k("",!0)]),t("div",Xe,[d(fe,{budgets:l.value,categories:i.categories,expenseStats:i.stats.expense_by_category,incomeStats:i.stats.income_by_category,onAdd:o[2]||(o[2]=()=>{a(f).reset(),a(f).id=null,_.value=!0}),onDeleteBudget:oe,onEditBudget:Q,onAddCategory:W,onEditCategory:R,onDeleteCategory:X},null,8,["budgets","categories","expenseStats","incomeStats"]),d(ye,{"expense-stats":i.stats.expense_by_category,"income-stats":i.stats.income_by_category,budgets:l.value},null,8,["expense-stats","income-stats","budgets"])])]),d(ve,{show:b.value,form:a(g),budgets:l.value,categories:i.categories,close:()=>b.value=!1,submit:ee},null,8,["show","form","budgets","categories","close"]),d(pe,{show:_.value,form:a(f),categories:i.categories,close:()=>_.value=!1,submit:se},null,8,["show","form","categories","close"]),d(he,{show:y.value,form:a(x),close:()=>y.value=!1,submit:()=>a(P)(a(x).id?{id:a(x).id}:null,()=>{y.value=!1})},null,8,["show","form","close","submit"])])]),_:1})],64))}};export{yt as default};
