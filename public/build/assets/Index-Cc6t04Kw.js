import{r as g,p as H,T as I,t as J,a as L,b as D,d as O,u as o,Z as P,F as V,o as W}from"./vendor-vue-DauRGcU0.js";import{A as K}from"./AuthenticatedLayout-CBYjT401.js";import{d as u,i as Z,a as q}from"./vendor-core-CR-nZrr5.js";import{S as E}from"./vendor-utils-DJxZWvYm.js";import{N as k}from"./vendor-inertia-DdYq9B8h.js";import G from"./CalendarHeader-Bh2vCdIO.js";import Q from"./CalendarGrid-CbTPxKoI.js";import R from"./CalendarEventModal-C5pPv8H5.js";import U from"./CalendarDayDetail-0pOPCnjJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";u.extend(Z);u.extend(q);function X(e){const s=g(u().format("YYYY-MM-DD")),l=g(!1),t=m=>{s.value=m,l.value=!0},_=H(()=>{var y,c,b,M,w,Y,C,B,S;const m=e.currentMonth||u().format("YYYY-MM"),f=u(m).startOf("month");u(m).endOf("month");const a=f.daysInMonth(),n=f.day()===0?6:f.day()-1;let r=[];for(let i=0;i<n;i++)r.push({isCurrentMonth:!1,date:null});for(let i=1;i<=a;i++){const d=f.date(i).format("YYYY-MM-DD"),N=((c=(y=e.data)==null?void 0:y.events)==null?void 0:c.filter(h=>h.end_date?u(d).isBetween(h.start_date,h.end_date,"day","[]"):h.start_date===d))||[],j=((M=(b=e.data)==null?void 0:b.journals)==null?void 0:M[d])||null,$=((Y=(w=e.data)==null?void 0:w.finances)==null?void 0:Y[d])||0,F=((B=(C=e.data)==null?void 0:C.habits)==null?void 0:B[d])||0;let v=null;if((S=e.data)!=null&&S.planners)if(e.data.planners[d])v=e.data.planners[d];else{const h=Object.keys(e.data.planners).find(z=>String(z).startsWith(d));h&&(v=e.data.planners[h])}const A=v?{done:Number(v.completed_tasks||0),total:Number(v.total_tasks||0)}:null;r.push({isCurrentMonth:!0,date:d,dayNumber:i,isToday:d===u().format("YYYY-MM-DD"),events:N,hasJournal:!!j,expense:$,planner:A,habitDone:Number(F)})}const p=r.length,x=p%7===0?0:7-p%7;for(let i=0;i<x;i++)r.push({isCurrentMonth:!1,date:null});return r});return{selectedDate:s,isDetailModalOpen:l,openDayDetail:t,calendarDays:_}}function T(){const e=(a,n)=>{const r=J(a);return r!==a?r:n},s=(a,n)=>{E.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,background:"#4f46e5",iconColor:"#ffffff",icon:a,title:`<span style="color: white; font-weight: 900; font-size: 14px; line-height: 1.2;">${n}</span>`,customClass:{container:"!fixed !top-5 !right-5 !p-0 !z-[100000] !items-start !justify-end",popup:"!flex !items-center !gap-3 !py-3 !px-6 !rounded-full !shadow-2xl !border-none !m-0 !w-auto !min-w-[280px]",timerProgressBar:"!bg-white/40 !h-1 !rounded-b-full"}})},l=g(!1),t=I({id:null,title:"",description:"",type:"event",color:"#4f46e5",start_date:u().format("YYYY-MM-DD"),end_date:"",is_all_day:!0,start_time:"",end_time:""});return{t:e,fireToast:s,isEventModalOpen:l,eventForm:t,openEventModal:(a=null,n=null)=>{t.reset(),t.clearErrors(),n?(t.id=n.id,t.title=n.title,t.description=n.description||"",t.type=n.type||"event",t.color=n.color||"#4f46e5",t.start_date=n.start_date,t.end_date=n.end_date||"",t.is_all_day=n.is_all_day,t.start_time=n.start_time||"",t.end_time=n.end_time||""):t.start_date=a||u().format("YYYY-MM-DD"),l.value=!0},submitEvent:()=>{if(!t.title)return s("warning",e("warn_empty_title","Judul harus diisi!"));const a=!!t.id,n=a?route("calendar.events.update",t.id):route("calendar.events.store"),r=a?"put":"post";l.value=!1,t[r](n,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{s("success",e("success_saved","Acara Berhasil Disimpan!")),t.reset()},onError:p=>{l.value=!0,s("error",Object.values(p)[0])}})},deleteEvent:a=>{E.fire({title:e("confirm_delete_title","Hapus Acara?"),text:e("confirm_delete_text","Data ini akan dihapus permanen."),icon:"warning",showCancelButton:!0,confirmButtonText:e("btn_yes_delete","Ya, Hapus"),cancelButtonText:e("btn_cancel","Batal"),customClass:{popup:"rounded-[2.5rem] p-8 border border-slate-100 shadow-2xl",title:"text-2xl font-black text-slate-800 mb-2 font-sans",confirmButton:"bg-rose-500 text-white font-bold py-3.5 px-8 rounded-2xl shadow-xl shadow-rose-200 active:scale-95 transition-all outline-none mx-2 tracking-wide",cancelButton:"bg-slate-50 text-slate-400 font-bold py-3.5 px-8 rounded-2xl hover:bg-slate-100 active:scale-95 transition-all outline-none mx-2 tracking-wide",actions:"mt-6 gap-3"},buttonsStyling:!1}).then(n=>{n.isConfirmed&&k.delete(route("calendar.events.destroy",a),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{s("success",e("success_deleted","Berhasil Dihapus!"))}})})}}}function ee(e){const s=X(e),l=T();return{...s,...l}}const te={class:"w-full min-h-screen bg-slate-50/50 pb-12 relative overflow-x-hidden"},ne={class:"w-full px-4 py-6 sm:px-6 lg:px-8 max-w-full mx-auto"},me=Object.assign({layout:K},{__name:"Index",props:{currentMonth:String,data:Object},setup(e){const s=e,{selectedDate:l,isEventModalOpen:t,isDetailModalOpen:_,eventForm:m,openEventModal:f,submitEvent:a,deleteEvent:n,openDayDetail:r,calendarDays:p}=ee(s),x=y=>{k.get(route("calendar.index"),{month:y},{preserveState:!0,preserveScroll:!0,progress:!1})};return(y,c)=>(W(),L(V,null,[D(o(P),{title:y.$t("calendar_title","Master Calendar")},null,8,["title"]),O("div",te,[D(G,{currentMonth:e.currentMonth,onChangeMonth:x,onAddEvent:c[0]||(c[0]=()=>o(f)())},null,8,["currentMonth"]),O("div",ne,[D(Q,{calendarDays:o(p),onOpenDetail:o(r)},null,8,["calendarDays","onOpenDetail"])]),D(R,{show:o(t),form:o(m),onClose:c[1]||(c[1]=b=>t.value=!1),onSubmit:o(a)},null,8,["show","form","onSubmit"]),D(U,{show:o(_),date:o(l),calendarDays:o(p),onClose:c[2]||(c[2]=b=>_.value=!1),onEditEvent:o(f),onDeleteEvent:o(n)},null,8,["show","date","calendarDays","onEditEvent","onDeleteEvent"])])],64))}});export{me as default};
