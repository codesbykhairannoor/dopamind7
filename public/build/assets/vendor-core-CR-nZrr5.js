var ly=Object.defineProperty;var cy=(n,t,e)=>t in n?ly(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var V=(n,t,e)=>cy(n,typeof t!="symbol"?t+"":t,e);var Pe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function uy(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}var fy=function(t){return hy(t)&&!dy(t)};function hy(n){return!!n&&typeof n=="object"}function dy(n){var t=Object.prototype.toString.call(n);return t==="[object RegExp]"||t==="[object Date]"||gy(n)}var py=typeof Symbol=="function"&&Symbol.for,my=py?Symbol.for("react.element"):60103;function gy(n){return n.$$typeof===my}function yy(n){return Array.isArray(n)?[]:{}}function ai(n,t){return t.clone!==!1&&t.isMergeableObject(n)?ir(yy(n),n,t):n}function by(n,t,e){return n.concat(t).map(function(r){return ai(r,e)})}function xy(n,t){if(!t.customMerge)return ir;var e=t.customMerge(n);return typeof e=="function"?e:ir}function vy(n){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n).filter(function(t){return Object.propertyIsEnumerable.call(n,t)}):[]}function qc(n){return Object.keys(n).concat(vy(n))}function ud(n,t){try{return t in n}catch{return!1}}function ky(n,t){return ud(n,t)&&!(Object.hasOwnProperty.call(n,t)&&Object.propertyIsEnumerable.call(n,t))}function Sy(n,t,e){var r={};return e.isMergeableObject(n)&&qc(n).forEach(function(i){r[i]=ai(n[i],e)}),qc(t).forEach(function(i){ky(n,i)||(ud(n,i)&&e.isMergeableObject(t[i])?r[i]=xy(i,e)(n[i],t[i],e):r[i]=ai(t[i],e))}),r}function ir(n,t,e){e=e||{},e.arrayMerge=e.arrayMerge||by,e.isMergeableObject=e.isMergeableObject||fy,e.cloneUnlessOtherwiseSpecified=ai;var r=Array.isArray(t),i=Array.isArray(n),s=r===i;return s?r?e.arrayMerge(n,t,e):Sy(n,t,e):ai(t,e)}ir.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(r,i){return ir(r,i,e)},{})};var wy=ir,My=wy;const DE=yr(My);var br=TypeError;const Cy={},Ty=Object.freeze(Object.defineProperty({__proto__:null,default:Cy},Symbol.toStringTag,{value:"Module"})),Oy=uy(Ty);var Vl=typeof Map=="function"&&Map.prototype,qo=Object.getOwnPropertyDescriptor&&Vl?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,xs=Vl&&qo&&typeof qo.get=="function"?qo.get:null,Jc=Vl&&Map.prototype.forEach,Wl=typeof Set=="function"&&Set.prototype,Jo=Object.getOwnPropertyDescriptor&&Wl?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,vs=Wl&&Jo&&typeof Jo.get=="function"?Jo.get:null,Yc=Wl&&Set.prototype.forEach,_y=typeof WeakMap=="function"&&WeakMap.prototype,Fr=_y?WeakMap.prototype.has:null,Ey=typeof WeakSet=="function"&&WeakSet.prototype,Hr=Ey?WeakSet.prototype.has:null,Ay=typeof WeakRef=="function"&&WeakRef.prototype,Gc=Ay?WeakRef.prototype.deref:null,Dy=Boolean.prototype.valueOf,Py=Object.prototype.toString,Ny=Function.prototype.toString,Iy=String.prototype.match,jl=String.prototype.slice,We=String.prototype.replace,Ry=String.prototype.toUpperCase,Xc=String.prototype.toLowerCase,fd=RegExp.prototype.test,Qc=Array.prototype.concat,ge=Array.prototype.join,Ly=Array.prototype.slice,Zc=Math.floor,Xa=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Yo=Object.getOwnPropertySymbols,Qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,sr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Vr=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===sr||!0)?Symbol.toStringTag:null,hd=Object.prototype.propertyIsEnumerable,tu=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function eu(n,t){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||fd.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var r=n<0?-Zc(-n):Zc(n);if(r!==n){var i=String(r),s=jl.call(t,i.length+1);return We.call(i,e,"$&_")+"."+We.call(We.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return We.call(t,e,"$&_")}var Za=Oy,nu=Za.custom,ru=md(nu)?nu:null,dd={__proto__:null,double:'"',single:"'"},By={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},ko=function n(t,e,r,i){var s=e||{};if(Te(s,"quoteStyle")&&!Te(dd,s.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Te(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Te(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Te(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Te(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return yd(t,s);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var l=String(t);return a?eu(t,l):l}if(typeof t=="bigint"){var c=String(t)+"n";return a?eu(t,c):c}var u=typeof s.depth>"u"?5:s.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof t=="object")return tl(t)?"[Array]":"[Object]";var f=eb(s,r);if(typeof i>"u")i=[];else if(gd(i,t)>=0)return"[Circular]";function h(K,D,C){if(D&&(i=Ly.call(i),i.push(D)),C){var T={depth:s.depth};return Te(s,"quoteStyle")&&(T.quoteStyle=s.quoteStyle),n(K,T,r+1,i)}return n(K,s,r+1,i)}if(typeof t=="function"&&!iu(t)){var d=Ky(t),p=Ri(t,h);return"[Function"+(d?": "+d:" (anonymous)")+"]"+(p.length>0?" { "+ge.call(p,", ")+" }":"")}if(md(t)){var m=sr?We.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Qa.call(t);return typeof t=="object"&&!sr?wr(m):m}if(Qy(t)){for(var g="<"+Xc.call(String(t.nodeName)),y=t.attributes||[],b=0;b<y.length;b++)g+=" "+y[b].name+"="+pd($y(y[b].value),"double",s);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+Xc.call(String(t.nodeName))+">",g}if(tl(t)){if(t.length===0)return"[]";var v=Ri(t,h);return f&&!tb(v)?"["+el(v,f)+"]":"[ "+ge.call(v,", ")+" ]"}if(Fy(t)){var k=Ri(t,h);return!("cause"in Error.prototype)&&"cause"in t&&!hd.call(t,"cause")?"{ ["+String(t)+"] "+ge.call(Qc.call("[cause]: "+h(t.cause),k),", ")+" }":k.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+ge.call(k,", ")+" }"}if(typeof t=="object"&&o){if(ru&&typeof t[ru]=="function"&&Za)return Za(t,{depth:u-r});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(qy(t)){var x=[];return Jc&&Jc.call(t,function(K,D){x.push(h(D,t,!0)+" => "+h(K,t))}),su("Map",xs.call(t),x,f)}if(Gy(t)){var w=[];return Yc&&Yc.call(t,function(K){w.push(h(K,t))}),su("Set",vs.call(t),w,f)}if(Jy(t))return Go("WeakMap");if(Xy(t))return Go("WeakSet");if(Yy(t))return Go("WeakRef");if(Vy(t))return wr(h(Number(t)));if(jy(t))return wr(h(Xa.call(t)));if(Wy(t))return wr(Dy.call(t));if(Hy(t))return wr(h(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof Pe<"u"&&t===Pe)return"{ [object globalThis] }";if(!zy(t)&&!iu(t)){var S=Ri(t,h),M=tu?tu(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?"":"null prototype",I=!M&&Vr&&Object(t)===t&&Vr in t?jl.call(sn(t),8,-1):E?"Object":"",A=M||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",z=A+(I||E?"["+ge.call(Qc.call([],I||[],E||[]),": ")+"] ":"");return S.length===0?z+"{}":f?z+"{"+el(S,f)+"}":z+"{ "+ge.call(S,", ")+" }"}return String(t)};function pd(n,t,e){var r=e.quoteStyle||t,i=dd[r];return i+n+i}function $y(n){return We.call(String(n),/"/g,"&quot;")}function zn(n){return!Vr||!(typeof n=="object"&&(Vr in n||typeof n[Vr]<"u"))}function tl(n){return sn(n)==="[object Array]"&&zn(n)}function zy(n){return sn(n)==="[object Date]"&&zn(n)}function iu(n){return sn(n)==="[object RegExp]"&&zn(n)}function Fy(n){return sn(n)==="[object Error]"&&zn(n)}function Hy(n){return sn(n)==="[object String]"&&zn(n)}function Vy(n){return sn(n)==="[object Number]"&&zn(n)}function Wy(n){return sn(n)==="[object Boolean]"&&zn(n)}function md(n){if(sr)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!Qa)return!1;try{return Qa.call(n),!0}catch{}return!1}function jy(n){if(!n||typeof n!="object"||!Xa)return!1;try{return Xa.call(n),!0}catch{}return!1}var Uy=Object.prototype.hasOwnProperty||function(n){return n in this};function Te(n,t){return Uy.call(n,t)}function sn(n){return Py.call(n)}function Ky(n){if(n.name)return n.name;var t=Iy.call(Ny.call(n),/^function\s*([\w$]+)/);return t?t[1]:null}function gd(n,t){if(n.indexOf)return n.indexOf(t);for(var e=0,r=n.length;e<r;e++)if(n[e]===t)return e;return-1}function qy(n){if(!xs||!n||typeof n!="object")return!1;try{xs.call(n);try{vs.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function Jy(n){if(!Fr||!n||typeof n!="object")return!1;try{Fr.call(n,Fr);try{Hr.call(n,Hr)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function Yy(n){if(!Gc||!n||typeof n!="object")return!1;try{return Gc.call(n),!0}catch{}return!1}function Gy(n){if(!vs||!n||typeof n!="object")return!1;try{vs.call(n);try{xs.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function Xy(n){if(!Hr||!n||typeof n!="object")return!1;try{Hr.call(n,Hr);try{Fr.call(n,Fr)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function Qy(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function yd(n,t){if(n.length>t.maxStringLength){var e=n.length-t.maxStringLength,r="... "+e+" more character"+(e>1?"s":"");return yd(jl.call(n,0,t.maxStringLength),t)+r}var i=By[t.quoteStyle||"single"];i.lastIndex=0;var s=We.call(We.call(n,i,"\\$1"),/[\x00-\x1f]/g,Zy);return pd(s,"single",t)}function Zy(n){var t=n.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+Ry.call(t.toString(16))}function wr(n){return"Object("+n+")"}function Go(n){return n+" { ? }"}function su(n,t,e,r){var i=r?el(e,r):ge.call(e,", ");return n+" ("+t+") {"+i+"}"}function tb(n){for(var t=0;t<n.length;t++)if(gd(n[t],`
`)>=0)return!1;return!0}function eb(n,t){var e;if(n.indent==="	")e="	";else if(typeof n.indent=="number"&&n.indent>0)e=ge.call(Array(n.indent+1)," ");else return null;return{base:e,prev:ge.call(Array(t+1),e)}}function el(n,t){if(n.length===0)return"";var e=`
`+t.prev+t.base;return e+ge.call(n,","+e)+`
`+t.prev}function Ri(n,t){var e=tl(n),r=[];if(e){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=Te(n,i)?t(n[i],n):""}var s=typeof Yo=="function"?Yo(n):[],o;if(sr){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in n)Te(n,l)&&(e&&String(Number(l))===l&&l<n.length||sr&&o["$"+l]instanceof Symbol||(fd.call(/[^\w$]/,l)?r.push(t(l,n)+": "+t(n[l],n)):r.push(l+": "+t(n[l],n))));if(typeof Yo=="function")for(var c=0;c<s.length;c++)hd.call(n,s[c])&&r.push("["+t(s[c])+"]: "+t(n[s[c]],n));return r}var nb=ko,rb=br,So=function(n,t,e){for(var r=n,i;(i=r.next)!=null;r=i)if(i.key===t)return r.next=i.next,e||(i.next=n.next,n.next=i),i},ib=function(n,t){if(n){var e=So(n,t);return e&&e.value}},sb=function(n,t,e){var r=So(n,t);r?r.value=e:n.next={key:t,next:n.next,value:e}},ob=function(n,t){return n?!!So(n,t):!1},ab=function(n,t){if(n)return So(n,t,!0)},lb=function(){var t,e={assert:function(r){if(!e.has(r))throw new rb("Side channel does not contain "+nb(r))},delete:function(r){var i=t&&t.next,s=ab(t,r);return s&&i&&i===s&&(t=void 0),!!s},get:function(r){return ib(t,r)},has:function(r){return ob(t,r)},set:function(r,i){t||(t={next:void 0}),sb(t,r,i)}};return e},bd=Object,cb=Error,ub=EvalError,fb=RangeError,hb=ReferenceError,db=SyntaxError,pb=URIError,mb=Math.abs,gb=Math.floor,yb=Math.max,bb=Math.min,xb=Math.pow,vb=Math.round,kb=Number.isNaN||function(t){return t!==t},Sb=kb,wb=function(t){return Sb(t)||t===0?t:t<0?-1:1},Mb=Object.getOwnPropertyDescriptor,ls=Mb;if(ls)try{ls([],"length")}catch{ls=null}var xd=ls,cs=Object.defineProperty||!1;if(cs)try{cs({},"a",{value:1})}catch{cs=!1}var Cb=cs,Xo,ou;function Tb(){return ou||(ou=1,Xo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),r=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(var s in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,e);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Xo}var Qo,au;function Ob(){if(au)return Qo;au=1;var n=typeof Symbol<"u"&&Symbol,t=Tb();return Qo=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Qo}var Zo,lu;function vd(){return lu||(lu=1,Zo=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Zo}var ta,cu;function kd(){if(cu)return ta;cu=1;var n=bd;return ta=n.getPrototypeOf||null,ta}var _b="Function.prototype.bind called on incompatible ",Eb=Object.prototype.toString,Ab=Math.max,Db="[object Function]",uu=function(t,e){for(var r=[],i=0;i<t.length;i+=1)r[i]=t[i];for(var s=0;s<e.length;s+=1)r[s+t.length]=e[s];return r},Pb=function(t,e){for(var r=[],i=e,s=0;i<t.length;i+=1,s+=1)r[s]=t[i];return r},Nb=function(n,t){for(var e="",r=0;r<n.length;r+=1)e+=n[r],r+1<n.length&&(e+=t);return e},Ib=function(t){var e=this;if(typeof e!="function"||Eb.apply(e)!==Db)throw new TypeError(_b+e);for(var r=Pb(arguments,1),i,s=function(){if(this instanceof i){var u=e.apply(this,uu(r,arguments));return Object(u)===u?u:this}return e.apply(t,uu(r,arguments))},o=Ab(0,e.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+Nb(a,",")+"){ return binder.apply(this,arguments); }")(s),e.prototype){var c=function(){};c.prototype=e.prototype,i.prototype=new c,c.prototype=null}return i},Rb=Ib,wo=Function.prototype.bind||Rb,Ul=Function.prototype.call,ea,fu;function Sd(){return fu||(fu=1,ea=Function.prototype.apply),ea}var Lb=typeof Reflect<"u"&&Reflect&&Reflect.apply,Bb=wo,$b=Sd(),zb=Ul,Fb=Lb,Hb=Fb||Bb.call(zb,$b),Vb=wo,Wb=br,jb=Ul,Ub=Hb,wd=function(t){if(t.length<1||typeof t[0]!="function")throw new Wb("a function is required");return Ub(Vb,jb,t)},na,hu;function Kb(){if(hu)return na;hu=1;var n=wd,t=xd,e;try{e=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var r=!!e&&t&&t(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return na=r&&typeof r.get=="function"?n([r.get]):typeof s=="function"?function(a){return s(a==null?a:i(a))}:!1,na}var ra,du;function qb(){if(du)return ra;du=1;var n=vd(),t=kd(),e=Kb();return ra=n?function(i){return n(i)}:t?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return t(i)}:e?function(i){return e(i)}:null,ra}var ia,pu;function Jb(){if(pu)return ia;pu=1;var n=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=wo;return ia=e.call(n,t),ia}var U,Yb=bd,Gb=cb,Xb=ub,Qb=fb,Zb=hb,or=db,tr=br,t0=pb,e0=mb,n0=gb,r0=yb,i0=bb,s0=xb,o0=vb,a0=wb,Md=Function,sa=function(n){try{return Md('"use strict"; return ('+n+").constructor;")()}catch{}},li=xd,l0=Cb,oa=function(){throw new tr},c0=li?function(){try{return arguments.callee,oa}catch{try{return li(arguments,"callee").get}catch{return oa}}}():oa,Wn=Ob()(),xt=qb(),u0=kd(),f0=vd(),Cd=Sd(),Ti=Ul,Jn={},h0=typeof Uint8Array>"u"||!xt?U:xt(Uint8Array),Tn={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?U:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?U:ArrayBuffer,"%ArrayIteratorPrototype%":Wn&&xt?xt([][Symbol.iterator]()):U,"%AsyncFromSyncIteratorPrototype%":U,"%AsyncFunction%":Jn,"%AsyncGenerator%":Jn,"%AsyncGeneratorFunction%":Jn,"%AsyncIteratorPrototype%":Jn,"%Atomics%":typeof Atomics>"u"?U:Atomics,"%BigInt%":typeof BigInt>"u"?U:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?U:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?U:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?U:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Gb,"%eval%":eval,"%EvalError%":Xb,"%Float16Array%":typeof Float16Array>"u"?U:Float16Array,"%Float32Array%":typeof Float32Array>"u"?U:Float32Array,"%Float64Array%":typeof Float64Array>"u"?U:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?U:FinalizationRegistry,"%Function%":Md,"%GeneratorFunction%":Jn,"%Int8Array%":typeof Int8Array>"u"?U:Int8Array,"%Int16Array%":typeof Int16Array>"u"?U:Int16Array,"%Int32Array%":typeof Int32Array>"u"?U:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Wn&&xt?xt(xt([][Symbol.iterator]())):U,"%JSON%":typeof JSON=="object"?JSON:U,"%Map%":typeof Map>"u"?U:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Wn||!xt?U:xt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Yb,"%Object.getOwnPropertyDescriptor%":li,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?U:Promise,"%Proxy%":typeof Proxy>"u"?U:Proxy,"%RangeError%":Qb,"%ReferenceError%":Zb,"%Reflect%":typeof Reflect>"u"?U:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?U:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Wn||!xt?U:xt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?U:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Wn&&xt?xt(""[Symbol.iterator]()):U,"%Symbol%":Wn?Symbol:U,"%SyntaxError%":or,"%ThrowTypeError%":c0,"%TypedArray%":h0,"%TypeError%":tr,"%Uint8Array%":typeof Uint8Array>"u"?U:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?U:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?U:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?U:Uint32Array,"%URIError%":t0,"%WeakMap%":typeof WeakMap>"u"?U:WeakMap,"%WeakRef%":typeof WeakRef>"u"?U:WeakRef,"%WeakSet%":typeof WeakSet>"u"?U:WeakSet,"%Function.prototype.call%":Ti,"%Function.prototype.apply%":Cd,"%Object.defineProperty%":l0,"%Object.getPrototypeOf%":u0,"%Math.abs%":e0,"%Math.floor%":n0,"%Math.max%":r0,"%Math.min%":i0,"%Math.pow%":s0,"%Math.round%":o0,"%Math.sign%":a0,"%Reflect.getPrototypeOf%":f0};if(xt)try{null.error}catch(n){var d0=xt(xt(n));Tn["%Error.prototype%"]=d0}var p0=function n(t){var e;if(t==="%AsyncFunction%")e=sa("async function () {}");else if(t==="%GeneratorFunction%")e=sa("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=sa("async function* () {}");else if(t==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(e=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=n("%AsyncGenerator%");i&&xt&&(e=xt(i.prototype))}return Tn[t]=e,e},mu={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Oi=wo,ks=Jb(),m0=Oi.call(Ti,Array.prototype.concat),g0=Oi.call(Cd,Array.prototype.splice),gu=Oi.call(Ti,String.prototype.replace),Ss=Oi.call(Ti,String.prototype.slice),y0=Oi.call(Ti,RegExp.prototype.exec),b0=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,x0=/\\(\\)?/g,v0=function(t){var e=Ss(t,0,1),r=Ss(t,-1);if(e==="%"&&r!=="%")throw new or("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&e!=="%")throw new or("invalid intrinsic syntax, expected opening `%`");var i=[];return gu(t,b0,function(s,o,a,l){i[i.length]=a?gu(l,x0,"$1"):o||s}),i},k0=function(t,e){var r=t,i;if(ks(mu,r)&&(i=mu[r],r="%"+i[0]+"%"),ks(Tn,r)){var s=Tn[r];if(s===Jn&&(s=p0(r)),typeof s>"u"&&!e)throw new tr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new or("intrinsic "+t+" does not exist!")},Kl=function(t,e){if(typeof t!="string"||t.length===0)throw new tr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new tr('"allowMissing" argument must be a boolean');if(y0(/^%?[^%]*%?$/,t)===null)throw new or("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=v0(t),i=r.length>0?r[0]:"",s=k0("%"+i+"%",e),o=s.name,a=s.value,l=!1,c=s.alias;c&&(i=c[0],g0(r,m0([0,1],c)));for(var u=1,f=!0;u<r.length;u+=1){var h=r[u],d=Ss(h,0,1),p=Ss(h,-1);if((d==='"'||d==="'"||d==="`"||p==='"'||p==="'"||p==="`")&&d!==p)throw new or("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(l=!0),i+="."+h,o="%"+i+"%",ks(Tn,o))a=Tn[o];else if(a!=null){if(!(h in a)){if(!e)throw new tr("base intrinsic for "+t+" exists, but the property is not available.");return}if(li&&u+1>=r.length){var m=li(a,h);f=!!m,f&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[h]}else f=ks(a,h),a=a[h];f&&!l&&(Tn[o]=a)}}return a},Td=Kl,Od=wd,S0=Od([Td("%String.prototype.indexOf%")]),_d=function(t,e){var r=Td(t,!!e);return typeof r=="function"&&S0(t,".prototype.")>-1?Od([r]):r},w0=Kl,_i=_d,M0=ko,C0=br,yu=w0("%Map%",!0),T0=_i("Map.prototype.get",!0),O0=_i("Map.prototype.set",!0),_0=_i("Map.prototype.has",!0),E0=_i("Map.prototype.delete",!0),A0=_i("Map.prototype.size",!0),Ed=!!yu&&function(){var t,e={assert:function(r){if(!e.has(r))throw new C0("Side channel does not contain "+M0(r))},delete:function(r){if(t){var i=E0(t,r);return A0(t)===0&&(t=void 0),i}return!1},get:function(r){if(t)return T0(t,r)},has:function(r){return t?_0(t,r):!1},set:function(r,i){t||(t=new yu),O0(t,r,i)}};return e},D0=Kl,Mo=_d,P0=ko,Li=Ed,N0=br,jn=D0("%WeakMap%",!0),I0=Mo("WeakMap.prototype.get",!0),R0=Mo("WeakMap.prototype.set",!0),L0=Mo("WeakMap.prototype.has",!0),B0=Mo("WeakMap.prototype.delete",!0),$0=jn?function(){var t,e,r={assert:function(i){if(!r.has(i))throw new N0("Side channel does not contain "+P0(i))},delete:function(i){if(jn&&i&&(typeof i=="object"||typeof i=="function")){if(t)return B0(t,i)}else if(Li&&e)return e.delete(i);return!1},get:function(i){return jn&&i&&(typeof i=="object"||typeof i=="function")&&t?I0(t,i):e&&e.get(i)},has:function(i){return jn&&i&&(typeof i=="object"||typeof i=="function")&&t?L0(t,i):!!e&&e.has(i)},set:function(i,s){jn&&i&&(typeof i=="object"||typeof i=="function")?(t||(t=new jn),R0(t,i,s)):Li&&(e||(e=Li()),e.set(i,s))}};return r}:Li,z0=br,F0=ko,H0=lb,V0=Ed,W0=$0,j0=W0||V0||H0,Ad=function(){var t,e={assert:function(r){if(!e.has(r))throw new z0("Side channel does not contain "+F0(r))},delete:function(r){return!!t&&t.delete(r)},get:function(r){return t&&t.get(r)},has:function(r){return!!t&&t.has(r)},set:function(r,i){t||(t=j0()),t.set(r,i)}};return e},U0=String.prototype.replace,K0=/%20/g,aa={RFC1738:"RFC1738",RFC3986:"RFC3986"},ql={default:aa.RFC3986,formatters:{RFC1738:function(n){return U0.call(n,K0,"+")},RFC3986:function(n){return String(n)}},RFC1738:aa.RFC1738,RFC3986:aa.RFC3986},q0=ql,J0=Ad,la=Object.prototype.hasOwnProperty,yn=Array.isArray,Co=J0(),Dd=function(t,e){return Co.set(t,e),t},ws=function(t){return Co.has(t)},nl=function(t){return Co.get(t)},Pd=function(t,e){Co.set(t,e)},ae=function(){for(var n=[],t=0;t<256;++t)n.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return n}(),Y0=function(t){for(;t.length>1;){var e=t.pop(),r=e.obj[e.prop];if(yn(r)){for(var i=[],s=0;s<r.length;++s)typeof r[s]<"u"&&i.push(r[s]);e.obj[e.prop]=i}}},Jl=function(t,e){for(var r=e&&e.plainObjects?{__proto__:null}:{},i=0;i<t.length;++i)typeof t[i]<"u"&&(r[i]=t[i]);return r},G0=function n(t,e,r){if(!e)return t;if(typeof e!="object"&&typeof e!="function"){if(yn(t))t.push(e);else if(t&&typeof t=="object")if(ws(t)){var i=nl(t)+1;t[i]=e,Pd(t,i)}else(r&&(r.plainObjects||r.allowPrototypes)||!la.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object"){if(ws(e)){for(var s=Object.keys(e),o=r&&r.plainObjects?{__proto__:null,0:t}:{0:t},a=0;a<s.length;a++){var l=parseInt(s[a],10);o[l+1]=e[s[a]]}return Dd(o,nl(e)+1)}return[t].concat(e)}var c=t;return yn(t)&&!yn(e)&&(c=Jl(t,r)),yn(t)&&yn(e)?(e.forEach(function(u,f){if(la.call(t,f)){var h=t[f];h&&typeof h=="object"&&u&&typeof u=="object"?t[f]=n(h,u,r):t.push(u)}else t[f]=u}),t):Object.keys(e).reduce(function(u,f){var h=e[f];return la.call(u,f)?u[f]=n(u[f],h,r):u[f]=h,u},c)},X0=function(t,e){return Object.keys(e).reduce(function(r,i){return r[i]=e[i],r},t)},Q0=function(n,t,e){var r=n.replace(/\+/g," ");if(e==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},ca=1024,Z0=function(t,e,r,i,s){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;l+=ca){for(var c=o.length>=ca?o.slice(l,l+ca):o,u=[],f=0;f<c.length;++f){var h=c.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===q0.RFC1738&&(h===40||h===41)){u[u.length]=c.charAt(f);continue}if(h<128){u[u.length]=ae[h];continue}if(h<2048){u[u.length]=ae[192|h>>6]+ae[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=ae[224|h>>12]+ae[128|h>>6&63]+ae[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|c.charCodeAt(f)&1023),u[u.length]=ae[240|h>>18]+ae[128|h>>12&63]+ae[128|h>>6&63]+ae[128|h&63]}a+=u.join("")}return a},tx=function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],i=0;i<e.length;++i)for(var s=e[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],u=o[c];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(e.push({obj:o,prop:c}),r.push(u))}return Y0(e),t},ex=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},nx=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},rx=function(t,e,r,i){if(ws(t)){var s=nl(t)+1;return t[s]=e,Pd(t,s),t}var o=[].concat(t,e);return o.length>r?Dd(Jl(o,{plainObjects:i}),o.length-1):o},ix=function(t,e){if(yn(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(e(t[i]));return r}return e(t)},Nd={arrayToObject:Jl,assign:X0,combine:rx,compact:tx,decode:Q0,encode:Z0,isBuffer:nx,isOverflow:ws,isRegExp:ex,maybeMap:ix,merge:G0},Id=Ad,us=Nd,Wr=ql,sx=Object.prototype.hasOwnProperty,Rd={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},pe=Array.isArray,ox=Array.prototype.push,Ld=function(n,t){ox.apply(n,pe(t)?t:[t])},ax=Date.prototype.toISOString,bu=Wr.default,mt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:us.encode,encodeValuesOnly:!1,filter:void 0,format:bu,formatter:Wr.formatters[bu],indices:!1,serializeDate:function(t){return ax.call(t)},skipNulls:!1,strictNullHandling:!1},lx=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},ua={},cx=function n(t,e,r,i,s,o,a,l,c,u,f,h,d,p,m,g,y,b){for(var v=t,k=b,x=0,w=!1;(k=k.get(ua))!==void 0&&!w;){var S=k.get(t);if(x+=1,typeof S<"u"){if(S===x)throw new RangeError("Cyclic object value");w=!0}typeof k.get(ua)>"u"&&(x=0)}if(typeof u=="function"?v=u(e,v):v instanceof Date?v=d(v):r==="comma"&&pe(v)&&(v=us.maybeMap(v,function($){return $ instanceof Date?d($):$})),v===null){if(o)return c&&!g?c(e,mt.encoder,y,"key",p):e;v=""}if(lx(v)||us.isBuffer(v)){if(c){var M=g?e:c(e,mt.encoder,y,"key",p);return[m(M)+"="+m(c(v,mt.encoder,y,"value",p))]}return[m(e)+"="+m(String(v))]}var E=[];if(typeof v>"u")return E;var I;if(r==="comma"&&pe(v))g&&c&&(v=us.maybeMap(v,c)),I=[{value:v.length>0?v.join(",")||null:void 0}];else if(pe(u))I=u;else{var A=Object.keys(v);I=f?A.sort(f):A}var z=l?String(e).replace(/\./g,"%2E"):String(e),K=i&&pe(v)&&v.length===1?z+"[]":z;if(s&&pe(v)&&v.length===0)return K+"[]";for(var D=0;D<I.length;++D){var C=I[D],T=typeof C=="object"&&C&&typeof C.value<"u"?C.value:v[C];if(!(a&&T===null)){var P=h&&l?String(C).replace(/\./g,"%2E"):String(C),N=pe(v)?typeof r=="function"?r(K,P):K:K+(h?"."+P:"["+P+"]");b.set(t,x);var F=Id();F.set(ua,b),Ld(E,n(T,N,r,i,s,o,a,l,r==="comma"&&g&&pe(v)?null:c,u,f,h,d,p,m,g,y,F))}}return E},ux=function(t){if(!t)return mt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||mt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=Wr.default;if(typeof t.format<"u"){if(!sx.call(Wr.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i=Wr.formatters[r],s=mt.filter;(typeof t.filter=="function"||pe(t.filter))&&(s=t.filter);var o;if(t.arrayFormat in Rd?o=t.arrayFormat:"indices"in t?o=t.indices?"indices":"repeat":o=mt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:mt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:mt.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:mt.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:mt.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?mt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:mt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:mt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:mt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:mt.encodeValuesOnly,filter:s,format:r,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:mt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:mt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:mt.strictNullHandling}},fx=function(n,t){var e=n,r=ux(t),i,s;typeof r.filter=="function"?(s=r.filter,e=s("",e)):pe(r.filter)&&(s=r.filter,i=s);var o=[];if(typeof e!="object"||e===null)return"";var a=Rd[r.arrayFormat],l=a==="comma"&&r.commaRoundTrip;i||(i=Object.keys(e)),r.sort&&i.sort(r.sort);for(var c=Id(),u=0;u<i.length;++u){var f=i[u],h=e[f];r.skipNulls&&h===null||Ld(o,cx(h,f,a,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}var d=o.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""},tn=Nd,fs=Object.prototype.hasOwnProperty,xu=Array.isArray,lt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:tn.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},hx=function(n){return n.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Bd=function(n,t,e){if(n&&typeof n=="string"&&t.comma&&n.indexOf(",")>-1)return n.split(",");if(t.throwOnLimitExceeded&&e>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(t.arrayLimit===1?"":"s")+" allowed in an array.");return n},dx="utf8=%26%2310003%3B",px="utf8=%E2%9C%93",mx=function(t,e){var r={__proto__:null},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=e.parameterLimit===1/0?void 0:e.parameterLimit,o=i.split(e.delimiter,e.throwOnLimitExceeded?s+1:s);if(e.throwOnLimitExceeded&&o.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(s===1?"":"s")+" allowed.");var a=-1,l,c=e.charset;if(e.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===px?c="utf-8":o[l]===dx&&(c="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],f=u.indexOf("]="),h=f===-1?u.indexOf("="):f+1,d,p;if(h===-1?(d=e.decoder(u,lt.decoder,c,"key"),p=e.strictNullHandling?null:""):(d=e.decoder(u.slice(0,h),lt.decoder,c,"key"),d!==null&&(p=tn.maybeMap(Bd(u.slice(h+1),e,xu(r[d])?r[d].length:0),function(g){return e.decoder(g,lt.decoder,c,"value")}))),p&&e.interpretNumericEntities&&c==="iso-8859-1"&&(p=hx(String(p))),u.indexOf("[]=")>-1&&(p=xu(p)?[p]:p),d!==null){var m=fs.call(r,d);m&&e.duplicates==="combine"?r[d]=tn.combine(r[d],p,e.arrayLimit,e.plainObjects):(!m||e.duplicates==="last")&&(r[d]=p)}}return r},gx=function(n,t,e,r){var i=0;if(n.length>0&&n[n.length-1]==="[]"){var s=n.slice(0,-1).join("");i=Array.isArray(t)&&t[s]?t[s].length:0}for(var o=r?t:Bd(t,e,i),a=n.length-1;a>=0;--a){var l,c=n[a];if(c==="[]"&&e.parseArrays)tn.isOverflow(o)?l=o:l=e.allowEmptyArrays&&(o===""||e.strictNullHandling&&o===null)?[]:tn.combine([],o,e.arrayLimit,e.plainObjects);else{l=e.plainObjects?{__proto__:null}:{};var u=c.charAt(0)==="["&&c.charAt(c.length-1)==="]"?c.slice(1,-1):c,f=e.decodeDotInKeys?u.replace(/%2E/g,"."):u,h=parseInt(f,10);!e.parseArrays&&f===""?l={0:o}:!isNaN(h)&&c!==f&&String(h)===f&&h>=0&&e.parseArrays&&h<=e.arrayLimit?(l=[],l[h]=o):f!=="__proto__"&&(l[f]=o)}o=l}return o},yx=function(t,e){var r=e.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t;if(e.depth<=0)return!e.plainObjects&&fs.call(Object.prototype,r)&&!e.allowPrototypes?void 0:[r];var i=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,o=i.exec(r),a=o?r.slice(0,o.index):r,l=[];if(a){if(!e.plainObjects&&fs.call(Object.prototype,a)&&!e.allowPrototypes)return;l.push(a)}for(var c=0;(o=s.exec(r))!==null&&c<e.depth;){c+=1;var u=o[1].slice(1,-1);if(!e.plainObjects&&fs.call(Object.prototype,u)&&!e.allowPrototypes)return;l.push(o[1])}if(o){if(e.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+e.depth+" and strictDepth is true");l.push("["+r.slice(o.index)+"]")}return l},bx=function(t,e,r,i){if(t){var s=yx(t,r);if(s)return gx(s,e,r,i)}},xx=function(t){if(!t)return lt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof t.throwOnLimitExceeded<"u"&&typeof t.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=typeof t.charset>"u"?lt.charset:t.charset,r=typeof t.duplicates>"u"?lt.duplicates:t.duplicates;if(r!=="combine"&&r!=="first"&&r!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var i=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:lt.allowDots:!!t.allowDots;return{allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:lt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:lt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:lt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:lt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:lt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:lt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:lt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:lt.decoder,delimiter:typeof t.delimiter=="string"||tn.isRegExp(t.delimiter)?t.delimiter:lt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:lt.depth,duplicates:r,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:lt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:lt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:lt.plainObjects,strictDepth:typeof t.strictDepth=="boolean"?!!t.strictDepth:lt.strictDepth,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:lt.strictNullHandling,throwOnLimitExceeded:typeof t.throwOnLimitExceeded=="boolean"?t.throwOnLimitExceeded:!1}},vx=function(n,t){var e=xx(t);if(n===""||n===null||typeof n>"u")return e.plainObjects?{__proto__:null}:{};for(var r=typeof n=="string"?mx(n,e):n,i=e.plainObjects?{__proto__:null}:{},s=Object.keys(r),o=0;o<s.length;++o){var a=s[o],l=bx(a,r[a],e,typeof n=="string");i=tn.merge(i,l,e)}return e.allowSparse===!0?i:tn.compact(i)},kx=fx,Sx=vx,wx=ql,PE={formats:wx,parse:Sx,stringify:kx},$d={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(n,t){(function(e,r){n.exports=r()})(Pe,function(){var e={};e.version="0.2.0";var r=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(p){var m,g;for(m in p)g=p[m],g!==void 0&&p.hasOwnProperty(m)&&(r[m]=g);return this},e.status=null,e.set=function(p){var m=e.isStarted();p=i(p,r.minimum,1),e.status=p===1?null:p;var g=e.render(!m),y=g.querySelector(r.barSelector),b=r.speed,v=r.easing;return g.offsetWidth,a(function(k){r.positionUsing===""&&(r.positionUsing=e.getPositioningCSS()),l(y,o(p,b,v)),p===1?(l(g,{transition:"none",opacity:1}),g.offsetWidth,setTimeout(function(){l(g,{transition:"all "+b+"ms linear",opacity:0}),setTimeout(function(){e.remove(),k()},b)},b)):setTimeout(k,b)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var p=function(){setTimeout(function(){e.status&&(e.trickle(),p())},r.trickleSpeed)};return r.trickle&&p(),this},e.done=function(p){return!p&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(p){var m=e.status;return m?(typeof p!="number"&&(p=(1-m)*i(Math.random()*m,.1,.95)),m=i(m+p,0,.994),e.set(m)):e.start()},e.trickle=function(){return e.inc(Math.random()*r.trickleRate)},function(){var p=0,m=0;e.promise=function(g){return!g||g.state()==="resolved"?this:(m===0&&e.start(),p++,m++,g.always(function(){m--,m===0?(p=0,e.done()):e.set((p-m)/p)}),this)}}(),e.render=function(p){if(e.isRendered())return document.getElementById("nprogress");u(document.documentElement,"nprogress-busy");var m=document.createElement("div");m.id="nprogress",m.innerHTML=r.template;var g=m.querySelector(r.barSelector),y=p?"-100":s(e.status||0),b=document.querySelector(r.parent),v;return l(g,{transition:"all 0 linear",transform:"translate3d("+y+"%,0,0)"}),r.showSpinner||(v=m.querySelector(r.spinnerSelector),v&&d(v)),b!=document.body&&u(b,"nprogress-custom-parent"),b.appendChild(m),m},e.remove=function(){f(document.documentElement,"nprogress-busy"),f(document.querySelector(r.parent),"nprogress-custom-parent");var p=document.getElementById("nprogress");p&&d(p)},e.isRendered=function(){return!!document.getElementById("nprogress")},e.getPositioningCSS=function(){var p=document.body.style,m="WebkitTransform"in p?"Webkit":"MozTransform"in p?"Moz":"msTransform"in p?"ms":"OTransform"in p?"O":"";return m+"Perspective"in p?"translate3d":m+"Transform"in p?"translate":"margin"};function i(p,m,g){return p<m?m:p>g?g:p}function s(p){return(-1+p)*100}function o(p,m,g){var y;return r.positionUsing==="translate3d"?y={transform:"translate3d("+s(p)+"%,0,0)"}:r.positionUsing==="translate"?y={transform:"translate("+s(p)+"%,0)"}:y={"margin-left":s(p)+"%"},y.transition="all "+m+"ms "+g,y}var a=function(){var p=[];function m(){var g=p.shift();g&&g(m)}return function(g){p.push(g),p.length==1&&m()}}(),l=function(){var p=["Webkit","O","Moz","ms"],m={};function g(k){return k.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(x,w){return w.toUpperCase()})}function y(k){var x=document.body.style;if(k in x)return k;for(var w=p.length,S=k.charAt(0).toUpperCase()+k.slice(1),M;w--;)if(M=p[w]+S,M in x)return M;return k}function b(k){return k=g(k),m[k]||(m[k]=y(k))}function v(k,x,w){x=b(x),k.style[x]=w}return function(k,x){var w=arguments,S,M;if(w.length==2)for(S in x)M=x[S],M!==void 0&&x.hasOwnProperty(S)&&v(k,S,M);else v(k,w[1],w[2])}}();function c(p,m){var g=typeof p=="string"?p:h(p);return g.indexOf(" "+m+" ")>=0}function u(p,m){var g=h(p),y=g+m;c(g,m)||(p.className=y.substring(1))}function f(p,m){var g=h(p),y;c(p,m)&&(y=g.replace(" "+m+" "," "),p.className=y.substring(1,y.length-1))}function h(p){return(" "+(p.className||"")+" ").replace(/\s+/gi," ")}function d(p){p&&p.parentNode&&p.parentNode.removeChild(p)}return e})})($d);var Mx=$d.exports;const NE=yr(Mx);async function IE(n,t){for(const e of Array.isArray(n)?n:[n]){const r=t[e];if(!(typeof r>"u"))return typeof r=="function"?r():r}throw new Error(`Page not found: ${n}`)}var fa={exports:{}},vu;function zd(){return vu||(vu=1,function(n,t){(function(e,r){n.exports=r()})(Pe,function(){var e=1e3,r=6e4,i=36e5,s="millisecond",o="second",a="minute",l="hour",c="day",u="week",f="month",h="quarter",d="year",p="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var C=["th","st","nd","rd"],T=D%100;return"["+D+(C[(T-20)%10]||C[T]||C[0])+"]"}},v=function(D,C,T){var P=String(D);return!P||P.length>=C?D:""+Array(C+1-P.length).join(T)+D},k={s:v,z:function(D){var C=-D.utcOffset(),T=Math.abs(C),P=Math.floor(T/60),N=T%60;return(C<=0?"+":"-")+v(P,2,"0")+":"+v(N,2,"0")},m:function D(C,T){if(C.date()<T.date())return-D(T,C);var P=12*(T.year()-C.year())+(T.month()-C.month()),N=C.clone().add(P,f),F=T-N<0,$=C.clone().add(P+(F?-1:1),f);return+(-(P+(T-N)/(F?N-$:$-N))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:f,y:d,w:u,d:c,D:p,h:l,m:a,s:o,ms:s,Q:h}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},x="en",w={};w[x]=b;var S="$isDayjsObject",M=function(D){return D instanceof z||!(!D||!D[S])},E=function D(C,T,P){var N;if(!C)return x;if(typeof C=="string"){var F=C.toLowerCase();w[F]&&(N=F),T&&(w[F]=T,N=F);var $=C.split("-");if(!N&&$.length>1)return D($[0])}else{var Y=C.name;w[Y]=C,N=Y}return!P&&N&&(x=N),N||!P&&x},I=function(D,C){if(M(D))return D.clone();var T=typeof C=="object"?C:{};return T.date=D,T.args=arguments,new z(T)},A=k;A.l=E,A.i=M,A.w=function(D,C){return I(D,{locale:C.$L,utc:C.$u,x:C.$x,$offset:C.$offset})};var z=function(){function D(T){this.$L=E(T.locale,null,!0),this.parse(T),this.$x=this.$x||T.x||{},this[S]=!0}var C=D.prototype;return C.parse=function(T){this.$d=function(P){var N=P.date,F=P.utc;if(N===null)return new Date(NaN);if(A.u(N))return new Date;if(N instanceof Date)return new Date(N);if(typeof N=="string"&&!/Z$/i.test(N)){var $=N.match(g);if($){var Y=$[2]-1||0,Q=($[7]||"0").substring(0,3);return F?new Date(Date.UTC($[1],Y,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Q)):new Date($[1],Y,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Q)}}return new Date(N)}(T),this.init()},C.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds()},C.$utils=function(){return A},C.isValid=function(){return this.$d.toString()!==m},C.isSame=function(T,P){var N=I(T);return this.startOf(P)<=N&&N<=this.endOf(P)},C.isAfter=function(T,P){return I(T)<this.startOf(P)},C.isBefore=function(T,P){return this.endOf(P)<I(T)},C.$g=function(T,P,N){return A.u(T)?this[P]:this.set(N,T)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(T,P){var N=this,F=!!A.u(P)||P,$=A.p(T),Y=function(cn,$t){var Re=A.w(N.$u?Date.UTC(N.$y,$t,cn):new Date(N.$y,$t,cn),N);return F?Re:Re.endOf(c)},Q=function(cn,$t){return A.w(N.toDate()[cn].apply(N.toDate("s"),(F?[0,0,0,0]:[23,59,59,999]).slice($t)),N)},rt=this.$W,it=this.$M,bt=this.$D,Bt="set"+(this.$u?"UTC":"");switch($){case d:return F?Y(1,0):Y(31,11);case f:return F?Y(1,it):Y(0,it+1);case u:var ln=this.$locale().weekStart||0,kr=(rt<ln?rt+7:rt)-ln;return Y(F?bt-kr:bt+(6-kr),it);case c:case p:return Q(Bt+"Hours",0);case l:return Q(Bt+"Minutes",1);case a:return Q(Bt+"Seconds",2);case o:return Q(Bt+"Milliseconds",3);default:return this.clone()}},C.endOf=function(T){return this.startOf(T,!1)},C.$set=function(T,P){var N,F=A.p(T),$="set"+(this.$u?"UTC":""),Y=(N={},N[c]=$+"Date",N[p]=$+"Date",N[f]=$+"Month",N[d]=$+"FullYear",N[l]=$+"Hours",N[a]=$+"Minutes",N[o]=$+"Seconds",N[s]=$+"Milliseconds",N)[F],Q=F===c?this.$D+(P-this.$W):P;if(F===f||F===d){var rt=this.clone().set(p,1);rt.$d[Y](Q),rt.init(),this.$d=rt.set(p,Math.min(this.$D,rt.daysInMonth())).$d}else Y&&this.$d[Y](Q);return this.init(),this},C.set=function(T,P){return this.clone().$set(T,P)},C.get=function(T){return this[A.p(T)]()},C.add=function(T,P){var N,F=this;T=Number(T);var $=A.p(P),Y=function(it){var bt=I(F);return A.w(bt.date(bt.date()+Math.round(it*T)),F)};if($===f)return this.set(f,this.$M+T);if($===d)return this.set(d,this.$y+T);if($===c)return Y(1);if($===u)return Y(7);var Q=(N={},N[a]=r,N[l]=i,N[o]=e,N)[$]||1,rt=this.$d.getTime()+T*Q;return A.w(rt,this)},C.subtract=function(T,P){return this.add(-1*T,P)},C.format=function(T){var P=this,N=this.$locale();if(!this.isValid())return N.invalidDate||m;var F=T||"YYYY-MM-DDTHH:mm:ssZ",$=A.z(this),Y=this.$H,Q=this.$m,rt=this.$M,it=N.weekdays,bt=N.months,Bt=N.meridiem,ln=function($t,Re,Sr,Ii){return $t&&($t[Re]||$t(P,F))||Sr[Re].slice(0,Ii)},kr=function($t){return A.s(Y%12||12,$t,"0")},cn=Bt||function($t,Re,Sr){var Ii=$t<12?"AM":"PM";return Sr?Ii.toLowerCase():Ii};return F.replace(y,function($t,Re){return Re||function(Sr){switch(Sr){case"YY":return String(P.$y).slice(-2);case"YYYY":return A.s(P.$y,4,"0");case"M":return rt+1;case"MM":return A.s(rt+1,2,"0");case"MMM":return ln(N.monthsShort,rt,bt,3);case"MMMM":return ln(bt,rt);case"D":return P.$D;case"DD":return A.s(P.$D,2,"0");case"d":return String(P.$W);case"dd":return ln(N.weekdaysMin,P.$W,it,2);case"ddd":return ln(N.weekdaysShort,P.$W,it,3);case"dddd":return it[P.$W];case"H":return String(Y);case"HH":return A.s(Y,2,"0");case"h":return kr(1);case"hh":return kr(2);case"a":return cn(Y,Q,!0);case"A":return cn(Y,Q,!1);case"m":return String(Q);case"mm":return A.s(Q,2,"0");case"s":return String(P.$s);case"ss":return A.s(P.$s,2,"0");case"SSS":return A.s(P.$ms,3,"0");case"Z":return $}return null}($t)||$.replace(":","")})},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(T,P,N){var F,$=this,Y=A.p(P),Q=I(T),rt=(Q.utcOffset()-this.utcOffset())*r,it=this-Q,bt=function(){return A.m($,Q)};switch(Y){case d:F=bt()/12;break;case f:F=bt();break;case h:F=bt()/3;break;case u:F=(it-rt)/6048e5;break;case c:F=(it-rt)/864e5;break;case l:F=it/i;break;case a:F=it/r;break;case o:F=it/e;break;default:F=it}return N?F:A.a(F)},C.daysInMonth=function(){return this.endOf(f).$D},C.$locale=function(){return w[this.$L]},C.locale=function(T,P){if(!T)return this.$L;var N=this.clone(),F=E(T,P,!0);return F&&(N.$L=F),N},C.clone=function(){return A.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},D}(),K=z.prototype;return I.prototype=K,[["$ms",s],["$s",o],["$m",a],["$H",l],["$W",c],["$M",f],["$y",d],["$D",p]].forEach(function(D){K[D[1]]=function(C){return this.$g(C,D[0],D[1])}}),I.extend=function(D,C){return D.$i||(D(C,z,I),D.$i=!0),I},I.locale=E,I.isDayjs=M,I.unix=function(D){return I(1e3*D)},I.en=w[x],I.Ls=w,I.p={},I})}(fa)),fa.exports}var Cx=zd();const RE=yr(Cx);var Tx={exports:{}};(function(n,t){(function(e,r){n.exports=r(zd())})(Pe,function(e){function r(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var i=r(e),s={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(o){return o+"."}};return i.default.locale(s,null,!0),s})})(Tx);var Ox={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Pe,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var r=["th","st","nd","rd"],i=e%100;return"["+e+(r[(i-20)%10]||r[i]||r[0])+"]"}}})})(Ox);var Fd={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Pe,function(){return function(e,r){r.prototype.isSameOrBefore=function(i,s){return this.isSame(i,s)||this.isBefore(i,s)}}})})(Fd);var _x=Fd.exports;const LE=yr(_x);var Hd={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Pe,function(){return function(e,r,i){r.prototype.isBetween=function(s,o,a,l){var c=i(s),u=i(o),f=(l=l||"()")[0]==="(",h=l[1]===")";return(f?this.isAfter(c,a):!this.isBefore(c,a))&&(h?this.isBefore(u,a):!this.isAfter(u,a))||(f?this.isBefore(c,a):!this.isAfter(c,a))&&(h?this.isAfter(u,a):!this.isBefore(u,a))}}})})(Hd);var Ex=Hd.exports;const BE=yr(Ex);/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ei(n){return n+.5|0}const je=(n,t,e)=>Math.max(Math.min(n,e),t);function Pr(n){return je(Ei(n*2.55),0,255)}function Ye(n){return je(Ei(n*255),0,255)}function _e(n){return je(Ei(n/2.55)/100,0,1)}function ku(n){return je(Ei(n*100),0,100)}const Kt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},rl=[..."0123456789ABCDEF"],Ax=n=>rl[n&15],Dx=n=>rl[(n&240)>>4]+rl[n&15],Bi=n=>(n&240)>>4===(n&15),Px=n=>Bi(n.r)&&Bi(n.g)&&Bi(n.b)&&Bi(n.a);function Nx(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&Kt[n[1]]*17,g:255&Kt[n[2]]*17,b:255&Kt[n[3]]*17,a:t===5?Kt[n[4]]*17:255}:(t===7||t===9)&&(e={r:Kt[n[1]]<<4|Kt[n[2]],g:Kt[n[3]]<<4|Kt[n[4]],b:Kt[n[5]]<<4|Kt[n[6]],a:t===9?Kt[n[7]]<<4|Kt[n[8]]:255})),e}const Ix=(n,t)=>n<255?t(n):"";function Rx(n){var t=Px(n)?Ax:Dx;return n?"#"+t(n.r)+t(n.g)+t(n.b)+Ix(n.a,t):void 0}const Lx=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Vd(n,t,e){const r=t*Math.min(e,1-e),i=(s,o=(s+n/30)%12)=>e-r*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function Bx(n,t,e){const r=(i,s=(i+n/60)%6)=>e-e*t*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function $x(n,t,e){const r=Vd(n,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)r[i]*=1-t-e,r[i]+=t;return r}function zx(n,t,e,r,i){return n===i?(t-e)/r+(t<e?6:0):t===i?(e-n)/r+2:(n-t)/r+4}function Yl(n){const e=n.r/255,r=n.g/255,i=n.b/255,s=Math.max(e,r,i),o=Math.min(e,r,i),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=zx(e,r,i,u,s),l=l*60+.5),[l|0,c||0,a]}function Gl(n,t,e,r){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,r)).map(Ye)}function Xl(n,t,e){return Gl(Vd,n,t,e)}function Fx(n,t,e){return Gl($x,n,t,e)}function Hx(n,t,e){return Gl(Bx,n,t,e)}function Wd(n){return(n%360+360)%360}function Vx(n){const t=Lx.exec(n);let e=255,r;if(!t)return;t[5]!==r&&(e=t[6]?Pr(+t[5]):Ye(+t[5]));const i=Wd(+t[2]),s=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?r=Fx(i,s,o):t[1]==="hsv"?r=Hx(i,s,o):r=Xl(i,s,o),{r:r[0],g:r[1],b:r[2],a:e}}function Wx(n,t){var e=Yl(n);e[0]=Wd(e[0]+t),e=Xl(e),n.r=e[0],n.g=e[1],n.b=e[2]}function jx(n){if(!n)return;const t=Yl(n),e=t[0],r=ku(t[1]),i=ku(t[2]);return n.a<255?`hsla(${e}, ${r}%, ${i}%, ${_e(n.a)})`:`hsl(${e}, ${r}%, ${i}%)`}const Su={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wu={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Ux(){const n={},t=Object.keys(wu),e=Object.keys(Su);let r,i,s,o,a;for(r=0;r<t.length;r++){for(o=a=t[r],i=0;i<e.length;i++)s=e[i],a=a.replace(s,Su[s]);s=parseInt(wu[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}let $i;function Kx(n){$i||($i=Ux(),$i.transparent=[0,0,0,0]);const t=$i[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const qx=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Jx(n){const t=qx.exec(n);let e=255,r,i,s;if(t){if(t[7]!==r){const o=+t[7];e=t[8]?Pr(o):je(o*255,0,255)}return r=+t[1],i=+t[3],s=+t[5],r=255&(t[2]?Pr(r):je(r,0,255)),i=255&(t[4]?Pr(i):je(i,0,255)),s=255&(t[6]?Pr(s):je(s,0,255)),{r,g:i,b:s,a:e}}}function Yx(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${_e(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const ha=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Un=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Gx(n,t,e){const r=Un(_e(n.r)),i=Un(_e(n.g)),s=Un(_e(n.b));return{r:Ye(ha(r+e*(Un(_e(t.r))-r))),g:Ye(ha(i+e*(Un(_e(t.g))-i))),b:Ye(ha(s+e*(Un(_e(t.b))-s))),a:n.a+e*(t.a-n.a)}}function zi(n,t,e){if(n){let r=Yl(n);r[t]=Math.max(0,Math.min(r[t]+r[t]*e,t===0?360:1)),r=Xl(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function jd(n,t){return n&&Object.assign(t||{},n)}function Mu(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Ye(n[3]))):(t=jd(n,{r:0,g:0,b:0,a:1}),t.a=Ye(t.a)),t}function Xx(n){return n.charAt(0)==="r"?Jx(n):Vx(n)}class ci{constructor(t){if(t instanceof ci)return t;const e=typeof t;let r;e==="object"?r=Mu(t):e==="string"&&(r=Nx(t)||Kx(t)||Xx(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=jd(this._rgb);return t&&(t.a=_e(t.a)),t}set rgb(t){this._rgb=Mu(t)}rgbString(){return this._valid?Yx(this._rgb):void 0}hexString(){return this._valid?Rx(this._rgb):void 0}hslString(){return this._valid?jx(this._rgb):void 0}mix(t,e){if(t){const r=this.rgb,i=t.rgb;let s;const o=e===s?.5:e,a=2*o-1,l=r.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,r.r=255&c*r.r+s*i.r+.5,r.g=255&c*r.g+s*i.g+.5,r.b=255&c*r.b+s*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(t,e){return t&&(this._rgb=Gx(this._rgb,t._rgb,e)),this}clone(){return new ci(this.rgb)}alpha(t){return this._rgb.a=Ye(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Ei(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return zi(this._rgb,2,t),this}darken(t){return zi(this._rgb,2,-t),this}saturate(t){return zi(this._rgb,1,t),this}desaturate(t){return zi(this._rgb,1,-t),this}rotate(t){return Wx(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function xe(){}const Qx=(()=>{let n=0;return()=>n++})();function tt(n){return n==null}function gt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function J(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Dt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function le(n,t){return Dt(n)?n:t}function q(n,t){return typeof n>"u"?t:n}const Zx=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function nt(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function X(n,t,e,r){let i,s,o;if(gt(n))for(s=n.length,i=0;i<s;i++)t.call(e,n[i],i);else if(J(n))for(o=Object.keys(n),s=o.length,i=0;i<s;i++)t.call(e,n[o[i]],o[i])}function Ms(n,t){let e,r,i,s;if(!n||!t||n.length!==t.length)return!1;for(e=0,r=n.length;e<r;++e)if(i=n[e],s=t[e],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function Cs(n){if(gt(n))return n.map(Cs);if(J(n)){const t=Object.create(null),e=Object.keys(n),r=e.length;let i=0;for(;i<r;++i)t[e[i]]=Cs(n[e[i]]);return t}return n}function Ud(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function tv(n,t,e,r){if(!Ud(n))return;const i=t[n],s=e[n];J(i)&&J(s)?ui(i,s,r):t[n]=Cs(s)}function ui(n,t,e){const r=gt(t)?t:[t],i=r.length;if(!J(n))return n;e=e||{};const s=e.merger||tv;let o;for(let a=0;a<i;++a){if(o=r[a],!J(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],n,o,e)}return n}function jr(n,t){return ui(n,t,{merger:ev})}function ev(n,t,e){if(!Ud(n))return;const r=t[n],i=e[n];J(r)&&J(i)?jr(r,i):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=Cs(i))}const Cu={"":n=>n,x:n=>n.x,y:n=>n.y};function nv(n){const t=n.split("."),e=[];let r="";for(const i of t)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(e.push(r),r="");return e}function rv(n){const t=nv(n);return e=>{for(const r of t){if(r==="")break;e=e&&e[r]}return e}}function Ts(n,t){return(Cu[t]||(Cu[t]=rv(t)))(n)}function Ql(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Os=n=>typeof n<"u",en=n=>typeof n=="function",Tu=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function iv(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const kt=Math.PI,se=2*kt,sv=se+kt,_s=Number.POSITIVE_INFINITY,ov=kt/180,re=kt/2,un=kt/4,Ou=kt*2/3,Kd=Math.log10,ar=Math.sign;function Ur(n,t,e){return Math.abs(n-t)<e}function _u(n){const t=Math.round(n);n=Ur(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(Kd(n))),r=n/e;return(r<=1?1:r<=2?2:r<=5?5:10)*e}function av(n){const t=[],e=Math.sqrt(n);let r;for(r=1;r<e;r++)n%r===0&&(t.push(r),t.push(n/r));return e===(e|0)&&t.push(e),t.sort((i,s)=>i-s).pop(),t}function lv(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function fi(n){return!lv(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function cv(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function uv(n,t,e){let r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r][e],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function xn(n){return n*(kt/180)}function fv(n){return n*(180/kt)}function Eu(n){if(!Dt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function hv(n,t){const e=t.x-n.x,r=t.y-n.y,i=Math.sqrt(e*e+r*r);let s=Math.atan2(r,e);return s<-.5*kt&&(s+=se),{angle:s,distance:i}}function il(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function dv(n,t){return(n-t+sv)%se-kt}function me(n){return(n%se+se)%se}function qd(n,t,e,r){const i=me(n),s=me(t),o=me(e),a=me(s-i),l=me(o-i),c=me(i-s),u=me(i-o);return i===s||i===o||r&&s===o||a>l&&c<u}function Xt(n,t,e){return Math.max(t,Math.min(e,n))}function pv(n){return Xt(n,-32768,32767)}function Qn(n,t,e,r=1e-6){return n>=Math.min(t,e)-r&&n<=Math.max(t,e)+r}function Zl(n,t,e){e=e||(o=>n[o]<t);let r=n.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,e(s)?i=s:r=s;return{lo:i,hi:r}}const vn=(n,t,e,r)=>Zl(n,e,r?i=>{const s=n[i][t];return s<e||s===e&&n[i+1][t]===e}:i=>n[i][t]<e),mv=(n,t,e)=>Zl(n,e,r=>n[r][t]>=e);function gv(n,t,e){let r=0,i=n.length;for(;r<i&&n[r]<t;)r++;for(;i>r&&n[i-1]>e;)i--;return r>0||i<n.length?n.slice(r,i):n}const Jd=["push","pop","shift","splice","unshift"];function yv(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Jd.forEach(e=>{const r="_onData"+Ql(e),i=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function Au(n,t){const e=n._chartjs;if(!e)return;const r=e.listeners,i=r.indexOf(t);i!==-1&&r.splice(i,1),!(r.length>0)&&(Jd.forEach(s=>{delete n[s]}),delete n._chartjs)}function bv(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const Yd=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Gd(n,t){let e=[],r=!1;return function(...i){e=i,r||(r=!0,Yd.call(window,()=>{r=!1,n.apply(t,e)}))}}function xv(n,t){let e;return function(...r){return t?(clearTimeout(e),e=setTimeout(n,t,r)):n.apply(this,r),t}}const tc=n=>n==="start"?"left":n==="end"?"right":"center",_t=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,vv=(n,t,e,r)=>n===(r?"left":"right")?e:n==="center"?(t+e)/2:t;function kv(n,t,e){const r=t.length;let i=0,s=r;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:f,max:h,minDefined:d,maxDefined:p}=o.getUserBounds();if(d){if(i=Math.min(vn(l,u,f).lo,e?r:vn(t,u,o.getPixelForValue(f)).lo),c){const m=l.slice(0,i+1).reverse().findIndex(g=>!tt(g[a.axis]));i-=Math.max(0,m)}i=Xt(i,0,r-1)}if(p){let m=Math.max(vn(l,o.axis,h,!0).hi+1,e?0:vn(t,u,o.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(m-1).findIndex(y=>!tt(y[a.axis]));m+=Math.max(0,g)}s=Xt(m,i,r)-i}else s=r-i}return{start:i,count:s}}function Sv(n){const{xScale:t,yScale:e,_scaleRanges:r}=n,i={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!r)return n._scaleRanges=i,!0;const s=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==e.min||r.ymax!==e.max;return Object.assign(r,i),s}const Fi=n=>n===0||n===1,Du=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*se/e)),Pu=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*se/e)+1,Kr={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*re)+1,easeOutSine:n=>Math.sin(n*re),easeInOutSine:n=>-.5*(Math.cos(kt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Fi(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Fi(n)?n:Du(n,.075,.3),easeOutElastic:n=>Fi(n)?n:Pu(n,.075,.3),easeInOutElastic(n){return Fi(n)?n:n<.5?.5*Du(n*2,.1125,.45):.5+.5*Pu(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Kr.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Kr.easeInBounce(n*2)*.5:Kr.easeOutBounce(n*2-1)*.5+.5};function ec(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Nu(n){return ec(n)?n:new ci(n)}function da(n){return ec(n)?n:new ci(n).saturate(.5).darken(.1).hexString()}const wv=["x","y","borderWidth","radius","tension"],Mv=["color","borderColor","backgroundColor"];function Cv(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:Mv},numbers:{type:"number",properties:wv}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Tv(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Iu=new Map;function Ov(n,t){t=t||{};const e=n+JSON.stringify(t);let r=Iu.get(e);return r||(r=new Intl.NumberFormat(n,t),Iu.set(e,r)),r}function Xd(n,t,e){return Ov(t,e).format(n)}const _v={values(n){return gt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const r=this.chart.options.locale;let i,s=n;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=Ev(n,e)}const o=Kd(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Xd(n,r,l)}};function Ev(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var Qd={formatters:_v};function Av(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Qd.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Nn=Object.create(null),sl=Object.create(null);function qr(n,t){if(!t)return n;const e=t.split(".");for(let r=0,i=e.length;r<i;++r){const s=e[r];n=n[s]||(n[s]=Object.create(null))}return n}function pa(n,t,e){return typeof t=="string"?ui(qr(n,t),e):ui(qr(n,""),t)}class Dv{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>da(i.backgroundColor),this.hoverBorderColor=(r,i)=>da(i.borderColor),this.hoverColor=(r,i)=>da(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return pa(this,t,e)}get(t){return qr(this,t)}describe(t,e){return pa(sl,t,e)}override(t,e){return pa(Nn,t,e)}route(t,e,r,i){const s=qr(this,t),o=qr(this,r),a="_"+e;Object.defineProperties(s,{[a]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],c=o[i];return J(l)?Object.assign({},c,l):q(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var ut=new Dv({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Cv,Tv,Av]);function Pv(n){return!n||tt(n.size)||tt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Ru(n,t,e,r,i){let s=t[i];return s||(s=t[i]=n.measureText(i).width,e.push(i)),s>r&&(r=s),r}function fn(n,t,e){const r=n.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*r)/r+i}function Lu(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function ol(n,t,e,r){Zd(n,t,e,r,null)}function Zd(n,t,e,r,i){let s,o,a,l,c,u,f,h;const d=t.pointStyle,p=t.rotation,m=t.radius;let g=(p||0)*ov;if(d&&typeof d=="object"&&(s=d.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(e,r),n.rotate(g),n.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),n.restore();return}if(!(isNaN(m)||m<=0)){switch(n.beginPath(),d){default:i?n.ellipse(e,r,i/2,m,0,0,se):n.arc(e,r,m,0,se),n.closePath();break;case"triangle":u=i?i/2:m,n.moveTo(e+Math.sin(g)*u,r-Math.cos(g)*m),g+=Ou,n.lineTo(e+Math.sin(g)*u,r-Math.cos(g)*m),g+=Ou,n.lineTo(e+Math.sin(g)*u,r-Math.cos(g)*m),n.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(g+un)*l,f=Math.cos(g+un)*(i?i/2-c:l),a=Math.sin(g+un)*l,h=Math.sin(g+un)*(i?i/2-c:l),n.arc(e-f,r-a,c,g-kt,g-re),n.arc(e+h,r-o,c,g-re,g),n.arc(e+f,r+a,c,g,g+re),n.arc(e-h,r+o,c,g+re,g+kt),n.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=i?i/2:l,n.rect(e-u,r-l,2*u,2*l);break}g+=un;case"rectRot":f=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(i?i/2:m),n.moveTo(e-f,r-a),n.lineTo(e+h,r-o),n.lineTo(e+f,r+a),n.lineTo(e-h,r+o),n.closePath();break;case"crossRot":g+=un;case"cross":f=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(i?i/2:m),n.moveTo(e-f,r-a),n.lineTo(e+f,r+a),n.moveTo(e+h,r-o),n.lineTo(e-h,r+o);break;case"star":f=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(i?i/2:m),n.moveTo(e-f,r-a),n.lineTo(e+f,r+a),n.moveTo(e+h,r-o),n.lineTo(e-h,r+o),g+=un,f=Math.cos(g)*(i?i/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(i?i/2:m),n.moveTo(e-f,r-a),n.lineTo(e+f,r+a),n.moveTo(e+h,r-o),n.lineTo(e-h,r+o);break;case"line":o=i?i/2:Math.cos(g)*m,a=Math.sin(g)*m,n.moveTo(e-o,r-a),n.lineTo(e+o,r+a);break;case"dash":n.moveTo(e,r),n.lineTo(e+Math.cos(g)*(i?i/2:m),r+Math.sin(g)*m);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function hi(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function To(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Oo(n){n.restore()}function Nv(n,t,e,r,i){if(!t)return n.lineTo(e.x,e.y);if(i==="middle"){const s=(t.x+e.x)/2;n.lineTo(s,t.y),n.lineTo(s,e.y)}else i==="after"!=!!r?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function Iv(n,t,e,r){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?e.cp2x:e.cp1x,r?e.cp2y:e.cp1y,e.x,e.y)}function Rv(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),tt(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function Lv(n,t,e,r,i){if(i.strikethrough||i.underline){const s=n.measureText(r),o=t-s.actualBoundingBoxLeft,a=t+s.actualBoundingBoxRight,l=e-s.actualBoundingBoxAscent,c=e+s.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function Bv(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function di(n,t,e,r,i,s={}){const o=gt(t)?t:[t],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,Rv(n,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&Bv(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),tt(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(c,e,r,s.maxWidth)),n.fillText(c,e,r,s.maxWidth),Lv(n,e,r,c,s),r+=Number(i.lineHeight);n.restore()}function al(n,t){const{x:e,y:r,w:i,h:s,radius:o}=t;n.arc(e+o.topLeft,r+o.topLeft,o.topLeft,1.5*kt,kt,!0),n.lineTo(e,r+s-o.bottomLeft),n.arc(e+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,kt,re,!0),n.lineTo(e+i-o.bottomRight,r+s),n.arc(e+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,re,0,!0),n.lineTo(e+i,r+o.topRight),n.arc(e+i-o.topRight,r+o.topRight,o.topRight,0,-re,!0),n.lineTo(e+o.topLeft,r)}const $v=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,zv=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Fv(n,t){const e=(""+n).match($v);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const Hv=n=>+n||0;function tp(n,t){const e={},r=J(t),i=r?Object.keys(t):t,s=J(n)?r?o=>q(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of i)e[o]=Hv(s(o));return e}function Vv(n){return tp(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Jr(n){return tp(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ee(n){const t=Vv(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function At(n,t){n=n||{},t=t||ut.font;let e=q(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let r=q(n.style,t.style);r&&!(""+r).match(zv)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:q(n.family,t.family),lineHeight:Fv(q(n.lineHeight,t.lineHeight),e),size:e,style:r,weight:q(n.weight,t.weight),string:""};return i.string=Pv(i),i}function Hi(n,t,e,r){let i,s,o;for(i=0,s=n.length;i<s;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function Wv(n,t,e){const{min:r,max:i}=n,s=Zx(t,(i-r)/2),o=(a,l)=>e&&a===0?0:a+l;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function Fn(n,t){return Object.assign(Object.create(n),t)}function nc(n,t=[""],e,r,i=()=>n[0]){const s=e||n;typeof r>"u"&&(r=ip("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:r,_getTarget:i,override:a=>nc([a,...n],t,s,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return np(a,l,()=>Xv(l,t,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return $u(a).includes(l)},ownKeys(a){return $u(a)},set(a,l,c){const u=a._storage||(a._storage=i());return a[l]=u[l]=c,delete a._keys,!0}})}function lr(n,t,e,r){const i={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:ep(n,r),setContext:s=>lr(n,s,e,r),override:s=>lr(n.override(s),t,e,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return np(s,o,()=>Uv(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function ep(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:r=t.indexable,_allKeys:i=t.allKeys}=n;return{allKeys:i,scriptable:e,indexable:r,isScriptable:en(e)?e:()=>e,isIndexable:en(r)?r:()=>r}}const jv=(n,t)=>n?n+Ql(t):t,rc=(n,t)=>J(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function np(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const r=e();return n[t]=r,r}function Uv(n,t,e){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=n;let a=r[t];return en(a)&&o.isScriptable(t)&&(a=Kv(t,a,n,e)),gt(a)&&a.length&&(a=qv(t,a,n,o.isIndexable)),rc(t,a)&&(a=lr(a,i,s&&s[t],o)),a}function Kv(n,t,e,r){const{_proxy:i,_context:s,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=t(s,o||r);return a.delete(n),rc(n,l)&&(l=ic(i._scopes,i,n,l)),l}function qv(n,t,e,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:a}=e;if(typeof s.index<"u"&&r(n))return t[s.index%t.length];if(J(t[0])){const l=t,c=i._scopes.filter(u=>u!==l);t=[];for(const u of l){const f=ic(c,i,n,u);t.push(lr(f,s,o&&o[n],a))}}return t}function rp(n,t,e){return en(n)?n(t,e):n}const Jv=(n,t)=>n===!0?t:typeof n=="string"?Ts(t,n):void 0;function Yv(n,t,e,r,i){for(const s of t){const o=Jv(e,s);if(o){n.add(o);const a=rp(o._fallback,e,i);if(typeof a<"u"&&a!==e&&a!==r)return a}else if(o===!1&&typeof r<"u"&&e!==r)return null}return!1}function ic(n,t,e,r){const i=t._rootScopes,s=rp(t._fallback,e,r),o=[...n,...i],a=new Set;a.add(r);let l=Bu(a,o,e,s||e,r);return l===null||typeof s<"u"&&s!==e&&(l=Bu(a,o,s,l,r),l===null)?!1:nc(Array.from(a),[""],i,s,()=>Gv(t,e,r))}function Bu(n,t,e,r,i){for(;e;)e=Yv(n,t,e,r,i);return e}function Gv(n,t,e){const r=n._getTarget();t in r||(r[t]={});const i=r[t];return gt(i)&&J(e)?e:i||{}}function Xv(n,t,e,r){let i;for(const s of t)if(i=ip(jv(s,n),e),typeof i<"u")return rc(n,i)?ic(e,r,n,i):i}function ip(n,t){for(const e of t){if(!e)continue;const r=e[n];if(typeof r<"u")return r}}function $u(n){let t=n._keys;return t||(t=n._keys=Qv(n._scopes)),t}function Qv(n){const t=new Set;for(const e of n)for(const r of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(r);return Array.from(t)}const Zv=Number.EPSILON||1e-14,cr=(n,t)=>t<n.length&&!n[t].skip&&n[t],sp=n=>n==="x"?"y":"x";function tk(n,t,e,r){const i=n.skip?t:n,s=t,o=e.skip?t:e,a=il(s,i),l=il(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const f=r*c,h=r*u;return{previous:{x:s.x-f*(o.x-i.x),y:s.y-f*(o.y-i.y)},next:{x:s.x+h*(o.x-i.x),y:s.y+h*(o.y-i.y)}}}function ek(n,t,e){const r=n.length;let i,s,o,a,l,c=cr(n,0);for(let u=0;u<r-1;++u)if(l=c,c=cr(n,u+1),!(!l||!c)){if(Ur(t[u],0,Zv)){e[u]=e[u+1]=0;continue}i=e[u]/t[u],s=e[u+1]/t[u],a=Math.pow(i,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),e[u]=i*o*t[u],e[u+1]=s*o*t[u])}}function nk(n,t,e="x"){const r=sp(e),i=n.length;let s,o,a,l=cr(n,0);for(let c=0;c<i;++c){if(o=a,a=l,l=cr(n,c+1),!a)continue;const u=a[e],f=a[r];o&&(s=(u-o[e])/3,a[`cp1${e}`]=u-s,a[`cp1${r}`]=f-s*t[c]),l&&(s=(l[e]-u)/3,a[`cp2${e}`]=u+s,a[`cp2${r}`]=f+s*t[c])}}function rk(n,t="x"){const e=sp(t),r=n.length,i=Array(r).fill(0),s=Array(r);let o,a,l,c=cr(n,0);for(o=0;o<r;++o)if(a=l,l=c,c=cr(n,o+1),!!l){if(c){const u=c[t]-l[t];i[o]=u!==0?(c[e]-l[e])/u:0}s[o]=a?c?ar(i[o-1])!==ar(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}ek(n,i,s),nk(n,s,t)}function Vi(n,t,e){return Math.max(Math.min(n,e),t)}function ik(n,t){let e,r,i,s,o,a=hi(n[0],t);for(e=0,r=n.length;e<r;++e)o=s,s=a,a=e<r-1&&hi(n[e+1],t),s&&(i=n[e],o&&(i.cp1x=Vi(i.cp1x,t.left,t.right),i.cp1y=Vi(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=Vi(i.cp2x,t.left,t.right),i.cp2y=Vi(i.cp2y,t.top,t.bottom)))}function sk(n,t,e,r,i){let s,o,a,l;if(t.spanGaps&&(n=n.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")rk(n,i);else{let c=r?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],l=tk(c,a,n[Math.min(s+1,o-(r?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&ik(n,e)}function sc(){return typeof window<"u"&&typeof document<"u"}function oc(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Es(n,t,e){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*t.parentNode[e])):r=n,r}const _o=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function ok(n,t){return _o(n).getPropertyValue(t)}const ak=["top","right","bottom","left"];function On(n,t,e){const r={};e=e?"-"+e:"";for(let i=0;i<4;i++){const s=ak[i];r[s]=parseFloat(n[t+"-"+s+e])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const lk=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function ck(n,t){const e=n.touches,r=e&&e.length?e[0]:n,{offsetX:i,offsetY:s}=r;let o=!1,a,l;if(lk(i,s,n.target))a=i,l=s;else{const c=t.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function pn(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:r}=t,i=_o(e),s=i.boxSizing==="border-box",o=On(i,"padding"),a=On(i,"border","width"),{x:l,y:c,box:u}=ck(n,e),f=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:d,height:p}=t;return s&&(d-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-f)/d*e.width/r),y:Math.round((c-h)/p*e.height/r)}}function uk(n,t,e){let r,i;if(t===void 0||e===void 0){const s=n&&oc(n);if(!s)t=n.clientWidth,e=n.clientHeight;else{const o=s.getBoundingClientRect(),a=_o(s),l=On(a,"border","width"),c=On(a,"padding");t=o.width-c.width-l.width,e=o.height-c.height-l.height,r=Es(a.maxWidth,s,"clientWidth"),i=Es(a.maxHeight,s,"clientHeight")}}return{width:t,height:e,maxWidth:r||_s,maxHeight:i||_s}}const Ue=n=>Math.round(n*10)/10;function fk(n,t,e,r){const i=_o(n),s=On(i,"margin"),o=Es(i.maxWidth,n,"clientWidth")||_s,a=Es(i.maxHeight,n,"clientHeight")||_s,l=uk(n,t,e);let{width:c,height:u}=l;if(i.boxSizing==="content-box"){const h=On(i,"border","width"),d=On(i,"padding");c-=d.width+h.width,u-=d.height+h.height}return c=Math.max(0,c-s.width),u=Math.max(0,r?c/r:u-s.height),c=Ue(Math.min(c,o,l.maxWidth)),u=Ue(Math.min(u,a,l.maxHeight)),c&&!u&&(u=Ue(c/2)),(t!==void 0||e!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=Ue(Math.floor(u*r))),{width:c,height:u}}function zu(n,t,e){const r=t||1,i=Ue(n.height*r),s=Ue(n.width*r);n.height=Ue(n.height),n.width=Ue(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(n.currentDevicePixelRatio=r,o.height=i,o.width=s,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const hk=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};sc()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function Fu(n,t){const e=ok(n,t),r=e&&e.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function mn(n,t,e,r){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function dk(n,t,e,r){return{x:n.x+e*(t.x-n.x),y:r==="middle"?e<.5?n.y:t.y:r==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function pk(n,t,e,r){const i={x:n.cp2x,y:n.cp2y},s={x:t.cp1x,y:t.cp1y},o=mn(n,i,e),a=mn(i,s,e),l=mn(s,t,e),c=mn(o,a,e),u=mn(a,l,e);return mn(c,u,e)}const mk=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,r){return e-r},leftForLtr(e,r){return e-r}}},gk=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function er(n,t,e){return n?mk(t,e):gk()}function op(n,t){let e,r;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,r=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=r)}function ap(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function lp(n){return n==="angle"?{between:qd,compare:dv,normalize:me}:{between:Qn,compare:(t,e)=>t-e,normalize:t=>t}}function Hu({start:n,end:t,count:e,loop:r,style:i}){return{start:n%e,end:t%e,loop:r&&(t-n+1)%e===0,style:i}}function yk(n,t,e){const{property:r,start:i,end:s}=e,{between:o,normalize:a}=lp(r),l=t.length;let{start:c,end:u,loop:f}=n,h,d;if(f){for(c+=l,u+=l,h=0,d=l;h<d&&o(a(t[c%l][r]),i,s);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:f,style:n.style}}function cp(n,t,e){if(!e)return[n];const{property:r,start:i,end:s}=e,o=t.length,{compare:a,between:l,normalize:c}=lp(r),{start:u,end:f,loop:h,style:d}=yk(n,t,e),p=[];let m=!1,g=null,y,b,v;const k=()=>l(i,v,y)&&a(i,v)!==0,x=()=>a(s,y)===0||l(s,v,y),w=()=>m||k(),S=()=>!m||x();for(let M=u,E=u;M<=f;++M)b=t[M%o],!b.skip&&(y=c(b[r]),y!==v&&(m=l(y,i,s),g===null&&w()&&(g=a(y,i)===0?M:E),g!==null&&S()&&(p.push(Hu({start:g,end:M,loop:h,count:o,style:d})),g=null),E=M,v=y));return g!==null&&p.push(Hu({start:g,end:f,loop:h,count:o,style:d})),p}function up(n,t){const e=[],r=n.segments;for(let i=0;i<r.length;i++){const s=cp(r[i],n.points,t);s.length&&e.push(...s)}return e}function bk(n,t,e,r){let i=0,s=t-1;if(e&&!r)for(;i<t&&!n[i].skip;)i++;for(;i<t&&n[i].skip;)i++;for(i%=t,e&&(s+=i);s>i&&n[s%t].skip;)s--;return s%=t,{start:i,end:s}}function xk(n,t,e,r){const i=n.length,s=[];let o=t,a=n[t],l;for(l=t+1;l<=e;++l){const c=n[l%i];c.skip||c.stop?a.skip||(r=!1,s.push({start:t%i,end:(l-1)%i,loop:r}),t=o=c.stop?l:null):(o=l,a.skip&&(t=l)),a=c}return o!==null&&s.push({start:t%i,end:o%i,loop:r}),s}function vk(n,t){const e=n.points,r=n.options.spanGaps,i=e.length;if(!i)return[];const s=!!n._loop,{start:o,end:a}=bk(e,i,s,r);if(r===!0)return Vu(n,[{start:o,end:a,loop:s}],e,t);const l=a<o?a+i:a,c=!!n._fullLoop&&o===0&&a===i-1;return Vu(n,xk(e,o,l,c),e,t)}function Vu(n,t,e,r){return!r||!r.setContext||!e?t:kk(n,t,e,r)}function kk(n,t,e,r){const i=n._chart.getContext(),s=Wu(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=e.length,c=[];let u=s,f=t[0].start,h=f;function d(p,m,g,y){const b=a?-1:1;if(p!==m){for(p+=l;e[p%l].skip;)p-=b;for(;e[m%l].skip;)m+=b;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:g,style:y}),u=y,f=m%l)}}for(const p of t){f=a?f:p.start;let m=e[f%l],g;for(h=f+1;h<=p.end;h++){const y=e[h%l];g=Wu(r.setContext(Fn(i,{type:"segment",p0:m,p1:y,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),Sk(g,u)&&d(f,h-1,p.loop,u),m=y,u=g}f<h-1&&d(f,h-1,p.loop,u)}return c}function Wu(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Sk(n,t){if(!t)return!1;const e=[],r=function(i,s){return ec(s)?(e.includes(s)||e.push(s),e.indexOf(s)):s};return JSON.stringify(n,r)!==JSON.stringify(t,r)}function Wi(n,t,e){return n.options.clip?n[e]:t[e]}function wk(n,t){const{xScale:e,yScale:r}=n;return e&&r?{left:Wi(e,t,"left"),right:Wi(e,t,"right"),top:Wi(r,t,"top"),bottom:Wi(r,t,"bottom")}:t}function fp(n,t){const e=t._clip;if(e.disabled)return!1;const r=wk(t,n.chartArea);return{left:e.left===!1?0:r.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:r.right+(e.right===!0?0:e.right),top:e.top===!1?0:r.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:r.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Mk{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,r,i){const s=e.listeners[i],o=e.duration;s.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(r-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Yd.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(t),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,r,t,"progress")),s.length||(r.running=!1,this._notify(i,r,t,"complete"),r.initial=!1),e+=s.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let r=e.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,r)),r}listen(t,e,r){this._getAnims(t).listeners[e].push(r)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const r=e.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var we=new Mk;const ju="transparent",Ck={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const r=Nu(n||ju),i=r.valid&&Nu(t||ju);return i&&i.valid?i.mix(r,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class Tk{constructor(t,e,r,i){const s=e[r];i=Hi([t.to,i,s,t.from]);const o=Hi([t.from,s,i]);this._active=!0,this._fn=t.fn||Ck[t.type||typeof o],this._easing=Kr[t.easing]||Kr.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=Hi([t.to,e,i,t.from]),this._from=Hi([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||e<r),!this._active){this._target[i]=a,this._notify(!0);return}if(e<0){this._target[i]=s;return}l=e/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,r)=>{t.push({res:e,rej:r})})}_notify(t){const e=t?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][e]()}}class hp{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!J(t))return;const e=Object.keys(ut.animation),r=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const s=t[i];if(!J(s))return;const o={};for(const a of e)o[a]=s[a];(gt(s.properties)&&s.properties||[i]).forEach(a=>{(a===i||!r.has(a))&&r.set(a,o)})})}_animateOptions(t,e){const r=e.options,i=_k(t,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&Ok(t.options.$animations,r).then(()=>{t.options=r},()=>{}),s}_createAnimations(t,e){const r=this._properties,i=[],s=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(t,e));continue}const u=e[c];let f=s[c];const h=r.get(c);if(f)if(h&&f.active()){f.update(h,u,a);continue}else f.cancel();if(!h||!h.duration){t[c]=u;continue}s[c]=f=new Tk(h,t,c,u),i.push(f)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const r=this._createAnimations(t,e);if(r.length)return we.add(this._chart,r),!0}}function Ok(n,t){const e=[],r=Object.keys(t);for(let i=0;i<r.length;i++){const s=n[r[i]];s&&s.active()&&e.push(s.wait())}return Promise.all(e)}function _k(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Uu(n,t){const e=n&&n.options||{},r=e.reverse,i=e.min===void 0?t:0,s=e.max===void 0?t:0;return{start:r?s:i,end:r?i:s}}function Ek(n,t,e){if(e===!1)return!1;const r=Uu(n,e),i=Uu(t,e);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function Ak(n){let t,e,r,i;return J(n)?(t=n.top,e=n.right,r=n.bottom,i=n.left):t=e=r=i=n,{top:t,right:e,bottom:r,left:i,disabled:n===!1}}function dp(n,t){const e=[],r=n._getSortedDatasetMetas(t);let i,s;for(i=0,s=r.length;i<s;++i)e.push(r[i].index);return e}function Ku(n,t,e,r={}){const i=n.keys,s=r.mode==="single";let o,a,l,c;if(t===null)return;let u=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===e){if(u=!0,r.all)continue;break}c=n.values[l],Dt(c)&&(s||t===0||ar(t)===ar(c))&&(t+=c)}return!u&&!r.all?0:t}function Dk(n,t){const{iScale:e,vScale:r}=t,i=e.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[i]:u,[s]:n[u]};return a}function ma(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function Pk(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function Nk(n){const{min:t,max:e,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function Ik(n,t,e){const r=n[t]||(n[t]={});return r[e]||(r[e]={})}function qu(n,t,e,r){for(const i of t.getMatchingVisibleMetas(r).reverse()){const s=n[i.index];if(e&&s>0||!e&&s<0)return i.index}return null}function Ju(n,t){const{chart:e,_cachedMeta:r}=n,i=e._stacks||(e._stacks={}),{iScale:s,vScale:o,index:a}=r,l=s.axis,c=o.axis,u=Pk(s,o,r),f=t.length;let h;for(let d=0;d<f;++d){const p=t[d],{[l]:m,[c]:g}=p,y=p._stacks||(p._stacks={});h=y[c]=Ik(i,u,m),h[a]=g,h._top=qu(h,o,!0,r.type),h._bottom=qu(h,o,!1,r.type);const b=h._visualValues||(h._visualValues={});b[a]=g}}function ga(n,t){const e=n.scales;return Object.keys(e).filter(r=>e[r].axis===t).shift()}function Rk(n,t){return Fn(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Lk(n,t,e){return Fn(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Mr(n,t){const e=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){t=t||n._parsed;for(const i of t){const s=i._stacks;if(!s||s[r]===void 0||s[r][e]===void 0)return;delete s[r][e],s[r]._visualValues!==void 0&&s[r]._visualValues[e]!==void 0&&delete s[r]._visualValues[e]}}}const ya=n=>n==="reset"||n==="none",Yu=(n,t)=>t?n:Object.assign({},n),Bk=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:dp(e,!0),values:null};class Yr{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=ma(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Mr(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,r=this.getDataset(),i=(f,h,d,p)=>f==="x"?h:f==="r"?p:d,s=e.xAxisID=q(r.xAxisID,ga(t,"x")),o=e.yAxisID=q(r.yAxisID,ga(t,"y")),a=e.rAxisID=q(r.rAxisID,ga(t,"r")),l=e.indexAxis,c=e.iAxisID=i(l,s,o,a),u=e.vAxisID=i(l,o,s,a);e.xScale=this.getScaleForId(s),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Au(this._data,this),t._stacked&&Mr(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),r=this._data;if(J(e)){const i=this._cachedMeta;this._data=Dk(e,i)}else if(r!==e){if(r){Au(r,this);const i=this._cachedMeta;Mr(i),i._parsed=[]}e&&Object.isExtensible(e)&&yv(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=e._stacked;e._stacked=ma(e.vScale,e),e.stack!==r.stack&&(i=!0,Mr(e),e.stack=r.stack),this._resyncElements(t),(i||s!==e._stacked)&&(Ju(this,e._parsed),e._stacked=ma(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,a=s.axis;let l=t===0&&e===i.length?!0:r._sorted,c=t>0&&r._parsed[t-1],u,f,h;if(this._parsing===!1)r._parsed=i,r._sorted=!0,h=i;else{gt(i[t])?h=this.parseArrayData(r,i,t,e):J(i[t])?h=this.parseObjectData(r,i,t,e):h=this.parsePrimitiveData(r,i,t,e);const d=()=>f[a]===null||c&&f[a]<c[a];for(u=0;u<e;++u)r._parsed[u+t]=f=h[u],l&&(d()&&(l=!1),c=f);r._sorted=l}o&&Ju(this,h)}parsePrimitiveData(t,e,r,i){const{iScale:s,vScale:o}=t,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,f=new Array(i);let h,d,p;for(h=0,d=i;h<d;++h)p=h+r,f[h]={[a]:u||s.parse(c[p],p),[l]:o.parse(e[p],p)};return f}parseArrayData(t,e,r,i){const{xScale:s,yScale:o}=t,a=new Array(i);let l,c,u,f;for(l=0,c=i;l<c;++l)u=l+r,f=e[u],a[l]={x:s.parse(f[0],u),y:o.parse(f[1],u)};return a}parseObjectData(t,e,r,i){const{xScale:s,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let u,f,h,d;for(u=0,f=i;u<f;++u)h=u+r,d=e[h],c[u]={x:s.parse(Ts(d,a),h),y:o.parse(Ts(d,l),h)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,r){const i=this.chart,s=this._cachedMeta,o=e[t.axis],a={keys:dp(i,!0),values:e._stacks[t.axis]._visualValues};return Ku(a,o,s.index,{mode:r})}updateRangeFromParsed(t,e,r,i){const s=r[e.axis];let o=s===null?NaN:s;const a=i&&r._stacks[e.axis];i&&a&&(i.values=a,o=Ku(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&t===r.iScale,o=i.length,a=this._getOtherScale(t),l=Bk(e,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:f}=Nk(a);let h,d;function p(){d=i[h];const m=d[a.axis];return!Dt(d[t.axis])||u>m||f<m}for(h=0;h<o&&!(!p()&&(this.updateRangeFromParsed(c,t,d,l),s));++h);if(s){for(h=o-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,t,d,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=e.length;i<s;++i)o=e[i][t.axis],Dt(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,r=e.iScale,i=e.vScale,s=this.getParsed(t);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Ak(q(this.options.clip,Ek(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,r=this._cachedMeta,i=r.data||[],s=e.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(t,s,a,l),u=a;u<a+l;++u){const f=i[u];f.hidden||(f.active&&c?o.push(f):f.draw(t,s))}for(u=0;u<o.length;++u)o[u].draw(t,s)}getStyle(t,e){const r=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,e,r){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];s=o.$context||(o.$context=Lk(this.getContext(),t,o)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=Rk(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!e,s.mode=r,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",r){const i=e==="active",s=this._cachedDataOpts,o=t+"-"+e,a=s[o],l=this.enableOptionSharing&&Os(r);if(a)return Yu(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),f=i?[`${t}Hover`,"hover",t,""]:[t,""],h=c.getOptionScopes(this.getDataset(),u),d=Object.keys(ut.elements[t]),p=()=>this.getContext(r,i,e),m=c.resolveNamedOptions(h,d,p,f);return m.$shared&&(m.$shared=l,s[o]=Object.freeze(Yu(m,l))),m}_resolveAnimations(t,e,r){const i=this.chart,s=this._cachedDataOpts,o=`animation-${e}`,a=s[o];if(a)return a;let l;if(i.options.animation!==!1){const u=this.chart.config,f=u.datasetAnimationScopeKeys(this._type,e),h=u.getOptionScopes(this.getDataset(),f);l=u.createResolver(h,this.getContext(t,r,e))}const c=new hp(i,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||ya(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const r=this.resolveDataElementOptions(t,e),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(e,s)||s!==i;return this.updateSharedOptions(s,e,r),{sharedOptions:s,includeOptions:o}}updateElement(t,e,r,i){ya(i)?Object.assign(t,r):this._resolveAnimations(e,i).update(t,r)}updateSharedOptions(t,e,r){t&&!ya(e)&&this._resolveAnimations(void 0,e).update(t,r)}_setStyle(t,e,r,i){t.active=i;const s=this.getStyle(e,i);this._resolveAnimations(e,r,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,e,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,e,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=r.length,s=e.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,e,r=!0){const i=this._cachedMeta,s=i.data,o=t+e;let a;const l=c=>{for(c.length+=e,a=c.length-1;a>=o;a--)c[a]=c[a-e]};for(l(s),a=t;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(t,e),r&&this.updateElements(s,t,e,"reset")}updateElements(t,e,r,i){}_removeElements(t,e){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(t,e);r._stacked&&Mr(r,i)}r.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,r,i]=t;this[e](r,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}V(Yr,"defaults",{}),V(Yr,"datasetElementType",null),V(Yr,"dataElementType",null);class ba extends Yr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=e,o=this.chart._animationsDisabled;let{start:a,count:l}=kv(e,i,o);this._drawStart=a,this._drawCount=l,Sv(e)&&(a=0,l=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},t),this.updateElements(i,a,l,t)}updateElements(t,e,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:f}=this._getSharedOptions(e,i),h=o.axis,d=a.axis,{spanGaps:p,segment:m}=this.options,g=fi(p)?p:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||i==="none",b=e+r,v=t.length;let k=e>0&&this.getParsed(e-1);for(let x=0;x<v;++x){const w=t[x],S=y?w:{};if(x<e||x>=b){S.skip=!0;continue}const M=this.getParsed(x),E=tt(M[d]),I=S[h]=o.getPixelForValue(M[h],x),A=S[d]=s||E?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,M,l):M[d],x);S.skip=isNaN(I)||isNaN(A)||E,S.stop=x>0&&Math.abs(M[h]-k[h])>g,m&&(S.parsed=M,S.raw=c.data[x]),f&&(S.options=u||this.resolveDataElementOptions(x,w.active?"active":i)),y||this.updateElement(w,x,S,i),k=M}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,r=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}V(ba,"id","line"),V(ba,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),V(ba,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function hn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ac{constructor(t){V(this,"options");this.options=t||{}}static override(t){Object.assign(ac.prototype,t)}init(){}formats(){return hn()}parse(){return hn()}format(){return hn()}add(){return hn()}diff(){return hn()}startOf(){return hn()}endOf(){return hn()}}var $k={_date:ac};function zk(n,t,e,r){const{controller:i,data:s,_sorted:o}=n,a=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&s.length){const c=a._reversePixels?mv:vn;if(r){if(i._sharedOptions){const u=s[0],f=typeof u.getRange=="function"&&u.getRange(t);if(f){const h=c(s,t,e-f),d=c(s,t,e+f);return{lo:h.lo,hi:d.hi}}}}else{const u=c(s,t,e);if(l){const{vScale:f}=i._cachedMeta,{_parsed:h}=n,d=h.slice(0,u.lo+1).reverse().findIndex(m=>!tt(m[f.axis]));u.lo-=Math.max(0,d);const p=h.slice(u.hi).findIndex(m=>!tt(m[f.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:s.length-1}}function Eo(n,t,e,r,i){const s=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:f,hi:h}=zk(s[a],t,o,i);for(let d=f;d<=h;++d){const p=u[d];p.skip||r(p,c,d)}}}function Fk(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(r,i){const s=t?Math.abs(r.x-i.x):0,o=e?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function xa(n,t,e,r,i){const s=[];return!i&&!n.isPointInArea(t)||Eo(n,e,t,function(a,l,c){!i&&!hi(a,n.chartArea,0)||a.inRange(t.x,t.y,r)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function Hk(n,t,e,r){let i=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],r),{angle:f}=hv(o,{x:t.x,y:t.y});qd(f,c,u)&&i.push({element:o,datasetIndex:a,index:l})}return Eo(n,e,t,s),i}function Vk(n,t,e,r,i,s){let o=[];const a=Fk(e);let l=Number.POSITIVE_INFINITY;function c(u,f,h){const d=u.inRange(t.x,t.y,i);if(r&&!d)return;const p=u.getCenterPoint(i);if(!(!!s||n.isPointInArea(p))&&!d)return;const g=a(t,p);g<l?(o=[{element:u,datasetIndex:f,index:h}],l=g):g===l&&o.push({element:u,datasetIndex:f,index:h})}return Eo(n,e,t,c),o}function va(n,t,e,r,i,s){return!s&&!n.isPointInArea(t)?[]:e==="r"&&!r?Hk(n,t,e,i):Vk(n,t,e,r,i,s)}function Gu(n,t,e,r,i){const s=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return Eo(n,e,t,(l,c,u)=>{l[o]&&l[o](t[e],i)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(t.x,t.y,i))}),r&&!a?[]:s}var Wk={modes:{index(n,t,e,r){const i=pn(t,n),s=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?xa(n,i,s,r,o):va(n,i,s,!1,r,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,f=c.data[u];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:u})}),l):[]},dataset(n,t,e,r){const i=pn(t,n),s=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?xa(n,i,s,r,o):va(n,i,s,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(n,t,e,r){const i=pn(t,n),s=e.axis||"xy",o=e.includeInvisible||!1;return xa(n,i,s,r,o)},nearest(n,t,e,r){const i=pn(t,n),s=e.axis||"xy",o=e.includeInvisible||!1;return va(n,i,s,e.intersect,r,o)},x(n,t,e,r){const i=pn(t,n);return Gu(n,i,"x",e.intersect,r)},y(n,t,e,r){const i=pn(t,n);return Gu(n,i,"y",e.intersect,r)}}};const pp=["left","top","right","bottom"];function Cr(n,t){return n.filter(e=>e.pos===t)}function Xu(n,t){return n.filter(e=>pp.indexOf(e.pos)===-1&&e.box.axis===t)}function Tr(n,t){return n.sort((e,r)=>{const i=t?r:e,s=t?e:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function jk(n){const t=[];let e,r,i,s,o,a;for(e=0,r=(n||[]).length;e<r;++e)i=n[e],{position:s,options:{stack:o,stackWeight:a=1}}=i,t.push({index:e,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:a});return t}function Uk(n){const t={};for(const e of n){const{stack:r,pos:i,stackWeight:s}=e;if(!r||!pp.includes(i))continue;const o=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return t}function Kk(n,t){const e=Uk(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=t;let s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];const{fullSize:l}=a.box,c=e[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*r:l&&t.availableWidth,a.height=i):(a.width=r,a.height=u?u*i:l&&t.availableHeight)}return e}function qk(n){const t=jk(n),e=Tr(t.filter(c=>c.box.fullSize),!0),r=Tr(Cr(t,"left"),!0),i=Tr(Cr(t,"right")),s=Tr(Cr(t,"top"),!0),o=Tr(Cr(t,"bottom")),a=Xu(t,"x"),l=Xu(t,"y");return{fullSize:e,leftAndTop:r.concat(s),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:Cr(t,"chartArea"),vertical:r.concat(i).concat(l),horizontal:s.concat(o).concat(a)}}function Qu(n,t,e,r){return Math.max(n[e],t[e])+Math.max(n[r],t[r])}function mp(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function Jk(n,t,e,r){const{pos:i,box:s}=e,o=n.maxPadding;if(!J(i)){e.size&&(n[i]-=e.size);const f=r[e.stack]||{size:0,count:1};f.size=Math.max(f.size,e.horizontal?s.height:s.width),e.size=f.size/f.count,n[i]+=e.size}s.getPadding&&mp(o,s.getPadding());const a=Math.max(0,t.outerWidth-Qu(o,n,"left","right")),l=Math.max(0,t.outerHeight-Qu(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,e.horizontal?{same:c,other:u}:{same:u,other:c}}function Yk(n){const t=n.maxPadding;function e(r){const i=Math.max(t[r]-n[r],0);return n[r]+=i,i}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function Gk(n,t){const e=t.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(t[o],e[o])}),s}return r(n?["left","right"]:["top","bottom"])}function Nr(n,t,e,r){const i=[];let s,o,a,l,c,u;for(s=0,o=n.length,c=0;s<o;++s){a=n[s],l=a.box,l.update(a.width||t.w,a.height||t.h,Gk(a.horizontal,t));const{same:f,other:h}=Jk(t,e,a,r);c|=f&&i.length,u=u||h,l.fullSize||i.push(a)}return c&&Nr(i,t,e,r)||u}function ji(n,t,e,r,i){n.top=e,n.left=t,n.right=t+r,n.bottom=e+i,n.width=r,n.height=i}function Zu(n,t,e,r){const i=e.padding;let{x:s,y:o}=t;for(const a of n){const l=a.box,c=r[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const f=t.w*u,h=c.size||l.height;Os(c.start)&&(o=c.start),l.fullSize?ji(l,i.left,o,e.outerWidth-i.right-i.left,h):ji(l,t.left+c.placed,o,f,h),c.start=o,c.placed+=f,o=l.bottom}else{const f=t.h*u,h=c.size||l.width;Os(c.start)&&(s=c.start),l.fullSize?ji(l,s,i.top,h,e.outerHeight-i.bottom-i.top):ji(l,s,t.top+c.placed,h,f),c.start=s,c.placed+=f,s=l.right}}t.x=s,t.y=o}var Qt={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,r){if(!n)return;const i=ee(n.options.layout.padding),s=Math.max(t-i.width,0),o=Math.max(e-i.height,0),a=qk(n.boxes),l=a.vertical,c=a.horizontal;X(n.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,f=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},i);mp(h,ee(r));const d=Object.assign({maxPadding:h,w:s,h:o,x:i.left,y:i.top},i),p=Kk(l.concat(c),f);Nr(a.fullSize,d,f,p),Nr(l,d,f,p),Nr(c,d,f,p)&&Nr(l,d,f,p),Yk(d),Zu(a.leftAndTop,d,f,p),d.x+=d.w,d.y+=d.h,Zu(a.rightAndBottom,d,f,p),n.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},X(a.chartArea,m=>{const g=m.box;Object.assign(g,n.chartArea),g.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})})}};class gp{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,r){}removeEventListener(t,e,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,r,i){return e=Math.max(0,e||t.width),r=r||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):r)}}isAttached(t){return!0}updateConfig(t){}}class Xk extends gp{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const hs="$chartjs",Qk={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},tf=n=>n===null||n==="";function Zk(n,t){const e=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[hs]={initial:{height:r,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",tf(i)){const s=Fu(n,"width");s!==void 0&&(n.width=s)}if(tf(r))if(n.style.height==="")n.height=n.width/(t||2);else{const s=Fu(n,"height");s!==void 0&&(n.height=s)}return n}const yp=hk?{passive:!0}:!1;function t1(n,t,e){n&&n.addEventListener(t,e,yp)}function e1(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,yp)}function n1(n,t){const e=Qk[n.type]||n.type,{x:r,y:i}=pn(n,t);return{type:e,chart:t,native:n,x:r!==void 0?r:null,y:i!==void 0?i:null}}function As(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function r1(n,t,e){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||As(a.addedNodes,r),o=o&&!As(a.removedNodes,r);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function i1(n,t,e){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||As(a.removedNodes,r),o=o&&!As(a.addedNodes,r);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const pi=new Map;let ef=0;function bp(){const n=window.devicePixelRatio;n!==ef&&(ef=n,pi.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function s1(n,t){pi.size||window.addEventListener("resize",bp),pi.set(n,t)}function o1(n){pi.delete(n),pi.size||window.removeEventListener("resize",bp)}function a1(n,t,e){const r=n.canvas,i=r&&oc(r);if(!i)return;const s=Gd((a,l)=>{const c=i.clientWidth;e(a,l),c<i.clientWidth&&e()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(i),s1(n,s),o}function ka(n,t,e){e&&e.disconnect(),t==="resize"&&o1(n)}function l1(n,t,e){const r=n.canvas,i=Gd(s=>{n.ctx!==null&&e(n1(s,n))},n);return t1(r,t,i),i}class c1 extends gp{acquireContext(t,e){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(Zk(t,e),r):null}releaseContext(t){const e=t.canvas;if(!e[hs])return!1;const r=e[hs].initial;["height","width"].forEach(s=>{const o=r[s];tt(o)?e.removeAttribute(s):e.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{e.style[s]=i[s]}),e.width=e.width,delete e[hs],!0}addEventListener(t,e,r){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),o={attach:r1,detach:i1,resize:a1}[e]||l1;i[e]=o(t,e,r)}removeEventListener(t,e){const r=t.$proxies||(t.$proxies={}),i=r[e];if(!i)return;({attach:ka,detach:ka,resize:ka}[e]||e1)(t,e,i),r[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,r,i){return fk(t,e,r,i)}isAttached(t){const e=t&&oc(t);return!!(e&&e.isConnected)}}function u1(n){return!sc()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?Xk:c1}class Ne{constructor(){V(this,"x");V(this,"y");V(this,"active",!1);V(this,"options");V(this,"$animations")}tooltipPosition(t){const{x:e,y:r}=this.getProps(["x","y"],t);return{x:e,y:r}}hasValue(){return fi(this.x)&&fi(this.y)}getProps(t,e){const r=this.$animations;if(!e||!r)return this;const i={};return t.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}}V(Ne,"defaults",{}),V(Ne,"defaultRoutes");function f1(n,t){const e=n.options.ticks,r=h1(n),i=Math.min(e.maxTicksLimit||r,r),s=e.major.enabled?p1(t):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>i)return m1(t,c,s,o/i),c;const u=d1(s,t,i);if(o>0){let f,h;const d=o>1?Math.round((l-a)/(o-1)):null;for(Ui(t,c,u,tt(d)?0:a-d,a),f=0,h=o-1;f<h;f++)Ui(t,c,u,s[f],s[f+1]);return Ui(t,c,u,l,tt(d)?t.length:l+d),c}return Ui(t,c,u),c}function h1(n){const t=n.options.offset,e=n._tickSize(),r=n._length/e+(t?0:1),i=n._maxLength/e;return Math.floor(Math.min(r,i))}function d1(n,t,e){const r=g1(n),i=t.length/e;if(!r)return Math.max(i,1);const s=av(r);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>i)return l}return Math.max(i,1)}function p1(n){const t=[];let e,r;for(e=0,r=n.length;e<r;e++)n[e].major&&t.push(e);return t}function m1(n,t,e,r){let i=0,s=e[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===s&&(t.push(n[o]),i++,s=e[i*r])}function Ui(n,t,e,r,i){const s=q(r,0),o=Math.min(q(i,n.length),n.length);let a=0,l,c,u;for(e=Math.ceil(e),i&&(l=i-r,e=l/Math.floor(l/e)),u=s;u<0;)a++,u=Math.round(s+a*e);for(c=Math.max(s,0);c<o;c++)c===u&&(t.push(n[c]),a++,u=Math.round(s+a*e))}function g1(n){const t=n.length;let e,r;if(t<2)return!1;for(r=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==r)return!1;return r}const y1=n=>n==="left"?"right":n==="right"?"left":n,nf=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,rf=(n,t)=>Math.min(t||n,n);function sf(n,t){const e=[],r=n.length/t,i=n.length;let s=0;for(;s<i;s+=r)e.push(n[Math.floor(s)]);return e}function b1(n,t,e){const r=n.ticks.length,i=Math.min(t,r-1),s=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(e&&(r===1?c=Math.max(l-s,o-l):t===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<t?c:-c,l<s-a||l>o+a)))return l}function x1(n,t){X(n,e=>{const r=e.gc,i=r.length/2;let s;if(i>t){for(s=0;s<i;++s)delete e.data[r[s]];r.splice(0,i)}})}function Or(n){return n.drawTicks?n.tickLength:0}function of(n,t){if(!n.display)return 0;const e=At(n.font,t),r=ee(n.padding);return(gt(n.text)?n.text.length:1)*e.lineHeight+r.height}function v1(n,t){return Fn(n,{scale:t,type:"scale"})}function k1(n,t,e){return Fn(n,{tick:e,index:t,type:"tick"})}function S1(n,t,e){let r=tc(n);return(e&&t!=="right"||!e&&t==="right")&&(r=y1(r)),r}function w1(n,t,e,r){const{top:i,left:s,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let f=0,h,d,p;const m=o-i,g=a-s;if(n.isHorizontal()){if(d=_t(r,s,a),J(e)){const y=Object.keys(e)[0],b=e[y];p=u[y].getPixelForValue(b)+m-t}else e==="center"?p=(c.bottom+c.top)/2+m-t:p=nf(n,e,t);h=a-s}else{if(J(e)){const y=Object.keys(e)[0],b=e[y];d=u[y].getPixelForValue(b)-g+t}else e==="center"?d=(c.left+c.right)/2-g+t:d=nf(n,e,t);p=_t(r,o,i),f=e==="left"?-re:re}return{titleX:d,titleY:p,maxWidth:h,rotation:f}}class xr extends Ne{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:r,_suggestedMax:i}=this;return t=le(t,Number.POSITIVE_INFINITY),e=le(e,Number.NEGATIVE_INFINITY),r=le(r,Number.POSITIVE_INFINITY),i=le(i,Number.NEGATIVE_INFINITY),{min:le(t,r),max:le(e,i),minDefined:Dt(t),maxDefined:Dt(e)}}getMinMax(t){let{min:e,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:e,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,t),i||(e=Math.min(e,o.min)),s||(r=Math.max(r,o.max));return e=s&&e>r?r:e,r=i&&e>r?e:r,{min:le(e,le(r,e)),max:le(r,le(e,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nt(this.options.beforeUpdate,[this])}update(t,e,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Wv(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?sf(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=f1(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,r;this.isHorizontal()?(e=this.left,r=this.right):(e=this.top,r=this.bottom,t=!t),this._startPixel=e,this._endPixel=r,this._reversePixels=t,this._length=r-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nt(this.options.afterUpdate,[this])}beforeSetDimensions(){nt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),nt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r],s.label=nt(e.callback,[s.value,r,t],this)}afterTickToLabelConversion(){nt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,r=rf(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,s=e.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!e.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),f=u.widest.width,h=u.highest.height,d=Xt(this.chart.width-f,0,this.maxWidth);a=t.offset?this.maxWidth/r:d/(r-1),f+6>a&&(a=d/(r-(t.offset?.5:1)),l=this.maxHeight-Or(t.grid)-e.padding-of(t.title,this.chart.options.font),c=Math.sqrt(f*f+h*h),o=fv(Math.min(Math.asin(Xt((u.highest.height+6)/a,-1,1)),Math.asin(Xt(l/c,-1,1))-Math.asin(Xt(h/c,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){nt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=of(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=Or(s)+l):(t.height=this.maxHeight,t.width=Or(s)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:f,highest:h}=this._getLabelSizes(),d=r.padding*2,p=xn(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const y=r.mirror?0:g*f.width+m*h.height;t.height=Math.min(this.maxHeight,t.height+y+d)}else{const y=r.mirror?0:m*f.width+g*h.height;t.width=Math.min(this.maxWidth,t.width+y+d)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,r,i){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,d=0;l?c?(h=i*t.width,d=r*e.height):(h=r*t.height,d=i*e.width):s==="start"?d=e.width:s==="end"?h=t.width:s!=="inner"&&(h=t.width/2,d=e.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((d-f+o)*this.width/(this.width-f),0)}else{let u=e.height/2,f=t.height/2;s==="start"?(u=0,f=t.height):s==="end"&&(u=e.height,f=0),this.paddingTop=u+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,r;for(e=0,r=t.length;e<r;e++)tt(t[e].label)&&(t.splice(e,1),r--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let r=this.ticks;e<r.length&&(r=sf(r,e)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,r){const{ctx:i,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(e/rf(e,r));let c=0,u=0,f,h,d,p,m,g,y,b,v,k,x;for(f=0;f<e;f+=l){if(p=t[f].label,m=this._resolveTickFontOptions(f),i.font=g=m.string,y=s[g]=s[g]||{data:{},gc:[]},b=m.lineHeight,v=k=0,!tt(p)&&!gt(p))v=Ru(i,y.data,y.gc,v,p),k=b;else if(gt(p))for(h=0,d=p.length;h<d;++h)x=p[h],!tt(x)&&!gt(x)&&(v=Ru(i,y.data,y.gc,v,x),k+=b);o.push(v),a.push(k),c=Math.max(v,c),u=Math.max(k,u)}x1(s,e);const w=o.indexOf(c),S=a.indexOf(u),M=E=>({width:o[E]||0,height:a[E]||0});return{first:M(0),last:M(e-1),widest:M(w),highest:M(S),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return pv(this._alignToPixels?fn(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const r=e[t];return r.$context||(r.$context=k1(this.getContext(),t,r))}return this.$context||(this.$context=v1(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=xn(this.labelRotation),r=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*r>a*i?a/r:l/i:l*i<a*r?l/r:a/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:a}=i,l=s.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),h=Or(s),d=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,y=function(T){return fn(r,T,m)};let b,v,k,x,w,S,M,E,I,A,z,K;if(o==="top")b=y(this.bottom),S=this.bottom-h,E=b-g,A=y(t.top)+g,K=t.bottom;else if(o==="bottom")b=y(this.top),A=t.top,K=y(t.bottom)-g,S=b+g,E=this.top+h;else if(o==="left")b=y(this.right),w=this.right-h,M=b-g,I=y(t.left)+g,z=t.right;else if(o==="right")b=y(this.left),I=t.left,z=y(t.right)-g,w=b+g,M=this.left+h;else if(e==="x"){if(o==="center")b=y((t.top+t.bottom)/2+.5);else if(J(o)){const T=Object.keys(o)[0],P=o[T];b=y(this.chart.scales[T].getPixelForValue(P))}A=t.top,K=t.bottom,S=b+g,E=S+h}else if(e==="y"){if(o==="center")b=y((t.left+t.right)/2);else if(J(o)){const T=Object.keys(o)[0],P=o[T];b=y(this.chart.scales[T].getPixelForValue(P))}w=b-g,M=w-h,I=t.left,z=t.right}const D=q(i.ticks.maxTicksLimit,f),C=Math.max(1,Math.ceil(f/D));for(v=0;v<f;v+=C){const T=this.getContext(v),P=s.setContext(T),N=a.setContext(T),F=P.lineWidth,$=P.color,Y=N.dash||[],Q=N.dashOffset,rt=P.tickWidth,it=P.tickColor,bt=P.tickBorderDash||[],Bt=P.tickBorderDashOffset;k=b1(this,v,l),k!==void 0&&(x=fn(r,k,F),c?w=M=I=z=x:S=E=A=K=x,d.push({tx1:w,ty1:S,tx2:M,ty2:E,x1:I,y1:A,x2:z,y2:K,width:F,color:$,borderDash:Y,borderDashOffset:Q,tickWidth:rt,tickColor:it,tickBorderDash:bt,tickBorderDashOffset:Bt}))}return this._ticksLength=f,this._borderValue=b,d}_computeLabelItems(t){const e=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:f}=s,h=Or(r.grid),d=h+u,p=f?-u:d,m=-xn(this.labelRotation),g=[];let y,b,v,k,x,w,S,M,E,I,A,z,K="middle";if(i==="top")w=this.bottom-p,S=this._getXAxisLabelAlignment();else if(i==="bottom")w=this.top+p,S=this._getXAxisLabelAlignment();else if(i==="left"){const C=this._getYAxisLabelAlignment(h);S=C.textAlign,x=C.x}else if(i==="right"){const C=this._getYAxisLabelAlignment(h);S=C.textAlign,x=C.x}else if(e==="x"){if(i==="center")w=(t.top+t.bottom)/2+d;else if(J(i)){const C=Object.keys(i)[0],T=i[C];w=this.chart.scales[C].getPixelForValue(T)+d}S=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")x=(t.left+t.right)/2-d;else if(J(i)){const C=Object.keys(i)[0],T=i[C];x=this.chart.scales[C].getPixelForValue(T)}S=this._getYAxisLabelAlignment(h).textAlign}e==="y"&&(l==="start"?K="top":l==="end"&&(K="bottom"));const D=this._getLabelSizes();for(y=0,b=a.length;y<b;++y){v=a[y],k=v.label;const C=s.setContext(this.getContext(y));M=this.getPixelForTick(y)+s.labelOffset,E=this._resolveTickFontOptions(y),I=E.lineHeight,A=gt(k)?k.length:1;const T=A/2,P=C.color,N=C.textStrokeColor,F=C.textStrokeWidth;let $=S;o?(x=M,S==="inner"&&(y===b-1?$=this.options.reverse?"left":"right":y===0?$=this.options.reverse?"right":"left":$="center"),i==="top"?c==="near"||m!==0?z=-A*I+I/2:c==="center"?z=-D.highest.height/2-T*I+I:z=-D.highest.height+I/2:c==="near"||m!==0?z=I/2:c==="center"?z=D.highest.height/2-T*I:z=D.highest.height-A*I,f&&(z*=-1),m!==0&&!C.showLabelBackdrop&&(x+=I/2*Math.sin(m))):(w=M,z=(1-A)*I/2);let Y;if(C.showLabelBackdrop){const Q=ee(C.backdropPadding),rt=D.heights[y],it=D.widths[y];let bt=z-Q.top,Bt=0-Q.left;switch(K){case"middle":bt-=rt/2;break;case"bottom":bt-=rt;break}switch(S){case"center":Bt-=it/2;break;case"right":Bt-=it;break;case"inner":y===b-1?Bt-=it:y>0&&(Bt-=it/2);break}Y={left:Bt,top:bt,width:it+Q.width,height:rt+Q.height,color:C.backdropColor}}g.push({label:k,font:E,textOffset:z,options:{rotation:m,color:P,strokeColor:N,strokeWidth:F,textAlign:$,textBaseline:K,translation:[x,w],backdrop:Y}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-xn(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),a=t+s,l=o.widest.width;let c,u;return e==="left"?i?(u=this.right+s,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):e==="right"?i?(u=this.left+s,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:r,top:i,width:s,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(r,i,s,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(s=>s.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(e.display)for(s=0,o=i.length;s<o;++s){const l=i[s];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,f,h;this.isHorizontal()?(c=fn(t,this.left,o)-o/2,u=fn(t,this.right,a)+a/2,f=h=l):(f=fn(t,this.top,o)-o/2,h=fn(t,this.bottom,a)+a/2,c=u=l),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(c,f),e.lineTo(u,h),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&To(r,i);const s=this.getLabelItems(t);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;di(r,c,0,u,l,a)}i&&Oo(r)}drawTitle(){const{ctx:t,options:{position:e,title:r,reverse:i}}=this;if(!r.display)return;const s=At(r.font),o=ee(r.padding),a=r.align;let l=s.lineHeight/2;e==="bottom"||e==="center"||J(e)?(l+=o.bottom,gt(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:f,rotation:h}=w1(this,l,e,a);di(t,r.text,0,0,s,{color:r.color,maxWidth:f,rotation:h,textAlign:S1(a,e,i),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,r=q(t.grid&&t.grid.z,-1),i=q(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==xr.prototype.draw?[{z:e,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=e.length;s<o;++s){const a=e[s];a[r]===this.id&&(!t||a.type===t)&&i.push(a)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return At(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ki{constructor(t,e,r){this.type=t,this.scope=e,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let r;T1(e)&&(r=this.register(e));const i=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,M1(t,o,r),this.override&&ut.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,r=t.id,i=this.scope;r in e&&delete e[r],i&&r in ut[i]&&(delete ut[i][r],this.override&&delete Nn[r])}}function M1(n,t,e){const r=ui(Object.create(null),[e?ut.get(e):{},ut.get(t),n.defaults]);ut.set(t,r),n.defaultRoutes&&C1(t,n.defaultRoutes),n.descriptors&&ut.describe(t,n.descriptors)}function C1(n,t){Object.keys(t).forEach(e=>{const r=e.split("."),i=r.pop(),s=[n].concat(r).join("."),o=t[e].split("."),a=o.pop(),l=o.join(".");ut.route(s,i,l,a)})}function T1(n){return"id"in n&&"defaults"in n}class O1{constructor(){this.controllers=new Ki(Yr,"datasets",!0),this.elements=new Ki(Ne,"elements"),this.plugins=new Ki(Object,"plugins"),this.scales=new Ki(xr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,r){[...e].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(t,s,i):X(i,o=>{const a=r||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,r){const i=Ql(t);nt(r["before"+i],[],r),e[t](r),nt(r["after"+i],[],r)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const r=this._typedRegistries[e];if(r.isForType(t))return r}return this.plugins}_get(t,e,r){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+r+".");return i}}var ue=new O1;class _1{constructor(){this._init=void 0}notify(t,e,r,i){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const s=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(s,t,e,r);return e==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,r,i){i=i||{};for(const s of t){const o=s.plugin,a=o[r],l=[e,i,s.options];if(nt(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){tt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const r=t&&t.config,i=q(r.options&&r.options.plugins,{}),s=E1(r);return i===!1&&!e?[]:D1(t,s,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(e,r),t,"stop"),this._notify(i(r,e),t,"start")}}function E1(n){const t={},e=[],r=Object.keys(ue.plugins.items);for(let s=0;s<r.length;s++)e.push(ue.getPlugin(r[s]));const i=n.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function A1(n,t){return!t&&n===!1?null:n===!0?{}:n}function D1(n,{plugins:t,localIds:e},r,i){const s=[],o=n.getContext();for(const a of t){const l=a.id,c=A1(r[l],i);c!==null&&s.push({plugin:a,options:P1(n.config,{plugin:a,local:e[l]},c,o)})}return s}function P1(n,{plugin:t,local:e},r,i){const s=n.pluginScopeKeys(t),o=n.getOptionScopes(r,s);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ll(n,t){const e=ut.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function N1(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function I1(n,t){return n===t?"_index_":"_value_"}function af(n){if(n==="x"||n==="y"||n==="r")return n}function R1(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function cl(n,...t){if(af(n))return n;for(const e of t){const r=e.axis||R1(e.position)||n.length>1&&af(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function lf(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function L1(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(e.length)return lf(n,"x",e[0])||lf(n,"y",e[0])}return{}}function B1(n,t){const e=Nn[n.type]||{scales:{}},r=t.scales||{},i=ll(n.type,t),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!J(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=cl(o,a,L1(o,n),ut.scales[a.type]),c=I1(l,i),u=e.scales||{};s[o]=jr(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||ll(a,t),u=(Nn[a]||{}).scales||{};Object.keys(u).forEach(f=>{const h=N1(f,l),d=o[h+"AxisID"]||h;s[d]=s[d]||Object.create(null),jr(s[d],[{axis:h},r[d],u[f]])})}),Object.keys(s).forEach(o=>{const a=s[o];jr(a,[ut.scales[a.type],ut.scale])}),s}function xp(n){const t=n.options||(n.options={});t.plugins=q(t.plugins,{}),t.scales=B1(n,t)}function vp(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function $1(n){return n=n||{},n.data=vp(n.data),xp(n),n}const cf=new Map,kp=new Set;function qi(n,t){let e=cf.get(n);return e||(e=t(),cf.set(n,e),kp.add(e)),e}const _r=(n,t,e)=>{const r=Ts(t,e);r!==void 0&&n.add(r)};class z1{constructor(t){this._config=$1(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=vp(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),xp(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return qi(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return qi(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return qi(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,r=this.type;return qi(`${r}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const r=this._scopeCache;let i=r.get(t);return(!i||e)&&(i=new Map,r.set(t,i)),i}getOptionScopes(t,e,r){const{options:i,type:s}=this,o=this._cachedScopes(t,r),a=o.get(e);if(a)return a;const l=new Set;e.forEach(u=>{t&&(l.add(t),u.forEach(f=>_r(l,t,f))),u.forEach(f=>_r(l,i,f)),u.forEach(f=>_r(l,Nn[s]||{},f)),u.forEach(f=>_r(l,ut,f)),u.forEach(f=>_r(l,sl,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),kp.has(e)&&o.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,Nn[e]||{},ut.datasets[e]||{},{type:e},ut,sl]}resolveNamedOptions(t,e,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=uf(this._resolverCache,t,i);let l=o;if(H1(o,e)){s.$shared=!1,r=en(r)?r():r;const c=this.createResolver(t,r,a);l=lr(o,r,c)}for(const c of e)s[c]=l[c];return s}createResolver(t,e,r=[""],i){const{resolver:s}=uf(this._resolverCache,t,r);return J(e)?lr(s,e,void 0,i):s}}function uf(n,t,e){let r=n.get(t);r||(r=new Map,n.set(t,r));const i=e.join();let s=r.get(i);return s||(s={resolver:nc(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},r.set(i,s)),s}const F1=n=>J(n)&&Object.getOwnPropertyNames(n).some(t=>en(n[t]));function H1(n,t){const{isScriptable:e,isIndexable:r}=ep(n);for(const i of t){const s=e(i),o=r(i),a=(o||s)&&n[i];if(s&&(en(a)||F1(a))||o&&gt(a))return!0}return!1}var V1="4.5.1";const W1=["top","bottom","left","right","chartArea"];function ff(n,t){return n==="top"||n==="bottom"||W1.indexOf(n)===-1&&t==="x"}function hf(n,t){return function(e,r){return e[n]===r[n]?e[t]-r[t]:e[n]-r[n]}}function df(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),nt(e&&e.onComplete,[n],t)}function j1(n){const t=n.chart,e=t.options.animation;nt(e&&e.onProgress,[n],t)}function Sp(n){return sc()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const ds={},pf=n=>{const t=Sp(n);return Object.values(ds).filter(e=>e.canvas===t).pop()};function U1(n,t,e){const r=Object.keys(n);for(const i of r){const s=+i;if(s>=t){const o=n[i];delete n[i],(e>0||s>t)&&(n[s+e]=o)}}}function K1(n,t,e,r){return!e||n.type==="mouseout"?null:r?t:n}class gn{static register(...t){ue.add(...t),mf()}static unregister(...t){ue.remove(...t),mf()}constructor(t,e){const r=this.config=new z1(e),i=Sp(t),s=pf(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||u1(i)),this.platform.updateConfig(r);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Qx(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _1,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=xv(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],ds[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}we.listen(this,"complete",df),we.listen(this,"progress",j1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:r,height:i,_aspectRatio:s}=this;return tt(t)?e&&s?s:i?r/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ue}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():zu(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Lu(this.canvas,this.ctx),this}stop(){return we.stop(this),this}resize(t,e){we.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,e,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,zu(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),nt(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};X(e,(r,i)=>{r.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,r=this.scales,i=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];e&&(s=s.concat(Object.keys(e).map(o=>{const a=e[o],l=cl(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),X(s,o=>{const a=o.options,l=a.id,c=cl(l,a),u=q(a.type,o.dtype);(a.position===void 0||ff(a.position,c)!==ff(o.dposition))&&(a.position=o.dposition),i[l]=!0;let f=null;if(l in r&&r[l].type===u)f=r[l];else{const h=ue.getScale(u);f=new h({id:l,type:u,ctx:this.ctx,chart:this}),r[f.id]=f}f.init(a,t)}),X(i,(o,a)=>{o||delete r[a]}),X(r,o=>{Qt.configure(this,o,o.options),Qt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,r=t.length;if(t.sort((i,s)=>i.index-s.index),r>e){for(let i=e;i<r;++i)this._destroyDatasetMeta(i);t.splice(e,r-e)}this._sortedMetasets=t.slice(0).sort(hf("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((r,i)=>{e.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=e.length;r<i;r++){const s=e[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||ll(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=ue.getController(a),{datasetElementType:c,dataElementType:u}=ut.datasets[a];Object.assign(l,{dataElementType:ue.getElement(u),datasetElementType:c&&ue.getElement(c)}),o.controller=new l(this,r),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){X(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const r=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:f}=this.getDatasetMeta(c),h=!i&&s.indexOf(f)===-1;f.buildOrUpdateElements(h),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||X(s,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(hf("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){X(this.scales,t=>{Qt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!Tu(e,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of e){const o=r==="_removeElements"?-s:s;U1(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,r=s=>new Set(t.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<e;s++)if(!Tu(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Qt.update(this,this.width,this.height,t);const e=this.chartArea,r=e.width<=0||e.height<=0;this._layers=[],X(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,r=this.data.datasets.length;e<r;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,r=this.data.datasets.length;e<r;++e)this._updateDataset(e,en(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const r=this.getDatasetMeta(t),i={meta:r,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(we.has(this)?this.attached&&!we.running(this)&&we.start(this):(this.draw(),df({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,r=[];let i,s;for(i=0,s=e.length;i<s;++i){const o=e[i];(!t||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,r={meta:t,index:t.index,cancelable:!0},i=fp(this,t);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(i&&To(e,i),t.controller.draw(),i&&Oo(e),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return hi(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,r,i){const s=Wk.modes[e];return typeof s=="function"?s(this,t,r,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],r=this._metasets;let i=r.filter(s=>s&&s._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=Fn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!e.hidden}setDatasetVisibility(t,e){const r=this.getDatasetMeta(t);r.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,r){const i=r?"show":"hide",s=this.getDatasetMeta(t),o=s.controller._resolveAnimations(void 0,i);Os(e)?(s.data[e].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),we.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Lu(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete ds[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,r=(s,o)=>{e.addEventListener(this,s,o),t[s]=o},i=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};X(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,r=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},i=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){X(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},X(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,r){const i=r?"set":"remove";let s,o,a,l;for(e==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],r=t.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!Ms(r,e)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,e))}notifyPlugins(t,e,r){return this._plugins.notify(this,t,e,r)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,r){const i=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(f=>u.datasetIndex===f.datasetIndex&&u.index===f.index)),o=s(e,t),a=r?t:s(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const r={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(t,e,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(t,e,r){const{_active:i=[],options:s}=this,o=e,a=this._getActiveElements(t,i,r,o),l=iv(t),c=K1(t,this._lastEvent,r,l);r&&(this._lastEvent=null,nt(s.onHover,[t,a,this],this),l&&nt(s.onClick,[t,a,this],this));const u=!Ms(a,i);return(u||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=c,u}_getActiveElements(t,e,r,i){if(t.type==="mouseout")return[];if(!r)return e;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}}V(gn,"defaults",ut),V(gn,"instances",ds),V(gn,"overrides",Nn),V(gn,"registry",ue),V(gn,"version",V1),V(gn,"getChart",pf);function mf(){return X(gn.instances,n=>n._plugins.invalidate())}function wp(n,t,e=t){n.lineCap=q(e.borderCapStyle,t.borderCapStyle),n.setLineDash(q(e.borderDash,t.borderDash)),n.lineDashOffset=q(e.borderDashOffset,t.borderDashOffset),n.lineJoin=q(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=q(e.borderWidth,t.borderWidth),n.strokeStyle=q(e.borderColor,t.borderColor)}function q1(n,t,e){n.lineTo(e.x,e.y)}function J1(n){return n.stepped?Nv:n.tension||n.cubicInterpolationMode==="monotone"?Iv:q1}function Mp(n,t,e={}){const r=n.length,{start:i=0,end:s=r-1}=e,{start:o,end:a}=t,l=Math.max(i,o),c=Math.min(s,a),u=i<o&&s<o||i>a&&s>a;return{count:r,start:l,loop:t.loop,ilen:c<l&&!u?r+c-l:c-l}}function Y1(n,t,e,r){const{points:i,options:s}=t,{count:o,start:a,loop:l,ilen:c}=Mp(i,e,r),u=J1(s);let{move:f=!0,reverse:h}=r||{},d,p,m;for(d=0;d<=c;++d)p=i[(a+(h?c-d:d))%o],!p.skip&&(f?(n.moveTo(p.x,p.y),f=!1):u(n,m,p,h,s.stepped),m=p);return l&&(p=i[(a+(h?c:0))%o],u(n,m,p,h,s.stepped)),!!l}function G1(n,t,e,r){const i=t.points,{count:s,start:o,ilen:a}=Mp(i,e,r),{move:l=!0,reverse:c}=r||{};let u=0,f=0,h,d,p,m,g,y;const b=k=>(o+(c?a-k:k))%s,v=()=>{m!==g&&(n.lineTo(u,g),n.lineTo(u,m),n.lineTo(u,y))};for(l&&(d=i[b(0)],n.moveTo(d.x,d.y)),h=0;h<=a;++h){if(d=i[b(h)],d.skip)continue;const k=d.x,x=d.y,w=k|0;w===p?(x<m?m=x:x>g&&(g=x),u=(f*u+k)/++f):(v(),n.lineTo(k,x),p=w,f=0,m=g=x),y=x}v()}function ul(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?G1:Y1}function X1(n){return n.stepped?dk:n.tension||n.cubicInterpolationMode==="monotone"?pk:mn}function Q1(n,t,e,r){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,r)&&i.closePath()),wp(n,t.options),n.stroke(i)}function Z1(n,t,e,r){const{segments:i,options:s}=t,o=ul(t);for(const a of i)wp(n,s,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+r-1})&&n.closePath(),n.stroke()}const tS=typeof Path2D=="function";function eS(n,t,e,r){tS&&!t.options.segment?Q1(n,t,e,r):Z1(n,t,e,r)}class kn extends Ne{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;sk(this._points,r,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=vk(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,r=t.length;return r&&e[t[r-1].end]}interpolate(t,e){const r=this.options,i=t[e],s=this.points,o=up(this,{property:e,start:i,end:i});if(!o.length)return;const a=[],l=X1(r);let c,u;for(c=0,u=o.length;c<u;++c){const{start:f,end:h}=o[c],d=s[f],p=s[h];if(d===p){a.push(d);continue}const m=Math.abs((i-d[e])/(p[e]-d[e])),g=l(d,p,m,r.stepped);g[e]=t[e],a.push(g)}return a.length===1?a[0]:a}pathSegment(t,e,r){return ul(this)(t,this,e,r)}path(t,e,r){const i=this.segments,s=ul(this);let o=this._loop;e=e||0,r=r||this.points.length-e;for(const a of i)o&=s(t,this,a,{start:e,end:e+r-1});return!!o}draw(t,e,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),eS(t,this,r,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}V(kn,"id","line"),V(kn,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),V(kn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),V(kn,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function gf(n,t,e,r){const i=n.options,{[e]:s}=n.getProps([e],r);return Math.abs(t-s)<i.radius+i.hitRadius}class Sa extends Ne{constructor(e){super();V(this,"parsed");V(this,"skip");V(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,r,i){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(r-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,r){return gf(this,e,"x",r)}inYRange(e,r){return gf(this,e,"y",r)}getCenterPoint(e){const{x:r,y:i}=this.getProps(["x","y"],e);return{x:r,y:i}}size(e){e=e||this.options||{};let r=e.radius||0;r=Math.max(r,r&&e.hoverRadius||0);const i=r&&e.borderWidth||0;return(r+i)*2}draw(e,r){const i=this.options;this.skip||i.radius<.1||!hi(this,r,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,ol(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}V(Sa,"id","point"),V(Sa,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),V(Sa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function nS(n,t,e){const r=n.segments,i=n.points,s=t.points,o=[];for(const a of r){let{start:l,end:c}=a;c=Ao(l,c,i);const u=fl(e,i[l],i[c],a.loop);if(!t.segments){o.push({source:a,target:u,start:i[l],end:i[c]});continue}const f=up(t,u);for(const h of f){const d=fl(e,s[h.start],s[h.end],h.loop),p=cp(a,i,d);for(const m of p)o.push({source:m,target:h,start:{[e]:yf(u,d,"start",Math.max)},end:{[e]:yf(u,d,"end",Math.min)}})}}return o}function fl(n,t,e,r){if(r)return;let i=t[n],s=e[n];return n==="angle"&&(i=me(i),s=me(s)),{property:n,start:i,end:s}}function rS(n,t){const{x:e=null,y:r=null}=n||{},i=t.points,s=[];return t.segments.forEach(({start:o,end:a})=>{a=Ao(o,a,i);const l=i[o],c=i[a];r!==null?(s.push({x:l.x,y:r}),s.push({x:c.x,y:r})):e!==null&&(s.push({x:e,y:l.y}),s.push({x:e,y:c.y}))}),s}function Ao(n,t,e){for(;t>n;t--){const r=e[t];if(!isNaN(r.x)&&!isNaN(r.y))break}return t}function yf(n,t,e,r){return n&&t?r(n[e],t[e]):n?n[e]:t?t[e]:0}function Cp(n,t){let e=[],r=!1;return gt(n)?(r=!0,e=n):e=rS(n,t),e.length?new kn({points:e,options:{tension:0},_loop:r,_fullLoop:r}):null}function bf(n){return n&&n.fill!==!1}function iS(n,t,e){let i=n[t].fill;const s=[t];let o;if(!e)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!Dt(i))return i;if(o=n[i],!o)return!1;if(o.visible)return i;s.push(i),i=o.fill}return!1}function sS(n,t,e){const r=cS(n);if(J(r))return isNaN(r.value)?!1:r;let i=parseFloat(r);return Dt(i)&&Math.floor(i)===i?oS(r[0],t,i,e):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function oS(n,t,e,r){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=r?!1:e}function aS(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:J(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function lS(n,t,e){let r;return n==="start"?r=e:n==="end"?r=t.options.reverse?t.min:t.max:J(n)?r=n.value:r=t.getBaseValue(),r}function cS(n){const t=n.options,e=t.fill;let r=q(e&&e.target,e);return r===void 0&&(r=!!t.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function uS(n){const{scale:t,index:e,line:r}=n,i=[],s=r.segments,o=r.points,a=fS(t,e);a.push(Cp({x:null,y:t.bottom},r));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)hS(i,o[u],a)}return new kn({points:i,options:{}})}function fS(n,t){const e=[],r=n.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const s=r[i];if(s.index===t)break;s.hidden||e.unshift(s.dataset)}return e}function hS(n,t,e){const r=[];for(let i=0;i<e.length;i++){const s=e[i],{first:o,last:a,point:l}=dS(s,t,"x");if(!(!l||o&&a)){if(o)r.unshift(l);else if(n.push(l),!a)break}}n.push(...r)}function dS(n,t,e){const r=n.interpolate(t,e);if(!r)return{};const i=r[e],s=n.segments,o=n.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],f=o[u.start][e],h=o[u.end][e];if(Qn(i,f,h)){a=i===f,l=i===h;break}}return{first:a,last:l,point:r}}class Tp{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,r){const{x:i,y:s,radius:o}=this;return e=e||{start:0,end:se},t.arc(i,s,o,e.end,e.start,!0),!r.bounds}interpolate(t){const{x:e,y:r,radius:i}=this,s=t.angle;return{x:e+Math.cos(s)*i,y:r+Math.sin(s)*i,angle:s}}}function pS(n){const{chart:t,fill:e,line:r}=n;if(Dt(e))return mS(t,e);if(e==="stack")return uS(n);if(e==="shape")return!0;const i=gS(n);return i instanceof Tp?i:Cp(i,r)}function mS(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function gS(n){return(n.scale||{}).getPointPositionForValue?bS(n):yS(n)}function yS(n){const{scale:t={},fill:e}=n,r=aS(e,t);if(Dt(r)){const i=t.isHorizontal();return{x:i?r:null,y:i?null:r}}return null}function bS(n){const{scale:t,fill:e}=n,r=t.options,i=t.getLabels().length,s=r.reverse?t.max:t.min,o=lS(e,t,s),a=[];if(r.grid.circular){const l=t.getPointPositionForValue(0,s);return new Tp({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<i;++l)a.push(t.getPointPositionForValue(l,o));return a}function wa(n,t,e){const r=pS(t),{chart:i,index:s,line:o,scale:a,axis:l}=t,c=o.options,u=c.fill,f=c.backgroundColor,{above:h=f,below:d=f}=u||{},p=i.getDatasetMeta(s),m=fp(i,p);r&&o.points.length&&(To(n,e),xS(n,{line:o,target:r,above:h,below:d,area:e,scale:a,axis:l,clip:m}),Oo(n))}function xS(n,t){const{line:e,target:r,above:i,below:s,area:o,scale:a,clip:l}=t,c=e._loop?"angle":t.axis;n.save();let u=s;s!==i&&(c==="x"?(xf(n,r,o.top),Ma(n,{line:e,target:r,color:i,scale:a,property:c,clip:l}),n.restore(),n.save(),xf(n,r,o.bottom)):c==="y"&&(vf(n,r,o.left),Ma(n,{line:e,target:r,color:s,scale:a,property:c,clip:l}),n.restore(),n.save(),vf(n,r,o.right),u=i)),Ma(n,{line:e,target:r,color:u,scale:a,property:c,clip:l}),n.restore()}function xf(n,t,e){const{segments:r,points:i}=t;let s=!0,o=!1;n.beginPath();for(const a of r){const{start:l,end:c}=a,u=i[l],f=i[Ao(l,c,i)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(u.x,e),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(f.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function vf(n,t,e){const{segments:r,points:i}=t;let s=!0,o=!1;n.beginPath();for(const a of r){const{start:l,end:c}=a,u=i[l],f=i[Ao(l,c,i)];s?(n.moveTo(u.x,u.y),s=!1):(n.lineTo(e,u.y),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,f.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function Ma(n,t){const{line:e,target:r,property:i,color:s,scale:o,clip:a}=t,l=nS(e,r,i);for(const{source:c,target:u,start:f,end:h}of l){const{style:{backgroundColor:d=s}={}}=c,p=r!==!0;n.save(),n.fillStyle=d,vS(n,o,a,p&&fl(i,f,h)),n.beginPath();const m=!!e.pathSegment(n,c);let g;if(p){m?n.closePath():kf(n,r,h,i);const y=!!r.pathSegment(n,u,{move:m,reverse:!0});g=m&&y,g||kf(n,r,f,i)}n.closePath(),n.fill(g?"evenodd":"nonzero"),n.restore()}}function vS(n,t,e,r){const i=t.chart.chartArea,{property:s,start:o,end:a}=r||{};if(s==="x"||s==="y"){let l,c,u,f;s==="x"?(l=o,c=i.top,u=a,f=i.bottom):(l=i.left,c=o,u=i.right,f=a),n.beginPath(),e&&(l=Math.max(l,e.left),u=Math.min(u,e.right),c=Math.max(c,e.top),f=Math.min(f,e.bottom)),n.rect(l,c,u-l,f-c),n.clip()}}function kf(n,t,e,r){const i=t.interpolate(e,r);i&&n.lineTo(i.x,i.y)}var $E={id:"filler",afterDatasetsUpdate(n,t,e){const r=(n.data.datasets||[]).length,i=[];let s,o,a,l;for(o=0;o<r;++o)s=n.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof kn&&(l={visible:n.isDatasetVisible(o),index:o,fill:sS(a,o,r),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,i.push(l);for(o=0;o<r;++o)l=i[o],!(!l||l.fill===!1)&&(l.fill=iS(i,o,e.propagate))},beforeDraw(n,t,e){const r=e.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),r&&a.fill&&wa(n.ctx,a,s))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const s=r[i].$filler;bf(s)&&wa(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,t,e){const r=t.meta.$filler;!bf(r)||e.drawTime!=="beforeDatasetDraw"||wa(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Sf=(n,t)=>{let{boxHeight:e=t,boxWidth:r=t}=n;return n.usePointStyle&&(e=Math.min(e,t),r=n.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:e,itemHeight:Math.max(t,e)}},kS=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class wf extends Ne{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,r){this.maxWidth=t,this.maxHeight=e,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=nt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(r=>t.filter(r,this.chart.data))),t.sort&&(e=e.sort((r,i)=>t.sort(r,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const r=t.labels,i=At(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Sf(r,s);let c,u;e.font=i.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,r,i){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+a;let f=t;s.textAlign="left",s.textBaseline="middle";let h=-1,d=-u;return this.legendItems.forEach((p,m)=>{const g=r+e/2+s.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>o)&&(f+=u,c[c.length-(m>0?0:1)]=0,d+=u,h++),l[m]={left:0,top:d,row:h,width:g,height:i},c[c.length-1]+=g+a}),f}_fitCols(t,e,r,i){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-t;let f=a,h=0,d=0,p=0,m=0;return this.legendItems.forEach((g,y)=>{const{itemWidth:b,itemHeight:v}=SS(r,e,s,g,i);y>0&&d+v+2*a>u&&(f+=h+a,c.push({width:h,height:d}),p+=h+a,m++,h=d=0),l[y]={left:p,top:d,col:m,width:b,height:v},h=Math.max(h,b),d+=v+a}),f+=h,c.push({width:h,height:d}),f}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:r,labels:{padding:i},rtl:s}}=this,o=er(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=_t(r,this.left+i,this.right-this.lineWidths[a]);for(const c of e)a!==c.row&&(a=c.row,l=_t(r,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+t+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=_t(r,this.top+t+i,this.bottom-this.columnSizes[a].height);for(const c of e)c.col!==a&&(a=c.col,l=_t(r,this.top+t+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;To(t,this),this._draw(),Oo(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:r,ctx:i}=this,{align:s,labels:o}=t,a=ut.color,l=er(t.rtl,this.left,this.width),c=At(o.font),{padding:u}=o,f=c.size,h=f/2;let d;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=Sf(o,f),y=function(w,S,M){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;i.save();const E=q(M.lineWidth,1);if(i.fillStyle=q(M.fillStyle,a),i.lineCap=q(M.lineCap,"butt"),i.lineDashOffset=q(M.lineDashOffset,0),i.lineJoin=q(M.lineJoin,"miter"),i.lineWidth=E,i.strokeStyle=q(M.strokeStyle,a),i.setLineDash(q(M.lineDash,[])),o.usePointStyle){const I={radius:m*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:E},A=l.xPlus(w,p/2),z=S+h;Zd(i,I,A,z,o.pointStyleWidth&&p)}else{const I=S+Math.max((f-m)/2,0),A=l.leftForLtr(w,p),z=Jr(M.borderRadius);i.beginPath(),Object.values(z).some(K=>K!==0)?al(i,{x:A,y:I,w:p,h:m,radius:z}):i.rect(A,I,p,m),i.fill(),E!==0&&i.stroke()}i.restore()},b=function(w,S,M){di(i,M.text,w,S+g/2,c,{strikethrough:M.hidden,textAlign:l.textAlign(M.textAlign)})},v=this.isHorizontal(),k=this._computeTitleHeight();v?d={x:_t(s,this.left+u,this.right-r[0]),y:this.top+u+k,line:0}:d={x:this.left+u,y:_t(s,this.top+k+u,this.bottom-e[0].height),line:0},op(this.ctx,t.textDirection);const x=g+u;this.legendItems.forEach((w,S)=>{i.strokeStyle=w.fontColor,i.fillStyle=w.fontColor;const M=i.measureText(w.text).width,E=l.textAlign(w.textAlign||(w.textAlign=o.textAlign)),I=p+h+M;let A=d.x,z=d.y;l.setWidth(this.width),v?S>0&&A+I+u>this.right&&(z=d.y+=x,d.line++,A=d.x=_t(s,this.left+u,this.right-r[d.line])):S>0&&z+x>this.bottom&&(A=d.x=A+e[d.line].width+u,d.line++,z=d.y=_t(s,this.top+k+u,this.bottom-e[d.line].height));const K=l.x(A);if(y(K,z,w),A=vv(E,A+p+h,v?A+I:this.right,t.rtl),b(l.x(A),z,w),v)d.x+=I+u;else if(typeof w.text!="string"){const D=c.lineHeight;d.y+=Op(w,D)+u}else d.y+=x}),ap(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,r=At(e.font),i=ee(e.padding);if(!e.display)return;const s=er(t.rtl,this.left,this.width),o=this.ctx,a=e.position,l=r.size/2,c=i.top+l;let u,f=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,f=_t(t.align,f,this.right-h);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+_t(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const d=_t(a,f,f+h);o.textAlign=s.textAlign(tc(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=r.string,di(o,e.text,d,u,r)}_computeTitleHeight(){const t=this.options.title,e=At(t.font),r=ee(t.padding);return t.display?e.lineHeight+r.height:0}_getLegendItemAt(t,e){let r,i,s;if(Qn(t,this.left,this.right)&&Qn(e,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],Qn(t,i.left,i.left+i.width)&&Qn(e,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(t){const e=this.options;if(!CS(t.type,e))return;const r=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,s=kS(i,r);i&&!s&&nt(e.onLeave,[t,i,this],this),this._hoveredItem=r,r&&!s&&nt(e.onHover,[t,r,this],this)}else r&&nt(e.onClick,[t,r,this],this)}}function SS(n,t,e,r,i){const s=wS(r,n,t,e),o=MS(i,r,t.lineHeight);return{itemWidth:s,itemHeight:o}}function wS(n,t,e,r){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),t+e.size/2+r.measureText(i).width}function MS(n,t,e){let r=n;return typeof t.text!="string"&&(r=Op(t,e)),r}function Op(n,t){const e=n.text?n.text.length:0;return t*e}function CS(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var zE={id:"legend",_element:wf,start(n,t,e){const r=n.legend=new wf({ctx:n.ctx,options:e,chart:n});Qt.configure(n,r,e),Qt.addBox(n,r)},stop(n){Qt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const r=n.legend;Qt.configure(n,r,e),r.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const r=t.datasetIndex,i=e.chart;i.isDatasetVisible(r)?(i.hide(r),t.hidden=!0):(i.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),u=ee(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class _p extends Ne{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=gt(r.text)?r.text.length:1;this._padding=ee(r.padding);const s=i*At(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:r,bottom:i,right:s,options:o}=this,a=o.align;let l=0,c,u,f;return this.isHorizontal()?(u=_t(a,r,s),f=e+t,c=s-r):(o.position==="left"?(u=r+t,f=_t(a,i,e),l=kt*-.5):(u=s-t,f=_t(a,e,i),l=kt*.5),c=i-e),{titleX:u,titleY:f,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const r=At(e.font),s=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);di(t,e.text,0,0,r,{color:e.color,maxWidth:l,rotation:c,textAlign:tc(e.align),textBaseline:"middle",translation:[o,a]})}}function TS(n,t){const e=new _p({ctx:n.ctx,options:t,chart:n});Qt.configure(n,e,t),Qt.addBox(n,e),n.titleBlock=e}var FE={id:"title",_element:_p,start(n,t,e){TS(n,e)},stop(n){const t=n.titleBlock;Qt.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const r=n.titleBlock;Qt.configure(n,r,e),r.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ir={average(n){if(!n.length)return!1;let t,e,r=new Set,i=0,s=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),i+=l.y,++s}}return s===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:i/s}},nearest(n,t){if(!n.length)return!1;let e=t.x,r=t.y,i=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){const l=n[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=il(t,c);u<i&&(i=u,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,r=l.y}return{x:e,y:r}}};function ce(n,t){return t&&(gt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Me(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function OS(n,t){const{element:e,datasetIndex:r,index:i}=t,s=n.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(i);return{chart:n,label:o,parsed:s.getParsed(i),raw:n.data.datasets[r].data[i],formattedValue:a,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:e}}function Mf(n,t){const e=n.chart.ctx,{body:r,footer:i,title:s}=n,{boxWidth:o,boxHeight:a}=t,l=At(t.bodyFont),c=At(t.titleFont),u=At(t.footerFont),f=s.length,h=i.length,d=r.length,p=ee(t.padding);let m=p.height,g=0,y=r.reduce((k,x)=>k+x.before.length+x.lines.length+x.after.length,0);if(y+=n.beforeBody.length+n.afterBody.length,f&&(m+=f*c.lineHeight+(f-1)*t.titleSpacing+t.titleMarginBottom),y){const k=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=d*k+(y-d)*l.lineHeight+(y-1)*t.bodySpacing}h&&(m+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let b=0;const v=function(k){g=Math.max(g,e.measureText(k).width+b)};return e.save(),e.font=c.string,X(n.title,v),e.font=l.string,X(n.beforeBody.concat(n.afterBody),v),b=t.displayColors?o+2+t.boxPadding:0,X(r,k=>{X(k.before,v),X(k.lines,v),X(k.after,v)}),b=0,e.font=u.string,X(n.footer,v),e.restore(),g+=p.width,{width:g,height:m}}function _S(n,t){const{y:e,height:r}=t;return e<r/2?"top":e>n.height-r/2?"bottom":"center"}function ES(n,t,e,r){const{x:i,width:s}=r,o=e.caretSize+e.caretPadding;if(n==="left"&&i+s+o>t.width||n==="right"&&i-s-o<0)return!0}function AS(n,t,e,r){const{x:i,width:s}=e,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return r==="center"?c=i<=(a+l)/2?"left":"right":i<=s/2?c="left":i>=o-s/2&&(c="right"),ES(c,n,t,e)&&(c="center"),c}function Cf(n,t,e){const r=e.yAlign||t.yAlign||_S(n,e);return{xAlign:e.xAlign||t.xAlign||AS(n,t,e,r),yAlign:r}}function DS(n,t){let{x:e,width:r}=n;return t==="right"?e-=r:t==="center"&&(e-=r/2),e}function PS(n,t,e){let{y:r,height:i}=n;return t==="top"?r+=e:t==="bottom"?r-=i+e:r-=i/2,r}function Tf(n,t,e,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:l}=e,c=i+s,{topLeft:u,topRight:f,bottomLeft:h,bottomRight:d}=Jr(o);let p=DS(t,a);const m=PS(t,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+i:a==="right"&&(p+=Math.max(f,d)+i),{x:Xt(p,0,r.width-t.width),y:Xt(m,0,r.height-t.height)}}function Ji(n,t,e){const r=ee(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-r.right:n.x+r.left}function Of(n){return ce([],Me(n))}function NS(n,t,e){return Fn(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function _f(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const Ep={beforeTitle:xe,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,r=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return e[t.dataIndex]}return""},afterTitle:xe,beforeBody:xe,beforeLabel:xe,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return tt(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:xe,afterBody:xe,beforeFooter:xe,footer:xe,afterFooter:xe};function zt(n,t,e,r){const i=n[t].call(e,r);return typeof i>"u"?Ep[t].call(e,r):i}class hl extends Ne{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&e.options.animation&&r.animations,s=new hp(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=NS(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:r}=e,i=zt(r,"beforeTitle",this,t),s=zt(r,"title",this,t),o=zt(r,"afterTitle",this,t);let a=[];return a=ce(a,Me(i)),a=ce(a,Me(s)),a=ce(a,Me(o)),a}getBeforeBody(t,e){return Of(zt(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:r}=e,i=[];return X(t,s=>{const o={before:[],lines:[],after:[]},a=_f(r,s);ce(o.before,Me(zt(a,"beforeLabel",this,s))),ce(o.lines,zt(a,"label",this,s)),ce(o.after,Me(zt(a,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(t,e){return Of(zt(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:r}=e,i=zt(r,"beforeFooter",this,t),s=zt(r,"footer",this,t),o=zt(r,"afterFooter",this,t);let a=[];return a=ce(a,Me(i)),a=ce(a,Me(s)),a=ce(a,Me(o)),a}_createItems(t){const e=this._active,r=this.chart.data,i=[],s=[],o=[];let a=[],l,c;for(l=0,c=e.length;l<c;++l)a.push(OS(this.chart,e[l]));return t.filter&&(a=a.filter((u,f,h)=>t.filter(u,f,h,r))),t.itemSort&&(a=a.sort((u,f)=>t.itemSort(u,f,r))),X(a,u=>{const f=_f(t.callbacks,u);i.push(zt(f,"labelColor",this,u)),s.push(zt(f,"labelPointStyle",this,u)),o.push(zt(f,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const a=Ir[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=Mf(this,r),c=Object.assign({},a,l),u=Cf(this.chart,r,c),f=Tf(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,r,i){const s=this.getCaretPosition(t,r,i);e.lineTo(s.x1,s.y1),e.lineTo(s.x2,s.y2),e.lineTo(s.x3,s.y3)}getCaretPosition(t,e,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:f}=Jr(a),{x:h,y:d}=t,{width:p,height:m}=e;let g,y,b,v,k,x;return s==="center"?(k=d+m/2,i==="left"?(g=h,y=g-o,v=k+o,x=k-o):(g=h+p,y=g+o,v=k-o,x=k+o),b=g):(i==="left"?y=h+Math.max(l,u)+o:i==="right"?y=h+p-Math.max(c,f)-o:y=this.caretX,s==="top"?(v=d,k=v-o,g=y-o,b=y+o):(v=d+m,k=v+o,g=y+o,b=y-o),x=v),{x1:g,x2:y,x3:b,y1:v,y2:k,y3:x}}drawTitle(t,e,r){const i=this.title,s=i.length;let o,a,l;if(s){const c=er(r.rtl,this.x,this.width);for(t.x=Ji(this,r.titleAlign,r),e.textAlign=c.textAlign(r.titleAlign),e.textBaseline="middle",o=At(r.titleFont),a=r.titleSpacing,e.fillStyle=r.titleColor,e.font=o.string,l=0;l<s;++l)e.fillText(i[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===s&&(t.y+=r.titleMarginBottom-a)}}_drawColorBox(t,e,r,i,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=s,u=At(s.bodyFont),f=Ji(this,"left",s),h=i.x(f),d=l<u.lineHeight?(u.lineHeight-l)/2:0,p=e.y+d;if(s.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=i.leftForLtr(h,c)+c/2,y=p+l/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,ol(t,m,g,y),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,ol(t,m,g,y)}else{t.lineWidth=J(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const m=i.leftForLtr(h,c),g=i.leftForLtr(i.xPlus(h,1),c-2),y=Jr(o.borderRadius);Object.values(y).some(b=>b!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,al(t,{x:m,y:p,w:c,h:l,radius:y}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),al(t,{x:g,y:p+1,w:c-2,h:l-2,radius:y}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(m,p,c,l),t.strokeRect(m,p,c,l),t.fillStyle=o.backgroundColor,t.fillRect(g,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,e,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,f=At(r.bodyFont);let h=f.lineHeight,d=0;const p=er(r.rtl,this.x,this.width),m=function(M){e.fillText(M,p.x(t.x+d),t.y+h/2),t.y+=h+s},g=p.textAlign(o);let y,b,v,k,x,w,S;for(e.textAlign=o,e.textBaseline="middle",e.font=f.string,t.x=Ji(this,g,r),e.fillStyle=r.bodyColor,X(this.beforeBody,m),d=a&&g!=="right"?o==="center"?c/2+u:c+2+u:0,k=0,w=i.length;k<w;++k){for(y=i[k],b=this.labelTextColors[k],e.fillStyle=b,X(y.before,m),v=y.lines,a&&v.length&&(this._drawColorBox(e,t,k,p,r),h=Math.max(f.lineHeight,l)),x=0,S=v.length;x<S;++x)m(v[x]),h=f.lineHeight;X(y.after,m)}d=0,h=f.lineHeight,X(this.afterBody,m),t.y-=s}drawFooter(t,e,r){const i=this.footer,s=i.length;let o,a;if(s){const l=er(r.rtl,this.x,this.width);for(t.x=Ji(this,r.footerAlign,r),t.y+=r.footerMarginTop,e.textAlign=l.textAlign(r.footerAlign),e.textBaseline="middle",o=At(r.footerFont),e.fillStyle=r.footerColor,e.font=o.string,a=0;a<s;++a)e.fillText(i[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+r.footerSpacing}}drawBackground(t,e,r,i){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=t,{width:c,height:u}=r,{topLeft:f,topRight:h,bottomLeft:d,bottomRight:p}=Jr(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+f,l),o==="top"&&this.drawCaret(t,e,r,i),e.lineTo(a+c-h,l),e.quadraticCurveTo(a+c,l,a+c,l+h),o==="center"&&s==="right"&&this.drawCaret(t,e,r,i),e.lineTo(a+c,l+u-p),e.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(t,e,r,i),e.lineTo(a+d,l+u),e.quadraticCurveTo(a,l+u,a,l+u-d),o==="center"&&s==="left"&&this.drawCaret(t,e,r,i),e.lineTo(a,l+f),e.quadraticCurveTo(a,l,a+f,l),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=Ir[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Mf(this,t),l=Object.assign({},o,this._size),c=Cf(e,t,l),u=Tf(t,l,c,e);(i._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=ee(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=r,this.drawBackground(s,t,i,e),op(t,e.textDirection),s.y+=o.top,this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),ap(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const r=this._active,i=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!Ms(r,i),o=this._positionChanged(i,e);(s||o)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,r=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(t,s,e,r),a=this._positionChanged(o,t),l=e||!Ms(o,s)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,r,i){const s=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:r,caretY:i,options:s}=this,o=Ir[s.position].call(this,t,e);return o!==!1&&(r!==o.x||i!==o.y)}}V(hl,"positioners",Ir);var HE={id:"tooltip",_element:hl,positioners:Ir,afterInit(n,t,e){e&&(n.tooltip=new hl({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Ep},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const IS=(n,t,e,r)=>(typeof t=="string"?(e=n.push(t)-1,r.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function RS(n,t,e,r){const i=n.indexOf(t);if(i===-1)return IS(n,t,e,r);const s=n.lastIndexOf(t);return i!==s?e:i}const LS=(n,t)=>n===null?null:Xt(Math.round(n),0,t);function Ef(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class Af extends xr{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const r=this.getLabels();for(const{index:i,label:s}of e)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(tt(t))return null;const r=this.getLabels();return e=isFinite(e)&&r[e]===t?e:RS(r,t,q(e,t),this._addedLabels),LS(e,r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),e||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const t=this.min,e=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=t===0&&e===s.length-1?s:s.slice(t,e+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=t;o<=e;o++)i.push({value:o});return i}getLabelForValue(t){return Ef.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}V(Af,"id","category"),V(Af,"defaults",{ticks:{callback:Ef}});function BS(n,t){const e=[],{bounds:i,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:f,includeBounds:h}=n,d=s||1,p=u-1,{min:m,max:g}=t,y=!tt(o),b=!tt(a),v=!tt(c),k=(g-m)/(f+1);let x=_u((g-m)/p/d)*d,w,S,M,E;if(x<1e-14&&!y&&!b)return[{value:m},{value:g}];E=Math.ceil(g/x)-Math.floor(m/x),E>p&&(x=_u(E*x/p/d)*d),tt(l)||(w=Math.pow(10,l),x=Math.ceil(x*w)/w),i==="ticks"?(S=Math.floor(m/x)*x,M=Math.ceil(g/x)*x):(S=m,M=g),y&&b&&s&&cv((a-o)/s,x/1e3)?(E=Math.round(Math.min((a-o)/x,u)),x=(a-o)/E,S=o,M=a):v?(S=y?o:S,M=b?a:M,E=c-1,x=(M-S)/E):(E=(M-S)/x,Ur(E,Math.round(E),x/1e3)?E=Math.round(E):E=Math.ceil(E));const I=Math.max(Eu(x),Eu(S));w=Math.pow(10,tt(l)?I:l),S=Math.round(S*w)/w,M=Math.round(M*w)/w;let A=0;for(y&&(h&&S!==o?(e.push({value:o}),S<o&&A++,Ur(Math.round((S+A*x)*w)/w,o,Df(o,k,n))&&A++):S<o&&A++);A<E;++A){const z=Math.round((S+A*x)*w)/w;if(b&&z>a)break;e.push({value:z})}return b&&h&&M!==a?e.length&&Ur(e[e.length-1].value,a,Df(a,k,n))?e[e.length-1].value=a:e.push({value:a}):(!b||M===a)&&e.push({value:M}),e}function Df(n,t,{horizontal:e,minRotation:r}){const i=xn(r),s=(e?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+n).length;return Math.min(t/s,o)}class $S extends xr{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return tt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=l=>i=e?i:l,a=l=>s=r?s:l;if(t){const l=ar(i),c=ar(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);a(s+l),t||o(i-l)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:r}=t,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},s=this._range||this,o=BS(i,s);return t.bounds==="ticks"&&uv(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const i=(r-e)/Math.max(t.length-1,1)/2;e-=i,r+=i}this._startValue=e,this._endValue=r,this._valueRange=r-e}getLabelForValue(t){return Xd(t,this.chart.options.locale,this.options.ticks.format)}}class Pf extends $S{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Dt(t)?t:0,this.max=Dt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,r=xn(this.options.ticks.minRotation),i=(t?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}V(Pf,"id","linear"),V(Pf,"defaults",{ticks:{callback:Qd.formatters.numeric}});const Do={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ht=Object.keys(Do);function Nf(n,t){return n-t}function If(n,t){if(tt(t))return null;const e=n._adapter,{parser:r,round:i,isoWeekday:s}=n._parseOpts;let o=t;return typeof r=="function"&&(o=r(o)),Dt(o)||(o=typeof r=="string"?e.parse(o,r):e.parse(o)),o===null?null:(i&&(o=i==="week"&&(fi(s)||s===!0)?e.startOf(o,"isoWeek",s):e.startOf(o,i)),+o)}function Rf(n,t,e,r){const i=Ht.length;for(let s=Ht.indexOf(n);s<i-1;++s){const o=Do[Ht[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=r)return Ht[s]}return Ht[i-1]}function zS(n,t,e,r,i){for(let s=Ht.length-1;s>=Ht.indexOf(e);s--){const o=Ht[s];if(Do[o].common&&n._adapter.diff(i,r,o)>=t-1)return o}return Ht[e?Ht.indexOf(e):0]}function FS(n){for(let t=Ht.indexOf(n)+1,e=Ht.length;t<e;++t)if(Do[Ht[t]].common)return Ht[t]}function Lf(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:r,hi:i}=Zl(e,t),s=e[r]>=t?e[r]:e[i];n[s]=!0}}function HS(n,t,e,r){const i=n._adapter,s=+i.startOf(t[0].value,r),o=t[t.length-1].value;let a,l;for(a=s;a<=o;a=+i.add(a,1,r))l=e[a],l>=0&&(t[l].major=!0);return t}function Bf(n,t,e){const r=[],i={},s=t.length;let o,a;for(o=0;o<s;++o)a=t[o],i[a]=o,r.push({value:a,major:!1});return s===0||!e?r:HS(n,r,i,e)}class Ds extends xr{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const r=t.time||(t.time={}),i=this._adapter=new $k._date(t.adapters.date);i.init(e),jr(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:If(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,r=t.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=Dt(i)&&!isNaN(i)?i:+e.startOf(Date.now(),r),s=Dt(s)&&!isNaN(s)?s:+e.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],r=t[t.length-1]),{min:e,max:r}}buildTicks(){const t=this.options,e=t.time,r=t.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,a=gv(i,s,o);return this._unit=e.unit||(r.autoSkip?Rf(e.minUnit,this.min,this.max,this._getLabelCapacity(s)):zS(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:FS(this._unit),this.initOffsets(i),t.reverse&&a.reverse(),Bf(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,r=0,i,s;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?r=s:r=(s-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=Xt(e,0,o),r=Xt(r,0,o),this._offsets={start:e,end:r,factor:1/(e+1+r)}}_generate(){const t=this._adapter,e=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||Rf(s.minUnit,e,r,this._getLabelCapacity(e)),a=q(i.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=fi(l)||l===!0,u={};let f=e,h,d;if(c&&(f=+t.startOf(f,"isoWeek",l)),f=+t.startOf(f,c?"day":o),t.diff(r,e,o)>1e5*a)throw new Error(e+" and "+r+" are too far apart with stepSize of "+a+" "+o);const p=i.ticks.source==="data"&&this.getDataTimestamps();for(h=f,d=0;h<r;h=+t.add(h,a,o),d++)Lf(u,h,p);return(h===r||i.bounds==="ticks"||d===1)&&Lf(u,h,p),Object.keys(u).sort(Nf).map(m=>+m)}getLabelForValue(t){const e=this._adapter,r=this.options.time;return r.tooltipFormat?e.format(t,r.tooltipFormat):e.format(t,r.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,s=this._unit,o=e||i[s];return this._adapter.format(t,o)}_tickFormatFunction(t,e,r,i){const s=this.options,o=s.ticks.callback;if(o)return nt(o,[t,e,r],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],f=c&&a[c],h=r[e],d=c&&f&&h&&h.major;return this._adapter.format(t,i||(d?f:u))}generateTickLabels(t){let e,r,i;for(e=0,r=t.length;e<r;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+r)*e.factor)}getValueForPixel(t){const e=this._offsets,r=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,r=this.ctx.measureText(t).width,i=xn(this.isHorizontal()?e.maxRotation:e.minRotation),s=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(t){const e=this.options.time,r=e.displayFormats,i=r[e.unit]||r.millisecond,s=this._tickFormatFunction(t,0,Bf(this,[t],this._majorUnit),i),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,r;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,r=i.length;e<r;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,r;if(t.length)return t;const i=this.getLabels();for(e=0,r=i.length;e<r;++e)t.push(If(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return bv(t.sort(Nf))}}V(Ds,"id","time"),V(Ds,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Yi(n,t,e){let r=0,i=n.length-1,s,o,a,l;e?(t>=n[r].pos&&t<=n[i].pos&&({lo:r,hi:i}=vn(n,"pos",t)),{pos:s,time:a}=n[r],{pos:o,time:l}=n[i]):(t>=n[r].time&&t<=n[i].time&&({lo:r,hi:i}=vn(n,"time",t)),{time:s,pos:a}=n[r],{time:o,pos:l}=n[i]);const c=o-s;return c?a+(l-a)*(t-s)/c:a}class $f extends Ds{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Yi(e,this.min),this._tableRange=Yi(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:r}=this,i=[],s=[];let o,a,l,c,u;for(o=0,a=t.length;o<a;++o)c=t[o],c>=e&&c<=r&&i.push(c);if(i.length<2)return[{time:e,pos:0},{time:r,pos:1}];for(o=0,a=i.length;o<a;++o)u=i[o+1],l=i[o-1],c=i[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_generate(){const t=this.min,e=this.max;let r=super.getDataTimestamps();return(!r.includes(t)||!r.length)&&r.splice(0,0,t),(!r.includes(e)||r.length===1)&&r.push(e),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),r=this.getLabelTimestamps();return e.length&&r.length?t=this.normalize(e.concat(r)):t=e.length?e:r,t=this._cache.all=t,t}getDecimalForValue(t){return(Yi(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,r=this.getDecimalForPixel(t)/e.factor-e.end;return Yi(this._table,r*this._tableRange+this._minPos,!0)}}V($f,"id","timeseries"),V($f,"defaults",Ds.defaults);var Ap={exports:{}};(function(n,t){(function(e,r){n.exports=r()})(Pe,function(){return function(e,r,i){var s=r.prototype,o=function(f){return f&&(f.indexOf?f:f.s)},a=function(f,h,d,p,m){var g=f.name?f:f.$locale(),y=o(g[h]),b=o(g[d]),v=y||b.map(function(x){return x.slice(0,p)});if(!m)return v;var k=g.weekStart;return v.map(function(x,w){return v[(w+(k||0))%7]})},l=function(){return i.Ls[i.locale()]},c=function(f,h){return f.formats[h]||function(d){return d.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(p,m,g){return m||g.slice(1)})}(f.formats[h.toUpperCase()])},u=function(){var f=this;return{months:function(h){return h?h.format("MMMM"):a(f,"months")},monthsShort:function(h){return h?h.format("MMM"):a(f,"monthsShort","months",3)},firstDayOfWeek:function(){return f.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):a(f,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):a(f,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):a(f,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return c(f.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return u.bind(this)()},i.localeData=function(){var f=l();return{firstDayOfWeek:function(){return f.weekStart||0},weekdays:function(){return i.weekdays()},weekdaysShort:function(){return i.weekdaysShort()},weekdaysMin:function(){return i.weekdaysMin()},months:function(){return i.months()},monthsShort:function(){return i.monthsShort()},longDateFormat:function(h){return c(f,h)},meridiem:f.meridiem,ordinal:f.ordinal}},i.months=function(){return a(l(),"months")},i.monthsShort=function(){return a(l(),"monthsShort","months",3)},i.weekdays=function(f){return a(l(),"weekdays",null,null,f)},i.weekdaysShort=function(f){return a(l(),"weekdaysShort","weekdays",3,f)},i.weekdaysMin=function(f){return a(l(),"weekdaysMin","weekdays",2,f)}}})})(Ap);var VS=Ap.exports;const VE=yr(VS);function Mt(n){this.content=n}Mt.prototype={constructor:Mt,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(e||n,t):(s[i+1]=t,e&&(s[i]=e)),new Mt(s)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new Mt(e)},addToStart:function(n,t){return new Mt([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new Mt(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,t,e),new Mt(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=Mt.from(n),n.size?new Mt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Mt.from(n),n.size?new Mt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=Mt.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}};Mt.from=function(n){if(n instanceof Mt)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new Mt(t)};function Dp(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),s=t.child(r);if(i==s){e+=i.nodeSize;continue}if(!i.sameMarkup(s))return e;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)e++;return e}if(i.content.size||s.content.size){let o=Dp(i.content,s.content,e+1);if(o!=null)return o}e+=i.nodeSize}}function Pp(n,t,e,r){for(let i=n.childCount,s=t.childCount;;){if(i==0||s==0)return i==s?null:{a:e,b:r};let o=n.child(--i),a=t.child(--s),l=o.nodeSize;if(o==a){e-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:e,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,e--,r--;return{a:e,b:r}}if(o.content.size||a.content.size){let c=Pp(o.content,a.content,e-1,r-1);if(c)return c}e-=l,r-=l}}class O{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,s){for(let o=0,a=0;a<e;o++){let l=this.content[o],c=a+l.nodeSize;if(c>t&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,t-u),Math.min(l.content.size,e-u),r,i+u)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let s="",o=!0;return this.nodesBetween(t,e,(a,l)=>{let c=a.isText?a.text.slice(Math.max(t,l)-l,e-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:s+=r),s+=c},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),s=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),s=1);s<t.content.length;s++)i.push(t.content[s]);return new O(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let s=0,o=0;o<e;s++){let a=this.content[s],l=o+a.nodeSize;l>t&&((o<t||l>e)&&(a.isText?a=a.cut(Math.max(0,t-o),Math.min(a.text.length,e-o)):a=a.cut(Math.max(0,t-o-1),Math.min(a.content.size,e-o-1))),r.push(a),i+=a.nodeSize),o=l}return new O(r,i)}cutByIndex(t,e){return t==e?O.empty:t==0&&e==this.content.length?this:new O(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),s=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new O(i,s)}addToStart(t){return new O([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new O(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return Dp(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return Pp(this,t,e,r)}findIndex(t){if(t==0)return Gi(0,t);if(t==this.size)return Gi(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let e=0,r=0;;e++){let i=this.child(e),s=r+i.nodeSize;if(s>=t)return s==t?Gi(e+1,s):Gi(e,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return O.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new O(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return O.empty;let e,r=0;for(let i=0;i<t.length;i++){let s=t[i];r+=s.nodeSize,i&&s.isText&&t[i-1].sameMarkup(s)?(e||(e=t.slice(0,i)),e[e.length-1]=s.withText(e[e.length-1].text+s.text)):e&&e.push(s)}return new O(e||t,r)}static from(t){if(!t)return O.empty;if(t instanceof O)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new O([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}O.empty=new O([],0);const Ca={index:0,offset:0};function Gi(n,t){return Ca.index=n,Ca.offset=t,Ca}function Ps(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!Ps(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!Ps(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}let Z=class dl{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let s=t[i];if(this.eq(s))return t;if(this.type.excludes(s.type))e||(e=t.slice(0,i));else{if(s.type.excludes(this.type))return t;!r&&s.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(s)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&Ps(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);let i=r.create(e.attrs);return r.checkAttrs(i.attrs),i}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return dl.none;if(t instanceof dl)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}};Z.none=[];class Ns extends Error{}class R{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=Ip(this.content,t+this.openStart,e);return r&&new R(r,this.openStart,this.openEnd)}removeBetween(t,e){return new R(Np(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return R.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new R(O.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let s=t.firstChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=t.lastChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.lastChild)i++;return new R(t,r,i)}}R.empty=new R(O.empty,0,0);function Np(n,t,e){let{index:r,offset:i}=n.findIndex(t),s=n.maybeChild(r),{index:o,offset:a}=n.findIndex(e);if(i==t||s.isText){if(a!=e&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(Np(s.content,t-i-1,e-i-1)))}function Ip(n,t,e,r){let{index:i,offset:s}=n.findIndex(t),o=n.maybeChild(i);if(s==t||o.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let a=Ip(o.content,t-s-1,e,o);return a&&n.replaceChild(i,o.copy(a))}function WS(n,t,e){if(e.openStart>n.depth)throw new Ns("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new Ns("Inconsistent open depths");return Rp(n,t,e,0)}function Rp(n,t,e,r){let i=n.index(r),s=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let o=Rp(n,t,e,r+1);return s.copy(s.content.replaceChild(i,o))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let o=n.parent,a=o.content;return En(o,a.cut(0,n.parentOffset).append(e.content).append(a.cut(t.parentOffset)))}else{let{start:o,end:a}=jS(e,n);return En(s,Bp(n,o,a,t,r))}else return En(s,Is(n,t,r))}function Lp(n,t){if(!t.type.compatibleContent(n.type))throw new Ns("Cannot join "+t.type.name+" onto "+n.type.name)}function pl(n,t,e){let r=n.node(e);return Lp(r,t.node(e)),r}function _n(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function Gr(n,t,e,r){let i=(t||n).node(e),s=0,o=t?t.index(e):i.childCount;n&&(s=n.index(e),n.depth>e?s++:n.textOffset&&(_n(n.nodeAfter,r),s++));for(let a=s;a<o;a++)_n(i.child(a),r);t&&t.depth==e&&t.textOffset&&_n(t.nodeBefore,r)}function En(n,t){return n.type.checkContent(t),n.copy(t)}function Bp(n,t,e,r,i){let s=n.depth>i&&pl(n,t,i+1),o=r.depth>i&&pl(e,r,i+1),a=[];return Gr(null,n,i,a),s&&o&&t.index(i)==e.index(i)?(Lp(s,o),_n(En(s,Bp(n,t,e,r,i+1)),a)):(s&&_n(En(s,Is(n,t,i+1)),a),Gr(t,e,i,a),o&&_n(En(o,Is(e,r,i+1)),a)),Gr(r,null,i,a),new O(a)}function Is(n,t,e){let r=[];if(Gr(null,n,e,r),n.depth>e){let i=pl(n,t,e+1);_n(En(i,Is(n,t,e+1)),r)}return Gr(t,null,e,r),new O(r)}function jS(n,t){let e=t.depth-n.openStart,i=t.node(e).copy(n.content);for(let s=e-1;s>=0;s--)i=t.node(s).copy(O.from(i));return{start:i.resolveNoCache(n.openStart+e),end:i.resolveNoCache(i.content.size-n.openEnd-e)}}class mi{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let s=0;s<t;s++)i+=r.child(s).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return Z.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new Rs(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,s=e;for(let o=t;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new mi(e,r,s)}static resolveCached(t,e){let r=zf.get(t);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==e)return o}else zf.set(t,r=new US);let i=r.elts[r.i]=mi.resolve(t,e);return r.i=(r.i+1)%KS,i}}class US{constructor(){this.elts=[],this.i=0}}const KS=12,zf=new WeakMap;class Rs{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const qS=Object.create(null);class oe{constructor(t,e,r,i=Z.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||O.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&Ps(this.attrs,e||t.defaultAttrs||qS)&&Z.sameSet(this.marks,r||Z.none)}copy(t=null){return t==this.content?this:new oe(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new oe(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return R.empty;let i=this.resolve(t),s=this.resolve(e),o=r?0:i.sharedDepth(e),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new R(c,i.depth-o,s.depth-o)}replace(t,e,r){return WS(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return mi.resolveCached(this,t)}resolveNoCache(t){return mi.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),$p(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=O.empty,i=0,s=r.childCount){let o=this.contentMatchAt(t).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(t).matchType(r),o=s&&s.matchFragment(this.content,e);return o?o.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=Z.none;for(let e=0;e<this.marks.length;e++){let r=this.marks[e];r.type.checkAttrs(r.attrs),t=r.addToSet(t)}if(!Z.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=O.fromJSON(t,e.content),s=t.nodeType(e.type).create(e.attrs,i,r);return s.type.checkAttrs(s.attrs),s}}oe.prototype.text=void 0;class Ls extends oe{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):$p(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new Ls(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new Ls(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function $p(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class In{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new JS(t,e);if(r.next==null)return In.empty;let i=zp(r);r.next&&r.err("Unexpected trailing text");let s=ew(tw(i));return nw(s,r),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let s=e;i&&s<r;s++)i=i.matchType(t.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function s(o,a){let l=o.matchFragment(t,r);if(l&&(!e||l.validEnd))return O.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:f}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let h=s(f,a.concat(u));if(h)return h}}return null}return s(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(t)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in e)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),e[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+t.indexOf(r.next[o].next);return s}).join(`
`)}}In.empty=new In(!0);class JS{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function zp(n){let t=[];do t.push(YS(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function YS(n){let t=[];do t.push(GS(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function GS(n){let t=ZS(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=XS(n,t);else break;return t}function Ff(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function XS(n,t){let e=Ff(n),r=e;return n.eat(",")&&(n.next!="}"?r=Ff(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function QS(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let s in e){let o=e[s];o.isInGroup(t)&&i.push(o)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function ZS(n){if(n.eat("(")){let t=zp(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=QS(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function tw(n){let t=[[]];return i(s(n,0),e()),t;function e(){return t.push([])-1}function r(o,a,l){let c={term:l,to:a};return t[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}function s(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=e())}else if(o.type=="star"){let l=e();return r(a,l),i(s(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=e();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(s(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=e();i(s(o.expr,l),u),l=u}if(o.max==-1)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=e();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Fp(n,t){return t-n}function Hf(n,t){let e=[];return r(t),e.sort(Fp);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);e.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&e.indexOf(l)==-1&&r(l)}}}function ew(n){let t=Object.create(null);return e(Hf(n,0));function e(r){let i=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Hf(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=t[r.join(",")]=new In(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(Fp);s.next.push({type:i[o][0],next:t[a.join(",")]||e(a)})}return s}}function nw(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Hp(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function Vp(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function Wp(n,t,e,r){for(let i in t)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${e} of type ${i}`);for(let i in n){let s=n[i];s.validate&&s.validate(t[i])}}function jp(n,t){let e=Object.create(null);if(t)for(let r in t)e[r]=new iw(n,r,t[r]);return e}let Vf=class Up{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=jp(t,r.attrs),this.defaultAttrs=Hp(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==In.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Vp(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new oe(this,this.computeAttrs(t),O.from(e),Z.setFrom(r))}createChecked(t=null,e,r){return e=O.from(e),this.checkContent(e),new oe(this,this.computeAttrs(t),e,Z.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=O.from(e),e.size){let o=this.contentMatch.fillBefore(e);if(!o)return null;e=o.append(e)}let i=this.contentMatch.matchFragment(e),s=i&&i.fillBefore(O.empty,!0);return s?new oe(this,t,e.append(s),Z.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Wp(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:Z.none:t}static compile(t,e){let r=Object.create(null);t.forEach((s,o)=>r[s]=new Up(s,e,o));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function rw(n,t,e){let r=e.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${n}, got ${s}`)}}class iw{constructor(t,e,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?rw(t,e,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Po{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=jp(t,i.attrs),this.excluded=null;let s=Hp(this.attrs);this.instance=s?new Z(this,s):null}create(t=null){return!t&&this.instance?this.instance:new Z(this,Vp(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((s,o)=>r[s]=new Po(s,i++,e,o)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){Wp(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class Kp{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=Mt.from(t.nodes),e.marks=Mt.from(t.marks||{}),this.nodes=Vf.compile(this.spec.nodes,this),this.marks=Po.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",a=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=In.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=a=="_"?null:a?Wf(this,a.split(" ")):a==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Wf(this,o.split(" "))}this.nodeFromJSON=i=>oe.fromJSON(this,i),this.markFromJSON=i=>Z.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Vf){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new Ls(r,r.defaultAttrs,t,Z.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function Wf(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],s=n.marks[i],o=s;if(s)e.push(s);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&e.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}function sw(n){return n.tag!=null}function ow(n){return n.style!=null}class Ge{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let r=this.matchedStyles=[];e.forEach(i=>{if(sw(i))this.tags.push(i);else if(ow(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=t.nodes[i.node];return s.contentMatch.matchType(s)})}parse(t,e={}){let r=new Uf(this,e,!1);return r.addAll(t,Z.none,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new Uf(this,e,!0);return r.addAll(t,Z.none,e.from,e.to),R.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(cw(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||e.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(t);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(t,e,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(t)!=0||o.context&&!r.matchesContext(o.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=e))){if(o.getAttrs){let l=o.getAttrs(e);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(t){let e=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<e.length;o++){let a=e[o];if((a.priority==null?50:a.priority)<s)break}e.splice(o,0,i)}for(let i in t.marks){let s=t.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Kf(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in t.nodes){let s=t.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Kf(o)),o.node||o.ignore||o.mark||(o.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Ge(t,Ge.schemaRules(t)))}}const qp={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},aw={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Jp={ol:!0,ul:!0},gi=1,ml=2,Xr=4;function jf(n,t,e){return t!=null?(t?gi:0)|(t==="full"?ml:0):n&&n.whitespace=="pre"?gi|ml:e&~Xr}class Xi{constructor(t,e,r,i,s,o){this.type=t,this.attrs=e,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=Z.none,this.match=s||(o&Xr?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(O.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&gi)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let e=O.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(O.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!qp.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class Uf{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=e.topNode,s,o=jf(null,e.preserveWhitespace,0)|(r?Xr:0);i?s=new Xi(i.type,i.attrs,Z.none,!0,e.topMatch||i.type.contentMatch,o):r?s=new Xi(null,null,Z.none,!0,null,o):s=new Xi(t.schema.topNodeType,null,Z.none,!0,null,o),this.nodes=[s],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let r=t.nodeValue,i=this.top,s=i.options&ml?"full":this.localPreserveWS||(i.options&gi)>0,{schema:o}=this.parser;if(s==="full"||i.inlineContext(t)||/[^ \t\r\n\u000c]/.test(r)){if(s)if(s==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(o.linebreakReplacement.create(),e,!0),a[l]&&this.insertNode(o.text(a[l]),e,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],l=t.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),e,!/\S/.test(r)),this.findInText(t)}else this.findInside(t)}addElement(t,e,r){let i=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let o=t.nodeName.toLowerCase(),a;Jp.hasOwnProperty(o)&&this.parser.normalizeLists&&lw(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(a=this.parser.matchTag(t,this,r));t:if(l?l.ignore:aw.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,e);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let c,u=this.needsBlock;if(qp.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let f=l&&l.skip?e:this.readStyles(t,e);f&&this.addAll(t,f),c&&this.sync(s),this.needsBlock=u}else{let c=this.readStyles(t,e);c&&this.addElementByRule(t,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let r=t.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(s,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?e=e.filter(c=>!l.clearMark(c)):e=e.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return e}addElementByRule(t,e,r,i){let s,o;if(e.node)if(o=this.parser.schema.nodes[e.node],o.isLeaf)this.insertNode(o.create(e.attrs),r,t.nodeName=="BR")||this.leafFallback(t,r);else{let l=this.enter(o,e.attrs||null,r,e.preserveWhitespace);l&&(s=!0,r=l)}else{let l=this.parser.schema.marks[e.mark];r=r.concat(l.create(e.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(i)this.addElement(t,r,i);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=t;typeof e.contentElement=="string"?l=t.querySelector(e.contentElement):typeof e.contentElement=="function"?l=e.contentElement(t):e.contentElement&&(l=e.contentElement),this.findAround(t,l,!0),this.addAll(l,r),this.findAround(t,l,!1)}s&&this.sync(a)&&this.open--}addAll(t,e,r,i){let s=r||0;for(let o=r?t.childNodes[r]:t.firstChild,a=i==null?null:t.childNodes[i];o!=a;o=o.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(o,e);this.findAtPoint(t,s)}findPlace(t,e,r){let i,s;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(t);if(c&&(!i||i.length>c.length+a)&&(i=c,s=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)e=this.enterInner(i[o],null,e,!1);return e}insertNode(t,e,r){if(t.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(e=this.enterInner(s,null,e))}let i=this.findPlace(t,e,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(t.type));let o=Z.none;for(let a of i.concat(t.marks))(s.type?s.type.allowsMarkType(a.type):qf(a.type,t.type))&&(o=a.addToSet(o));return s.content.push(t.mark(o)),!0}return!1}enter(t,e,r,i){let s=this.findPlace(t.create(e),r,!1);return s&&(s=this.enterInner(t,e,r,!0,i)),s}enterInner(t,e,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(t);let a=jf(t,s,o.options);o.options&Xr&&o.content.length==0&&(a|=Xr);let l=Z.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):qf(c.type,t))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Xi(t,e,l,i,null,a)),this.open++,r}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=gi)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=e[a];if(c==""){if(a==e.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}}function lw(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&Jp.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function cw(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function Kf(n){let t={};for(let e in n)t[e]=n[e];return t}function qf(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==t||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}class Hn{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=Ta(e).createDocumentFragment());let i=r,s=[];return t.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,e);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=ps(Ta(e),this.nodes[t.type.name](t),null,t.attrs);if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let s=this.serializeMark(t.marks[i],t.isInline,e);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&ps(Ta(r),i(t,e),null,t.attrs)}static renderSpec(t,e,r=null,i){return ps(t,e,r,i)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new Hn(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=Jf(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return Jf(t.marks)}}function Jf(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function Ta(n){return n.document||window.document}const Yf=new WeakMap;function uw(n){let t=Yf.get(n);return t===void 0&&Yf.set(n,t=fw(n)),t}function fw(n){let t=null;function e(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")t||(t=[]),t.push(r);else for(let i=0;i<r.length;i++)e(r[i]);else for(let i in r)e(r[i])}return e(n),t}function ps(n,t,e,r){if(typeof t=="string")return{dom:n.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=uw(r))&&s.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(e=i.slice(0,o),i=i.slice(o+1));let a,l=e?n.createElementNS(e,i):n.createElement(i),c=t[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let h=f.indexOf(" ");h>0?l.setAttributeNS(f.slice(0,h),f.slice(h+1),c[f]):f=="style"&&l.style?l.style.cssText=c[f]:l.setAttribute(f,c[f])}}for(let f=u;f<t.length;f++){let h=t[f];if(h===0){if(f<t.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:d,contentDOM:p}=ps(n,h,e,r);if(l.appendChild(d),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const Yp=65535,Gp=Math.pow(2,16);function hw(n,t){return n+t*Gp}function Gf(n){return n&Yp}function dw(n){return(n-(n&Yp))/Gp}const Xp=1,Qp=2,ms=4,Zp=8;class gl{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&Zp)>0}get deletedBefore(){return(this.delInfo&(Xp|ms))>0}get deletedAfter(){return(this.delInfo&(Qp|ms))>0}get deletedAcross(){return(this.delInfo&ms)>0}}class Wt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Wt.empty)return Wt.empty}recover(t){let e=0,r=Gf(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+dw(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>t)break;let c=this.ranges[a+s],u=this.ranges[a+o],f=l+c;if(t<=f){let h=c?t==l?-1:t==f?1:e:e,d=l+i+(h<0?0:u);if(r)return d;let p=t==(e<0?l:f)?null:hw(a/3,t-l),m=t==l?Qp:t==f?Xp:ms;return(e<0?t!=l:t!=f)&&(m|=Zp),new gl(d,m,p)}i+=u-c}return r?t+i:new gl(t+i,0,null)}touches(t,e){let r=0,i=Gf(e),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[a+s],u=l+c;if(t<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+e],u=this.ranges[i+r];t(a,a+c,l,l+u),s+=u-c}}invert(){return new Wt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Wt.empty:new Wt(t<0?[0,-t,0]:[0,0,t])}}Wt.empty=new Wt([]);class yi{constructor(t,e,r=0,i=t?t.length:0){this.mirror=e,this.from=r,this.to=i,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new yi(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),e!=null&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,r=this._maps.length;e<t._maps.length;e++){let i=t.getMirror(e);this.appendMap(t._maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this._maps.length+t._maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t._maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new yi;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this._maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],a=o.mapResult(t,e);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,t=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,t=a.pos}return r?t:new gl(t,i,null)}}const Oa=Object.create(null);class Nt{getMap(){return Wt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Oa[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Oa)throw new RangeError("Duplicate use of step JSON ID "+t);return Oa[t]=e,e.prototype.jsonID=t,e}}class ht{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new ht(t,null)}static fail(t){return new ht(null,t)}static fromReplace(t,e,r,i){try{return ht.ok(t.replace(e,r,i))}catch(s){if(s instanceof Ns)return ht.fail(s.message);throw s}}}function lc(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(lc(s.content,t,s))),s.isInline&&(s=t(s,e,i)),r.push(s)}return O.fromArray(r)}class Ke extends Nt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new R(lc(e.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),e.openStart,e.openEnd);return ht.fromReplace(t,this.from,this.to,s)}invert(){return new ie(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ke(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ke&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ke(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ke(e.from,e.to,t.markFromJSON(e.mark))}}Nt.jsonID("addMark",Ke);class ie extends Nt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new R(lc(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return ht.fromReplace(t,this.from,this.to,r)}invert(){return new Ke(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new ie(e.pos,r.pos,this.mark)}merge(t){return t instanceof ie&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new ie(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ie(e.from,e.to,t.markFromJSON(e.mark))}}Nt.jsonID("removeMark",ie);class qe extends Nt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return ht.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return ht.fromReplace(t,this.pos,this.pos+1,new R(O.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new qe(this.pos,e.marks[i]);return new qe(this.pos,this.mark)}}return new Rn(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new qe(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new qe(e.pos,t.markFromJSON(e.mark))}}Nt.jsonID("addNodeMark",qe);class Rn extends Nt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return ht.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return ht.fromReplace(t,this.pos,this.pos+1,new R(O.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new qe(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Rn(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Rn(e.pos,t.markFromJSON(e.mark))}}Nt.jsonID("removeNodeMark",Rn);class vt extends Nt{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&yl(t,this.from,this.to)?ht.fail("Structure replace would overwrite content"):ht.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Wt([this.from,this.to-this.from,this.slice.size])}invert(t){return new vt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new vt(e.pos,Math.max(e.pos,r.pos),this.slice,this.structure)}merge(t){if(!(t instanceof vt)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?R.empty:new R(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new vt(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?R.empty:new R(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new vt(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new vt(e.from,e.to,R.fromJSON(t,e.slice),!!e.structure)}}Nt.jsonID("replace",vt);class St extends Nt{constructor(t,e,r,i,s,o,a=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(t){if(this.structure&&(yl(t,this.from,this.gapFrom)||yl(t,this.gapTo,this.to)))return ht.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return ht.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?ht.fromReplace(t,this.from,this.to,r):ht.fail("Content does not fit in gap")}getMap(){return new Wt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new St(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||s>r.pos?null:new St(e.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new St(e.from,e.to,e.gapFrom,e.gapTo,R.fromJSON(t,e.slice),e.insert,!!e.structure)}}Nt.jsonID("replaceAround",St);function yl(n,t,e){let r=n.resolve(t),i=e-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function pw(n,t,e,r){let i=[],s=[],o,a;n.doc.nodesBetween(t,e,(l,c,u)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,t),d=Math.min(c+l.nodeSize,e),p=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(p)||(o&&o.to==h&&o.mark.eq(f[m])?o.to=d:i.push(o=new ie(h,d,f[m])));a&&a.to==h?a.to=d:s.push(a=new Ke(h,d,r))}}),i.forEach(l=>n.step(l)),s.forEach(l=>n.step(l))}function mw(n,t,e,r){let i=[],s=0;n.doc.nodesBetween(t,e,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof Po){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,e);for(let u=0;u<l.length;u++){let f=l[u],h;for(let d=0;d<i.length;d++){let p=i[d];p.step==s-1&&f.eq(i[d].style)&&(h=p)}h?(h.to=c,h.step=s):i.push({style:f,from:Math.max(a,t),to:c,step:s})}}}),i.forEach(o=>n.step(new ie(o.from,o.to,o.style)))}function cc(n,t,e,r=e.contentMatch,i=!0){let s=n.doc.nodeAt(t),o=[],a=t+1;for(let l=0;l<s.childCount;l++){let c=s.child(l),u=a+c.nodeSize,f=r.matchType(c.type);if(!f)o.push(new vt(a,u,R.empty));else{r=f;for(let h=0;h<c.marks.length;h++)e.allowsMarkType(c.marks[h].type)||n.step(new ie(a,u,c.marks[h]));if(i&&c.isText&&e.whitespace!="pre"){let h,d=/\r?\n|\r/g,p;for(;h=d.exec(c.text);)p||(p=new R(O.from(e.schema.text(" ",e.allowedMarks(c.marks))),0,0)),o.push(new vt(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(O.empty,!0);n.replace(a,a,new R(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function gw(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function vr(n){let e=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,i=0,s=0;;--r){let o=n.$from.node(r),a=n.$from.index(r)+i,l=n.$to.indexAfter(r)-s;if(r<n.depth&&o.canReplace(a,l,e))return r;if(r==0||o.type.spec.isolating||!gw(o,a,l))break;a&&(i=1),l<o.childCount&&(s=1)}return null}function yw(n,t,e){let{$from:r,$to:i,depth:s}=t,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=O.empty,f=0;for(let p=s,m=!1;p>e;p--)m||r.index(p)>0?(m=!0,u=O.from(r.node(p).copy(u)),f++):l--;let h=O.empty,d=0;for(let p=s,m=!1;p>e;p--)m||i.after(p+1)<i.end(p)?(m=!0,h=O.from(i.node(p).copy(h)),d++):c++;n.step(new St(l,c,o,a,new R(u.append(h),f,d),u.size-f,!0))}function uc(n,t,e=null,r=n){let i=bw(n,t),s=i&&xw(r,t);return s?i.map(Xf).concat({type:t,attrs:e}).concat(s.map(Xf)):null}function Xf(n){return{type:n,attrs:null}}function bw(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.contentMatchAt(r).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return e.canReplaceWith(r,i,o)?s:null}function xw(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.child(r),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:t).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(e.child(c).type);return!l||!l.validEnd?null:o}function vw(n,t,e){let r=O.empty;for(let o=e.length-1;o>=0;o--){if(r.size){let a=e[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=O.from(e[o].type.create(e[o].attrs,r))}let i=t.start,s=t.end;n.step(new St(i,s,i,s,new R(r,0,0),e.length,!0))}function kw(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(t,e,(o,a)=>{let l=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,l)&&Sw(n.doc,n.mapping.slice(s).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let d=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);d&&!p?c=!1:!d&&p&&(c=!0)}c===!1&&em(n,o,a,s),cc(n,n.mapping.slice(s).map(a,1),r,void 0,c===null);let u=n.mapping.slice(s),f=u.map(a,1),h=u.map(a+o.nodeSize,1);return n.step(new St(f,h,f+1,h-1,new R(O.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&tm(n,o,a,s),!1}})}function tm(n,t,e,r){t.forEach((i,s)=>{if(i.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(i.text);){let l=n.mapping.slice(r).map(e+1+s+o.index);n.replaceWith(l,l+1,t.type.schema.linebreakReplacement.create())}}})}function em(n,t,e,r){t.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(e+1+s);n.replaceWith(o,o+1,t.type.schema.text(`
`))}})}function Sw(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function ww(n,t,e,r,i){let s=n.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");e||(e=s.type);let o=e.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(t,t+s.nodeSize,o);if(!e.validContent(s.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new St(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new R(O.from(o),0,0),1,!0))}function Ae(n,t,e=1,r){let i=n.resolve(t),s=i.depth-e,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=e-2;c>s;c--,u--){let f=i.node(c),h=i.index(c);if(f.type.spec.isolating)return!1;let d=f.content.cutByIndex(h,f.childCount),p=r&&r[u+1];p&&(d=d.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||f;if(!f.canReplace(h+1,f.childCount)||!m.type.validContent(d))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function Mw(n,t,e=1,r){let i=n.doc.resolve(t),s=O.empty,o=O.empty;for(let a=i.depth,l=i.depth-e,c=e-1;a>l;a--,c--){s=O.from(i.node(a).copy(s));let u=r&&r[c];o=O.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}n.step(new vt(t,t,new R(s.append(o),e,e),!0))}function on(n,t){let e=n.resolve(t),r=e.index();return nm(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function Cw(n,t){t.content.size||n.type.compatibleContent(t.type);let e=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<t.childCount;i++){let s=t.child(i),o=s.type==r?n.type.schema.nodes.text:s.type;if(e=e.matchType(o),!e||!n.type.allowsMarks(s.marks))return!1}return e.validEnd}function nm(n,t){return!!(n&&t&&!n.isLeaf&&Cw(n,t))}function No(n,t,e=-1){let r=n.resolve(t);for(let i=r.depth;;i--){let s,o,a=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):e>0?(s=r.node(i+1),a++,o=r.node(i).maybeChild(a)):(s=r.node(i).maybeChild(a-1),o=r.node(i+1)),s&&!s.isTextblock&&nm(s,o)&&r.node(i).canReplace(a,a+1))return t;if(i==0)break;t=e<0?r.before(i):r.after(i)}}function Tw(n,t,e){let r=null,{linebreakReplacement:i}=n.doc.type.schema,s=n.doc.resolve(t-e),o=s.node().type;if(i&&o.inlineContent){let u=o.whitespace=="pre",f=!!o.contentMatch.matchType(i);u&&!f?r=!1:!u&&f&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(t+e);em(n,u.node(),u.before(),a)}o.inlineContent&&cc(n,t+e-1,o,s.node().contentMatchAt(s.index()),r==null);let l=n.mapping.slice(a),c=l.map(t-e);if(n.step(new vt(c,l.map(t+e,-1),R.empty,!0)),r===!0){let u=n.doc.resolve(c);tm(n,u.node(),u.before(),n.steps.length)}return n}function Ow(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,e))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,e))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function rm(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let s=0;s<e.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(e.openStart==0&&e.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let f=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=f&&c.canReplaceWith(l,l,f[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Io(n,t,e=t,r=R.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),s=n.resolve(e);return im(i,s,r)?new vt(t,e,r):new _w(i,s,r).fit()}function im(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class _w{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=O.empty;for(let i=0;i<=t.depth;i++){let s=t.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=O.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new R(s,o,a);return t>-1?new St(r.pos,t,this.$to.pos,this.$to.end(),l,e):l.size||r.pos!=this.$to.pos?new vt(r.pos,i.pos,l):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let s=e.firstChild;if(e.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){t=r;break}e=s.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=_a(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,f=null;if(e==1&&(o?c.matchType(o.type)||(f=c.fillBefore(O.from(o),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:a,parent:s,inject:f};if(e==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=_a(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new R(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=_a(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new R(Rr(t,e-1,1),e-1,s?e-1:r)}else this.unplaced=new R(Rr(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:s}){for(;this.depth>e;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-t,c=0,u=[],{match:f,type:h}=this.frontier[e];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));f=f.matchFragment(i)}let d=a.size+t-(o.content.size-o.openEnd);for(;c<a.childCount;){let m=a.child(c),g=f.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(f=g,u.push(sm(m.mark(h.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?d:-1)))}let p=c==a.childCount;p||(d=-1),this.placed=Lr(this.placed,e,O.from(u)),this.frontier[e].match=f,p&&d<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<d;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=p?t==0?R.empty:new R(Rr(o.content,t-1,1),t-1,d<0?o.openEnd:t-1):new R(Rr(o.content,t,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Ea(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],s=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),o=Ea(t,e,i,r,s);if(o){for(let a=e-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Ea(t,a,c,l,!0);if(!u||u.childCount)continue t}return{depth:e,fit:o,move:s?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Lr(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,s)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=Lr(this.placed,this.depth,O.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(O.empty,!0);e.childCount&&(this.placed=Lr(this.placed,this.frontier.length,e))}}function Rr(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(Rr(n.firstChild.content,t-1,e)))}function Lr(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(Lr(n.lastChild.content,t-1,e)))}function _a(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function sm(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,sm(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(O.empty,!0)))),n.copy(r)}function Ea(n,t,e,r,i){let s=n.node(t),o=i?n.indexAfter(t):n.index(t);if(o==s.childCount&&!e.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!Ew(e,s.content,o)?a:null}function Ew(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function Aw(n){return n.spec.defining||n.spec.definingForContent}function Dw(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),s=n.doc.resolve(e);if(im(i,s,r))return n.step(new vt(t,e,r));let o=am(i,s);o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let h=i.depth,d=i.pos-1;h>0;h--,d--){let p=i.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(h)>-1?a=h:i.before(h)==d&&o.splice(1,0,-h)}let l=o.indexOf(a),c=[],u=r.openStart;for(let h=r.content,d=0;;d++){let p=h.firstChild;if(c.push(p),d==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let d=c[h],p=Aw(d.type);if(p&&!d.sameMarkup(i.node(Math.abs(a)-1)))u=h;else if(p||!d.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let d=(h+u+1)%(r.openStart+1),p=c[d];if(p)for(let m=0;m<o.length;m++){let g=o[(m+l)%o.length],y=!0;g<0&&(y=!1,g=-g);let b=i.node(g-1),v=i.index(g-1);if(b.canReplaceWith(v,v,p.type,p.marks))return n.replace(i.before(g),y?s.after(g):e,new R(om(r.content,0,r.openStart,d),d,r.openEnd))}}let f=n.steps.length;for(let h=o.length-1;h>=0&&(n.replace(t,e,r),!(n.steps.length>f));h--){let d=o[h];d<0||(t=i.before(d),e=s.after(d))}}function om(n,t,e,r,i){if(t<e){let s=n.firstChild;n=n.replaceChild(0,s.copy(om(s.content,t+1,e,r,s)))}if(t>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(O.empty,!0))}return n}function Pw(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=Ow(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new R(O.from(r),0,0))}function Nw(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),s=am(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(t-r.start(o)==r.depth-o&&e>r.end(o)&&i.end(o)-e!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return n.delete(r.before(o),e);n.delete(t,e)}function am(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(s==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==s-1)&&e.push(i)}return e}class nr extends Nt{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return ht.fail("No node at attribute step's position");let r=Object.create(null);for(let s in e.attrs)r[s]=e.attrs[s];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return ht.fromReplace(t,this.pos,this.pos+1,new R(O.from(i),0,e.isLeaf?0:1))}getMap(){return Wt.empty}invert(t){return new nr(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new nr(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new nr(e.pos,e.attr,e.value)}}Nt.jsonID("attr",nr);class bi extends Nt{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return ht.ok(r)}getMap(){return Wt.empty}invert(t){return new bi(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new bi(e.attr,e.value)}}Nt.jsonID("docAttr",bi);let ur=class extends Error{};ur=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e};ur.prototype=Object.create(Error.prototype);ur.prototype.constructor=ur;ur.prototype.name="TransformError";class lm{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new yi}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new ur(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,e=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(t=i.map(t,1),e=i.map(e,-1)),i.forEach((s,o,a,l)=>{t=Math.min(t,a),e=Math.max(e,l)})}return t==1e9?null:{from:t,to:e}}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=R.empty){let i=Io(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new R(O.from(r),0,0))}delete(t,e){return this.replace(t,e,R.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return Dw(this,t,e,r),this}replaceRangeWith(t,e,r){return Pw(this,t,e,r),this}deleteRange(t,e){return Nw(this,t,e),this}lift(t,e){return yw(this,t,e),this}join(t,e=1){return Tw(this,t,e),this}wrap(t,e){return vw(this,t,e),this}setBlockType(t,e=t,r,i=null){return kw(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return ww(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new nr(t,e,r)),this}setDocAttribute(t,e){return this.step(new bi(t,e)),this}addNodeMark(t,e){return this.step(new qe(t,e)),this}removeNodeMark(t,e){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e instanceof Z)e.isInSet(r.marks)&&this.step(new Rn(t,e));else{let i=r.marks,s,o=[];for(;s=e.isInSet(i);)o.push(new Rn(t,s)),i=s.removeFromSet(i);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(t,e=1,r){return Mw(this,t,e,r),this}addMark(t,e,r){return pw(this,t,e,r),this}removeMark(t,e,r){return mw(this,t,e,r),this}clearIncompatible(t,e,r){return cc(this,t,e,r),this}}const Aa=Object.create(null);class j{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new Iw(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=R.empty){let r=e.content.lastChild,i=null;for(let a=0;a<e.openEnd;a++)i=r,r=r.lastChild;let s=t.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=t.mapping.slice(s);t.replaceRange(u.map(l.pos),u.map(c.pos),a?R.empty:e),a==0&&th(t,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=t.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?t.deleteRange(c,u):(t.replaceRangeWith(c,u,e),th(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new H(t):Yn(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let s=t.depth-1;s>=0;s--){let o=e<0?Yn(t.node(0),t.node(s),t.before(s+1),t.index(s),e,r):Yn(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,e,r);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new jt(t.node(0))}static atStart(t){return Yn(t,t,0,0,1)||new jt(t)}static atEnd(t){return Yn(t,t,t.content.size,t.childCount,-1)||new jt(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Aa[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Aa)throw new RangeError("Duplicate use of selection JSON ID "+t);return Aa[t]=e,e.prototype.jsonID=t,e}getBookmark(){return H.between(this.$anchor,this.$head).getBookmark()}}j.prototype.visible=!0;class Iw{constructor(t,e){this.$from=t,this.$to=e}}let Qf=!1;function Zf(n){!Qf&&!n.parent.inlineContent&&(Qf=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class H extends j{constructor(t,e=t){Zf(t),Zf(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return j.near(r);let i=t.resolve(e.map(this.anchor));return new H(i.parent.inlineContent?i:r,r)}replace(t,e=R.empty){if(super.replace(t,e),e==R.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof H&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Ro(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new H(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let s=j.findFrom(e,r,!0)||j.findFrom(e,-r,!0);if(s)e=s.$head;else return j.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(j.findFrom(t,-r,!0)||j.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new H(t,e)}}j.jsonID("text",H);class Ro{constructor(t,e){this.anchor=t,this.head=e}map(t){return new Ro(t.map(this.anchor),t.map(this.head))}resolve(t){return H.between(t.resolve(this.anchor),t.resolve(this.head))}}class B extends j{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),s=t.resolve(i);return r?j.near(s):new B(s)}content(){return new R(O.from(this.node),0,0)}eq(t){return t instanceof B&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new fc(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new B(t.resolve(e.anchor))}static create(t,e){return new B(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}B.prototype.visible=!1;j.jsonID("node",B);class fc{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new Ro(r,r):new fc(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&B.isSelectable(r)?new B(e):j.near(e)}}class jt extends j{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=R.empty){if(e==R.empty){t.delete(0,t.doc.content.size);let r=j.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new jt(t)}map(t){return new jt(t)}eq(t){return t instanceof jt}getBookmark(){return Rw}}j.jsonID("all",jt);const Rw={map(){return this},resolve(n){return new jt(n)}};function Yn(n,t,e,r,i,s=!1){if(t.inlineContent)return H.create(n,e);for(let o=r-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let a=t.child(o);if(a.isAtom){if(!s&&B.isSelectable(a))return B.create(n,e-(i<0?a.nodeSize:0))}else{let l=Yn(n,a,e+i,i<0?a.childCount:0,i,s);if(l)return l}e+=a.nodeSize*i}return null}function th(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof vt||i instanceof St))return;let s=n.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(j.near(n.doc.resolve(o),e))}const eh=1,Qi=2,nh=4;class Lw extends lm{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|eh)&~Qi,this.storedMarks=null,this}get selectionSet(){return(this.updated&eh)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Qi,this}ensureMarks(t){return Z.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Qi)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~Qi,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Z.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),!t)return this.deleteRange(e,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(e);s=r==e?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,s)),!this.selection.empty&&this.selection.to==e+t.length&&this.setSelection(j.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=nh,this}get scrolledIntoView(){return(this.updated&nh)>0}}function rh(n,t){return!t||!n?n:n.bind(t)}class Br{constructor(t,e,r){this.name=t,this.init=rh(e.init,r),this.apply=rh(e.apply,r)}}const Bw=[new Br("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Br("selection",{init(n,t){return n.selection||j.atStart(t.doc)},apply(n){return n.selection}}),new Br("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new Br("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class Da{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Bw.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Br(r.key,r.spec.state,r))})}}class Zn{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<e.length&&a.spec.appendTransaction.call(a,l?e.slice(l):e,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",t),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<o?{state:r,n:e.length}:{state:this,n:0})}e.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:e.length})}}if(!s)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Zn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];e[s.name]=s.apply(t,this[s.name],this,e)}return e}get tr(){return new Lw(this)}static create(t){let e=new Da(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Zn(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new Da(this.schema,t.plugins),r=e.fields,i=new Zn(e);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],s=i.spec.state;s&&s.toJSON&&(e[r]=s.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new Da(t.schema,t.plugins),s=new Zn(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=oe.fromJSON(t.schema,e.doc);else if(o.name=="selection")s.selection=j.fromJSON(s.doc,e.selection);else if(o.name=="storedMarks")e.storedMarks&&(s.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,a)){s[o.name]=c.fromJSON.call(l,t,e[a],s);return}}s[o.name]=o.init(t,s)}}),s}}function cm(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=cm(i,t,{})),e[r]=i}return e}class ot{constructor(t){this.spec=t,this.props={},t.props&&cm(t.props,this,this.props),this.key=t.key?t.key.key:um("plugin")}getState(t){return t[this.key]}}const Pa=Object.create(null);function um(n){return n in Pa?n+"$"+ ++Pa[n]:(Pa[n]=0,n+"$")}class yt{constructor(t="key"){this.key=um(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const hc=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function fm(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const hm=(n,t,e)=>{let r=fm(n,e);if(!r)return!1;let i=dc(r);if(!i){let o=r.blockRange(),a=o&&vr(o);return a==null?!1:(t&&t(n.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(km(n,i,t,-1))return!0;if(r.parent.content.size==0&&(fr(s,"end")||B.isSelectable(s)))for(let o=r.depth;;o--){let a=Io(n.doc,r.before(o),r.after(o),R.empty);if(a&&a.slice.size<a.to-a.from){if(t){let l=n.tr.step(a);l.setSelection(fr(s,"end")?j.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):B.create(l.doc,i.pos-s.nodeSize)),t(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},$w=(n,t,e)=>{let r=fm(n,e);if(!r)return!1;let i=dc(r);return i?dm(n,i,t):!1},zw=(n,t,e)=>{let r=mm(n,e);if(!r)return!1;let i=pc(r);return i?dm(n,i,t):!1};function dm(n,t,e){let r=t.nodeBefore,i=r,s=t.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let o=t.nodeAfter,a=o,l=t.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=Io(n.doc,s,l,R.empty);if(!c||c.from!=s||c instanceof vt&&c.slice.size>=l-s)return!1;if(e){let u=n.tr.step(c);u.setSelection(H.create(u.doc,s)),e(u.scrollIntoView())}return!0}function fr(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const pm=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=dc(r)}let o=s&&s.nodeBefore;return!o||!B.isSelectable(o)?!1:(t&&t(n.tr.setSelection(B.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function dc(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function mm(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const gm=(n,t,e)=>{let r=mm(n,e);if(!r)return!1;let i=pc(r);if(!i)return!1;let s=i.nodeAfter;if(km(n,i,t,1))return!0;if(r.parent.content.size==0&&(fr(s,"start")||B.isSelectable(s))){let o=Io(n.doc,r.before(),r.after(),R.empty);if(o&&o.slice.size<o.to-o.from){if(t){let a=n.tr.step(o);a.setSelection(fr(s,"start")?j.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):B.create(a.doc,a.mapping.map(i.pos))),t(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},ym=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=pc(r)}let o=s&&s.nodeAfter;return!o||!B.isSelectable(o)?!1:(t&&t(n.tr.setSelection(B.create(n.doc,s.pos)).scrollIntoView()),!0)};function pc(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const Fw=(n,t)=>{let e=n.selection,r=e instanceof B,i;if(r){if(e.node.isTextblock||!on(n.doc,e.from))return!1;i=e.from}else if(i=No(n.doc,e.from,-1),i==null)return!1;if(t){let s=n.tr.join(i);r&&s.setSelection(B.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},Hw=(n,t)=>{let e=n.selection,r;if(e instanceof B){if(e.node.isTextblock||!on(n.doc,e.to))return!1;r=e.to}else if(r=No(n.doc,e.to,1),r==null)return!1;return t&&t(n.tr.join(r).scrollIntoView()),!0},Vw=(n,t)=>{let{$from:e,$to:r}=n.selection,i=e.blockRange(r),s=i&&vr(i);return s==null?!1:(t&&t(n.tr.lift(i,s).scrollIntoView()),!0)},bm=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function mc(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Ww=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),s=e.indexAfter(-1),o=mc(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let a=e.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(j.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},xm=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof jt||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=mc(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(o,s.createAndFill());a.setSelection(H.create(a.doc,o+1)),t(a.scrollIntoView())}return!0},vm=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let s=e.before();if(Ae(n.doc,s))return t&&t(n.tr.split(s).scrollIntoView()),!0}let r=e.blockRange(),i=r&&vr(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)};function jw(n){return(t,e)=>{let{$from:r,$to:i}=t.selection;if(t.selection instanceof B&&t.selection.node.isBlock)return!r.parentOffset||!Ae(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,a,l=!1,c=!1;for(let d=r.depth;;d--)if(r.node(d).isBlock){l=r.end(d)==r.pos+(r.depth-d),c=r.start(d)==r.pos-(r.depth-d),a=mc(r.node(d-1).contentMatchAt(r.indexAfter(d-1))),s.unshift(l&&a?{type:a}:null),o=d;break}else{if(d==1)return!1;s.unshift(null)}let u=t.tr;(t.selection instanceof H||t.selection instanceof jt)&&u.deleteSelection();let f=u.mapping.map(r.pos),h=Ae(u.doc,f,s.length,s);if(h||(s[0]=a?{type:a}:null,h=Ae(u.doc,f,s.length,s)),!h)return!1;if(u.split(f,s.length,s),!l&&c&&r.node(o).type!=a){let d=u.mapping.map(r.before(o)),p=u.doc.resolve(d);a&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return e&&e(u.scrollIntoView()),!0}}const Uw=jw(),Kw=(n,t)=>{let{$from:e,to:r}=n.selection,i,s=e.sharedDepth(r);return s==0?!1:(i=e.before(s),t&&t(n.tr.setSelection(B.create(n.doc,i))),!0)};function qw(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(s-1,s)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(i.isTextblock||on(n.doc,t.pos))?!1:(e&&e(n.tr.join(t.pos).scrollIntoView()),!0)}function km(n,t,e,r){let i=t.nodeBefore,s=t.nodeAfter,o,a,l=i.type.spec.isolating||s.type.spec.isolating;if(!l&&qw(n,t,e))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(a=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&a.matchType(o[0]||s.type).validEnd){if(e){let d=t.pos+s.nodeSize,p=O.empty;for(let y=o.length-1;y>=0;y--)p=O.from(o[y].create(null,p));p=O.from(i.copy(p));let m=n.tr.step(new St(t.pos-1,d,t.pos,d,new R(p,1,0),o.length,!0)),g=m.doc.resolve(d+2*o.length);g.nodeAfter&&g.nodeAfter.type==i.type&&on(m.doc,g.pos)&&m.join(g.pos),e(m.scrollIntoView())}return!0}let u=s.type.spec.isolating||r>0&&l?null:j.findFrom(t,1),f=u&&u.$from.blockRange(u.$to),h=f&&vr(f);if(h!=null&&h>=t.depth)return e&&e(n.tr.lift(f,h).scrollIntoView()),!0;if(c&&fr(s,"start",!0)&&fr(i,"end")){let d=i,p=[];for(;p.push(d),!d.isTextblock;)d=d.lastChild;let m=s,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(d.canReplace(d.childCount,d.childCount,m.content)){if(e){let y=O.empty;for(let v=p.length-1;v>=0;v--)y=O.from(p[v].copy(y));let b=n.tr.step(new St(t.pos-p.length,t.pos+s.nodeSize,t.pos+g,t.pos+s.nodeSize-g,new R(y,p.length,0),0,!0));e(b.scrollIntoView())}return!0}}return!1}function Sm(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(e&&e(t.tr.setSelection(H.create(t.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const Jw=Sm(-1),Yw=Sm(1);function Gw(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s),a=o&&uc(o,n,t);return a?(r&&r(e.tr.wrap(o,a).scrollIntoView()),!0):!1}}function ih(n,t=null){return function(e,r){let i=!1;for(let s=0;s<e.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:a}}=e.selection.ranges[s];e.doc.nodesBetween(o,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,t)))if(l.type==n)i=!0;else{let u=e.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,n)}})}if(!i)return!1;if(r){let s=e.tr;for(let o=0;o<e.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=e.selection.ranges[o];s.setBlockType(a,l,n,t)}r(s.scrollIntoView())}return!0}}function gc(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}gc(hc,hm,pm);gc(hc,gm,ym);gc(bm,xm,vm,Uw);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Xw(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s);if(!o)return!1;let a=r?e.tr:null;return Qw(a,o,n,t)?(r&&r(a.scrollIntoView()),!0):!1}}function Qw(n,t,e,r=null){let i=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(e)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let l=o.resolve(t.start-2);s=new Rs(l,l,t.depth),t.endIndex<t.parent.childCount&&(t=new Rs(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let a=uc(s,e,r,t);return a?(n&&Zw(n,t,a,i,e),!0):!1}function Zw(n,t,e,r,i){let s=O.empty;for(let u=e.length-1;u>=0;u--)s=O.from(e[u].type.create(e[u].attrs,s));n.step(new St(t.start-(r?2:0),t.end,t.start,t.end,new R(s,0,0),e.length,!0));let o=0;for(let u=0;u<e.length;u++)e[u].type==i&&(o=u+1);let a=e.length-o,l=t.start+e.length-(r?2:0),c=t.parent;for(let u=t.startIndex,f=t.endIndex,h=!0;u<f;u++,h=!1)!h&&Ae(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function tM(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?e?r.node(s.depth-1).type==n?eM(t,e,n,s):nM(t,e,s):!0:!1}}function eM(n,t,e,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new St(s-1,o,s,o,new R(O.from(e.create(null,r.parent.copy())),1,0),1,!0)),r=new Rs(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=vr(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(s,-1)-1);return on(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),t(i.scrollIntoView()),!0}function nM(n,t,e){let r=n.tr,i=e.parent;for(let d=e.end,p=e.endIndex-1,m=e.startIndex;p>m;p--)d-=i.child(p).nodeSize,r.delete(d-1,d+1);let s=r.doc.resolve(e.start),o=s.nodeAfter;if(r.mapping.map(e.end)!=e.start+s.nodeAfter.nodeSize)return!1;let a=e.startIndex==0,l=e.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?O.empty:O.from(i))))return!1;let f=s.pos,h=f+o.nodeSize;return r.step(new St(f-(a?1:0),h+(l?1:0),f+1,h-1,new R((a?O.empty:O.from(i.copy(O.empty))).append(l?O.empty:O.from(i.copy(O.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}function rM(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=n)return!1;if(e){let c=l.lastChild&&l.lastChild.type==a.type,u=O.from(c?n.create():null),f=new R(O.from(n.create(null,O.from(a.type.create(null,u)))),c?3:1,0),h=s.start,d=s.end;e(t.tr.step(new St(h-(c?3:1),d,h,d,f,1,!0)).scrollIntoView())}return!0}}const Ct=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},hr=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let bl=null;const Oe=function(n,t,e){let r=bl||(bl=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},iM=function(){bl=null},Ln=function(n,t,e,r){return e&&(sh(n,t,e,r,-1)||sh(n,t,e,r,1))},sM=/^(img|br|input|textarea|hr)$/i;function sh(n,t,e,r,i){for(var s;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Gt(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Ai(n)||sM.test(n.nodeName)||n.contentEditable=="false")return!1;t=Ct(n)+(i<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[t+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)t+=i;else return!1;else n=o,t=i<0?Gt(n):0}else return!1}}function Gt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function oM(n,t){for(;;){if(n.nodeType==3&&t)return n;if(n.nodeType==1&&t>0){if(n.contentEditable=="false")return null;n=n.childNodes[t-1],t=Gt(n)}else if(n.parentNode&&!Ai(n))t=Ct(n),n=n.parentNode;else return null}}function aM(n,t){for(;;){if(n.nodeType==3&&t<n.nodeValue.length)return n;if(n.nodeType==1&&t<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[t],t=0}else if(n.parentNode&&!Ai(n))t=Ct(n)+1,n=n.parentNode;else return null}}function lM(n,t,e){for(let r=t==0,i=t==Gt(n);r||i;){if(n==e)return!0;let s=Ct(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Gt(n)}}function Ai(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const Lo=function(n){return n.focusNode&&Ln(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function bn(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function cM(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function uM(n,t,e){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(t,e);if(r)return{node:r.offsetNode,offset:Math.min(Gt(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(t,e);if(r)return{node:r.startContainer,offset:Math.min(Gt(r.startContainer),r.startOffset)}}}const ye=typeof navigator<"u"?navigator:null,oh=typeof document<"u"?document:null,an=ye&&ye.userAgent||"",xl=/Edge\/(\d+)/.exec(an),wm=/MSIE \d/.exec(an),vl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(an),Vt=!!(wm||vl||xl),Xe=wm?document.documentMode:vl?+vl[1]:xl?+xl[1]:0,Zt=!Vt&&/gecko\/(\d+)/i.test(an);Zt&&+(/Firefox\/(\d+)/.exec(an)||[0,0])[1];const kl=!Vt&&/Chrome\/(\d+)/.exec(an),Ot=!!kl,Mm=kl?+kl[1]:0,Pt=!Vt&&!!ye&&/Apple Computer/.test(ye.vendor),dr=Pt&&(/Mobile\/\w+/.test(an)||!!ye&&ye.maxTouchPoints>2),Yt=dr||(ye?/Mac/.test(ye.platform):!1),Cm=ye?/Win/.test(ye.platform):!1,Ee=/Android \d/.test(an),Di=!!oh&&"webkitFontSmoothing"in oh.documentElement.style,fM=Di?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hM(n){let t=n.defaultView&&n.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function ve(n,t){return typeof n=="number"?n:n[t]}function dM(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function ah(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=e||n.dom;o;){if(o.nodeType!=1){o=hr(o);continue}let a=o,l=a==s.body,c=l?hM(s):dM(a),u=0,f=0;if(t.top<c.top+ve(r,"top")?f=-(c.top-t.top+ve(i,"top")):t.bottom>c.bottom-ve(r,"bottom")&&(f=t.bottom-t.top>c.bottom-c.top?t.top+ve(i,"top")-c.top:t.bottom-c.bottom+ve(i,"bottom")),t.left<c.left+ve(r,"left")?u=-(c.left-t.left+ve(i,"left")):t.right>c.right-ve(r,"right")&&(u=t.right-c.right+ve(i,"right")),u||f)if(l)s.defaultView.scrollBy(u,f);else{let d=a.scrollLeft,p=a.scrollTop;f&&(a.scrollTop+=f),u&&(a.scrollLeft+=u);let m=a.scrollLeft-d,g=a.scrollTop-p;t={left:t.left-m,top:t.top-g,right:t.right-m,bottom:t.bottom-g}}let h=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(h))break;o=h=="absolute"?o.offsetParent:hr(o)}}function pM(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let s=(t.left+t.right)/2,o=e+1;o<Math.min(innerHeight,t.bottom);o+=5){let a=n.root.elementFromPoint(s,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=e-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:Tm(n.dom)}}function Tm(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=hr(r));return t}function mM({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;Om(e,r==0?0:r-t)}function Om(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:s}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Kn=null;function gM(n){if(n.setActive)return n.setActive();if(Kn)return n.focus(Kn);let t=Tm(n);n.focus(Kn==null?{get preventScroll(){return Kn={preventScroll:!0},!0}}:void 0),Kn||(Kn=!1,Om(t,0))}function _m(n,t){let e,r=2e8,i,s=0,o=t.top,a=t.top,l,c;for(let u=n.firstChild,f=0;u;u=u.nextSibling,f++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Oe(u).getClientRects();else continue;for(let d=0;d<h.length;d++){let p=h[d];if(p.top<=o&&p.bottom>=a){o=Math.max(p.bottom,o),a=Math.min(p.top,a);let m=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(m<r){e=u,r=m,i=m&&e.nodeType==3?{left:p.right<t.left?p.right:p.left,top:t.top}:t,u.nodeType==1&&m&&(s=f+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!l&&p.left<=t.left&&p.right>=t.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!e&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(s=f+1)}}return!e&&l&&(e=l,i=c,r=0),e&&e.nodeType==3?yM(e,i):!e||r&&e.nodeType==1?{node:n,offset:s}:_m(e,i)}function yM(n,t){let e=n.nodeValue.length,r=document.createRange(),i;for(let s=0;s<e;s++){r.setEnd(n,s+1),r.setStart(n,s);let o=Be(r,1);if(o.top!=o.bottom&&yc(t,o)){i={node:n,offset:s+(t.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),i||{node:n,offset:0}}function yc(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function bM(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function xM(n,t,e){let{node:r,offset:i}=_m(t,e),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&e.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function vM(n,t,e,r){let i=-1;for(let s=t,o=!1;s!=n.dom;){let a=n.docView.nearestDesc(s,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!o&&l.left>r.left||l.top>r.top?i=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),o=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;s=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function Em(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(yc(t,c))return Em(o,t,c)}}if((s=(s+1)%r)==i)break}return n}function kM(n,t){let e=n.dom.ownerDocument,r,i=0,s=uM(e,t.left,t.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!yc(t,c)||(o=Em(n.dom,t,c),!o))return null}if(Pt)for(let c=o;r&&c;c=hr(c))c.draggable&&(r=void 0);if(o=bM(o,t),r){if(Zt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=t.left&&f.bottom>t.top&&i++}let c;Di&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=vM(n,r,i,t))}a==null&&(a=xM(n,o,t));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function lh(n){return n.top<n.bottom||n.left<n.right}function Be(n,t){let e=n.getClientRects();if(e.length){let r=e[t<0?0:e.length-1];if(lh(r))return r}return Array.prototype.find.call(e,lh)||n.getBoundingClientRect()}const SM=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Am(n,t,e){let{node:r,offset:i,atom:s}=n.docView.domFromPos(t,e<0?-1:1),o=Di||Zt;if(r.nodeType==3)if(o&&(SM.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let l=Be(Oe(r,i,i),e);if(Zt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Be(Oe(r,i-1,i-1),-1);if(c.top==l.top){let u=Be(Oe(r,i,i+1),-1);if(u.top!=l.top)return Er(u,u.left<c.left)}}return l}else{let l=i,c=i,u=e<0?1:-1;return e<0&&!i?(c++,u=-1):e>=0&&i==r.nodeValue.length?(l--,u=1):e<0?l--:c++,Er(Be(Oe(r,l,c),u),u<0)}if(!n.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&i&&(e<0||i==Gt(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Na(l.getBoundingClientRect(),!1)}if(s==null&&i<Gt(r)){let l=r.childNodes[i];if(l.nodeType==1)return Na(l.getBoundingClientRect(),!0)}return Na(r.getBoundingClientRect(),e>=0)}if(s==null&&i&&(e<0||i==Gt(r))){let l=r.childNodes[i-1],c=l.nodeType==3?Oe(l,Gt(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Er(Be(c,1),!1)}if(s==null&&i<Gt(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Oe(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Er(Be(c,-1),!0)}return Er(Be(r.nodeType==3?Oe(r):r,-e),e>=0)}function Er(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Na(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Dm(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function wM(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return Dm(n,t,()=>{let{node:s}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.contentDOM||a.dom;break}s=a.dom.parentNode}let o=Am(n,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Oe(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(e=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const MM=/[\u0590-\u08ac]/;function CM(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=n.domSelection();return a?!MM.test(r.parent.textContent)||!a.modify?e=="left"||e=="backward"?s:o:Dm(n,t,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:f}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",e,"character");let d=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!d.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,f),l&&(l!=u||c!=f)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),g}):r.pos==r.start()||r.pos==r.end()}let ch=null,uh=null,fh=!1;function TM(n,t,e){return ch==t&&uh==e?fh:(ch=t,uh=e,fh=e=="up"||e=="down"?wM(n,t,e):CM(n,t,e))}const te=0,hh=1,Sn=2,be=3;class Pi{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=te,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let s,o;if(t==this.contentDOM)s=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(t==this.contentDOM)s=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>Ct(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!e||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))r=!1;else return s}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],s=r+i.size;if(r==t&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let a=i.children[o];if(a.size){i=a;break}}return i}if(t<s)return i.descAt(t-r-i.border);r=s}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>t||o instanceof Nm){i=t-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof Pm&&s.side>=0;r--);if(e<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&e&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?Ct(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?Ct(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(i==-1&&t<=c){let u=o+l.border;if(t>=u&&e<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,e,u);t=o;for(let f=a;f>0;f--){let h=this.children[f-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=Ct(h.dom)+1;break}t-=h.size}i==-1&&(i=0)}if(i>-1&&(c>e||a==this.children.length-1)){e=c;for(let u=a+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=Ct(f.dom);break}e+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let s=Math.min(t,e),o=Math.max(t,e);for(let d=0,p=0;d<this.children.length;d++){let m=this.children[d],g=p+m.size;if(s>p&&o<g)return m.setSelection(t-p-m.border,e-p-m.border,r,i);p=g}let a=this.domFromPos(t,t?-1:1),l=e==t?a:this.domFromPos(e,e?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),f=!1;if((Zt||Pt)&&t==e){let{node:d,offset:p}=a;if(d.nodeType==3){if(f=!!(p&&d.nodeValue[p-1]==`
`),f&&p==d.nodeValue.length)for(let m=d,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:Ct(g)+1});break}let y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let m=d.childNodes[p-1];f=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Zt&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let d=u.focusNode.childNodes[u.focusOffset];d&&d.contentEditable=="false"&&(i=!0)}if(!(i||f&&Pt)&&Ln(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Ln(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||t==e)&&!(f&&Zt)){c.collapse(a.node,a.offset);try{t!=e&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(t>e){let p=a;a=l,l=p}let d=document.createRange();d.setEnd(l.node,l.offset),d.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(d)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?t<=o&&e>=r:t<o&&e>r){let a=r+s.border,l=o-s.border;if(t>=a&&e<=l){this.dirty=t==r||e==o?Sn:hh,t==a&&e==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=be:s.markDirty(t-a,e-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Sn:be}r=o}this.dirty=Sn}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Sn:hh;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class Pm extends Pi{constructor(t,e,r,i){let s,o=e.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!e.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(t,[],o,null),this.widget=e,this.widget=e,s=this}matchesWidget(t){return this.dirty==te&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class OM extends Pi{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class Bn extends Pi{constructor(t,e,r,i,s){super(t,[],r,i),this.mark=e,this.spec=s}static create(t,e,r,i){let s=i.nodeViews[e.type.name],o=s&&s(e,i,r);return(!o||!o.dom)&&(o=Hn.renderSpec(document,e.type.spec.toDOM(e,r),null,e.attrs)),new Bn(t,e,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&be||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=be&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=te){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=te}}slice(t,e,r){let i=Bn.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;e<o&&(s=wl(s,e,o,r)),t>0&&(s=wl(s,0,t,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Qe extends Pi{constructor(t,e,r,i,s,o,a,l,c){super(t,[],s,o),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(t,e,r,i,s,o){let a=s.nodeViews[e.type.name],l,c=a&&a(e,s,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,f=c&&c.contentDOM;if(e.isText){if(!u)u=document.createTextNode(e.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=Hn.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!f&&!e.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),e.type.spec.draggable&&(u.draggable=!0));let h=u;return u=Lm(u,r,e),c?l=new _M(t,e,r,i,u,f||null,h,c,s,o+1):e.isText?new Bo(t,e,r,i,u,h,s):new Qe(t,e,r,i,u,f||null,h,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>O.empty)}return t}matchesNode(t,e,r){return this.dirty==te&&t.eq(this.node)&&Bs(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,s=t.composing?this.localCompositionInfo(t,e):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new AM(this,o&&o.node,t);NM(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,t,u):c.type.side>=0&&!f&&l.syncToMarks(u==this.node.childCount?Z.none:this.node.child(u).marks,r,t,u),l.placeWidget(c,t,i)},(c,u,f,h)=>{l.syncToMarks(c.marks,r,t,h);let d;l.findNodeMatch(c,u,f,h)||a&&t.state.selection.from>i&&t.state.selection.to<i+c.nodeSize&&(d=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,f,d,t)||l.updateNextNode(c,u,f,t,h,i)||l.addNode(c,u,f,t,i),i+=c.nodeSize}),l.syncToMarks([],r,t,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Sn)&&(o&&this.protectLocalComposition(t,o),Im(this.contentDOM,this.children,t),dr&&IM(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof H)||r<e||i>e+this.node.content.size)return null;let s=t.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,a=RM(this.node.content,o,r-e,i-e);return a<0?null:{node:s,pos:a,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let s=e;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new OM(this,s,e,i);t.input.compositionNodes.push(o),this.children=wl(this.children,r,r+i.length,t,o)}update(t,e,r,i){return this.dirty==be||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=te}updateOuterDeco(t){if(Bs(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Rm(this.dom,this.nodeDOM,Sl(this.outerDeco,this.node,e),Sl(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function dh(n,t,e,r,i){Lm(r,t,n);let s=new Qe(void 0,n,t,e,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Bo extends Qe{constructor(t,e,r,i,s,o,a){super(t,e,r,i,s,null,o,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==be||this.dirty!=te&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=te||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=te,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),s=document.createTextNode(i.text);return new Bo(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=be)}get domAtom(){return!1}isText(t){return this.node.text==t}}class Nm extends Pi{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==te&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class _M extends Qe{constructor(t,e,r,i,s,o,a,l,c,u){super(t,e,r,i,s,o,a,c,u),this.spec=l}update(t,e,r,i){if(this.dirty==be)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let s=this.spec.update(t,e,r);return s&&this.updateInner(t,e,r,i),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r.root):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Im(n,t,e){let r=n.firstChild,i=!1;for(let s=0;s<t.length;s++){let o=t[s],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=ph(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(o instanceof Bn){let l=r?r.previousSibling:n.lastChild;Im(o.contentDOM,o.children,e),r=l?l.nextSibling:n.firstChild}}for(;r;)r=ph(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const Qr=function(n){n&&(this.nodeName=n)};Qr.prototype=Object.create(null);const wn=[new Qr];function Sl(n,t,e){if(n.length==0)return wn;let r=e?wn[0]:new Qr,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new Qr(o.nodeName));for(let a in o){let l=o[a];l!=null&&(e&&i.length==1&&i.push(r=new Qr(t.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function Rm(n,t,e,r){if(e==wn&&r==wn)return t;let i=t;for(let s=0;s<r.length;s++){let o=r[s],a=e[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=wn[0]),i=l}EM(i,a||wn[0],o)}return i}function EM(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Lm(n,t,e){return Rm(n,n,wn,Sl(t,e,n.nodeType!=1))}function Bs(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function ph(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class AM{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=DM(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r,i){let s=0,o=this.stack.length>>1,a=Math.min(o,t.length);for(;s<a&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=te,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let l=-1,c=this.top.children.length;i<this.preMatch.index&&(c=Math.min(this.index+3,c));for(let u=this.index;u<c;u++){let f=this.top.children[u];if(f.matchesMark(t[o])&&!this.isLocked(f.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let u=Bn.create(this.top,t[o],e,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,e,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,r,i,s){let o=this.top.children[i];return o.dirty==be&&o.dom==o.contentDOM&&(o.dirty=Sn),o.update(t,e,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,s,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Qe){let c=this.preMatch.matched.get(l);if(c!=null&&c!=s)return!1;let u=l.dom,f,h=this.isLocked(u)&&!(t.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==t.text&&l.dirty!=be&&Bs(e,l.outerDeco));if(!h&&l.update(t,e,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(f=this.recreateWrapper(l,t,e,r,i,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Sn,f.updateChildren(i,o+1),f.dirty=te),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,r,i,s,o){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!Bs(r,t.outerDeco)||!i.eq(t.innerDeco))return null;let a=Qe.create(this.top,e,r,i,s,o);if(a.contentDOM){a.children=t.children,t.children=[];for(let l of a.children)l.parent=a}return t.destroy(),a}addNode(t,e,r,i,s){let o=Qe.create(this.top,t,e,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new Pm(this.top,t,e,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof Bn;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof Bo)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Pt||Ot)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Nm(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function DM(n,t){let e=t,r=e.children.length,i=n.childCount,s=new Map,o=[];t:for(;i>0;){let a;for(;;)if(r){let c=e.children[r-1];if(c instanceof Bn)e=c,r=c.children.length;else{a=c,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}function PM(n,t){return n.type.side-t.type.side}function NM(n,t,e,r){let i=t.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,t.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,f;for(;o<i.length&&i[o].to==s;){let g=i[o++];g.widget&&(u?(f||(f=[u])).push(g):u=g)}if(u)if(f){f.sort(PM);for(let g=0;g<f.length;g++)e(f[g],c,!!l)}else e(u,c,!!l);let h,d;if(l)d=-1,h=l,l=null;else if(c<n.childCount)d=c,h=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=s&&a.splice(g--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let p=s+h.nodeSize;if(h.isText){let g=p;o<i.length&&i[o].from<g&&(g=i[o].from);for(let y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<p&&(l=h.cut(g-s),h=h.cut(0,g-s),p=g,d=-1)}else for(;o<i.length&&i[o].to<p;)o++;let m=h.isInline&&!h.isLeaf?a.filter(g=>!g.inline):a.slice();r(h,m,t.forChild(s,h),d),s=p}}function IM(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function RM(n,t,e,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=e){if(s>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let c=a<r?l.lastIndexOf(t,r-a-1):-1;if(c>=0&&c+t.length+a>=e)return a+c;if(e==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}function wl(n,t,e,r,i){let s=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=e||u<=t?s.push(l):(c<t&&s.push(l.slice(0,t-c,r)),i&&(s.push(i),i=void 0),u>e&&s.push(l.slice(e-c,l.size,r)))}return s}function bc(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Lo(e)){for(l=o;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&B.isSelectable(f)&&i.parent&&!(f.isInline&&lM(e.focusNode,e.focusOffset,i.dom))){let h=i.posBefore;c=new B(o==h?a:r.resolve(h))}}else{if(e instanceof n.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let f=o,h=o;for(let d=0;d<e.rangeCount;d++){let p=e.getRangeAt(d);f=Math.min(f,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(f<0)return null;[l,o]=h==n.state.selection.anchor?[h,f]:[f,h],a=r.resolve(o)}else l=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let f=t=="pointer"||n.state.selection.head<a.pos&&!s?1:-1;c=xc(n,u,a,f)}return c}function Bm(n){return n.editable?n.hasFocus():zm(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function De(n,t=!1){let e=n.state.selection;if($m(n,e),!!Bm(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ot){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ln(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)BM(n);else{let{anchor:r,head:i}=e,s,o;mh&&!(e instanceof H)&&(e.$from.parent.inlineContent||(s=gh(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(o=gh(n,e.to))),n.docView.setSelection(r,i,n,t),mh&&(s&&yh(s),o&&yh(o)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&LM(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const mh=Pt||Ot&&Mm<63;function gh(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,s=r?e.childNodes[r-1]:null;if(Pt&&i&&i.contentEditable=="false")return Ia(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Ia(i);if(s)return Ia(s)}}function Ia(n){return n.contentEditable="true",Pt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function yh(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function LM(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Bm(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function BM(n){let t=n.domSelection();if(!t)return;let e=n.cursorWrapper.dom,r=e.nodeName=="IMG";r?t.collapse(e.parentNode,Ct(e)+1):t.collapse(e,0),!r&&!n.state.selection.visible&&Vt&&Xe<=11&&(e.disabled=!0,e.disabled=!1)}function $m(n,t){if(t instanceof B){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(bh(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else bh(n)}function bh(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function xc(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||H.between(t,e,r)}function xh(n){return n.editable&&!n.hasFocus()?!1:zm(n)}function zm(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function $M(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return Ln(t.node,t.offset,e.anchorNode,e.anchorOffset)}function Ml(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return s&&j.findFrom(s,t)}function $e(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function vh(n,t,e){let r=n.state.selection;if(r instanceof H)if(e.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(t<0?-1:1));return $e(n,new H(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(t>0?"forward":"backward")){let i=Ml(n.state,t);return i&&i instanceof B?$e(n,i):!1}else if(!(Yt&&e.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=t<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?B.isSelectable(s)?$e(n,new B(t<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Di?$e(n,new H(n.state.doc.resolve(t<0?a:a+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof B&&r.node.isInline)return $e(n,new H(t>0?r.$to:r.$from));{let i=Ml(n.state,t);return i?$e(n,i):!1}}}function $s(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Zr(n,t){let e=n.pmViewDesc;return e&&e.size==0&&(t<0||n.nextSibling||n.nodeName!="BR")}function qn(n,t){return t<0?zM(n):FM(n)}function zM(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,s,o=!1;for(Zt&&e.nodeType==1&&r<$s(e)&&Zr(e.childNodes[r],-1)&&(o=!0);;)if(r>0){if(e.nodeType!=1)break;{let a=e.childNodes[r-1];if(Zr(a,-1))i=e,s=--r;else if(a.nodeType==3)e=a,r=e.nodeValue.length;else break}}else{if(Fm(e))break;{let a=e.previousSibling;for(;a&&Zr(a,-1);)i=e.parentNode,s=Ct(a),a=a.previousSibling;if(a)e=a,r=$s(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}o?Cl(n,e,r):i&&Cl(n,i,s)}function FM(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=$s(e),s,o;for(;;)if(r<i){if(e.nodeType!=1)break;let a=e.childNodes[r];if(Zr(a,1))s=e,o=++r;else break}else{if(Fm(e))break;{let a=e.nextSibling;for(;a&&Zr(a,1);)s=a.parentNode,o=Ct(a)+1,a=a.nextSibling;if(a)e=a,r=0,i=$s(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}s&&Cl(n,s,o)}function Fm(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function HM(n,t){for(;n&&t==n.childNodes.length&&!Ai(n);)t=Ct(n)+1,n=n.parentNode;for(;n&&t<n.childNodes.length;){let e=n.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=0}}function VM(n,t){for(;n&&!t&&!Ai(n);)t=Ct(n),n=n.parentNode;for(;n&&t;){let e=n.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=n.childNodes.length}}function Cl(n,t,e){if(t.nodeType!=3){let s,o;(o=HM(t,e))?(t=o,e=0):(s=VM(t,e))&&(t=s,e=s.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Lo(r)){let s=document.createRange();s.setEnd(t,e),s.setStart(t,e),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&De(n)},50)}function kh(n,t){let e=n.state.doc.resolve(t);if(!(Ot||Cm)&&e.parent.inlineContent){let i=n.coordsAtPos(t);if(t>e.start()){let s=n.coordsAtPos(t-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(t<e.end()){let s=n.coordsAtPos(t+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Sh(n,t,e){let r=n.state.selection;if(r instanceof H&&!r.empty||e.indexOf("s")>-1||Yt&&e.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let o=Ml(n.state,t);if(o&&o instanceof B)return $e(n,o)}if(!i.parent.inlineContent){let o=t<0?i:s,a=r instanceof jt?j.near(o,t):j.findFrom(o,t);return a?$e(n,a):!1}return!1}function wh(n,t){if(!(n.state.selection instanceof H))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return t<0?o.delete(e.pos-s.nodeSize,e.pos):o.delete(e.pos,e.pos+s.nodeSize),n.dispatch(o),!0}return!1}function Mh(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function WM(n){if(!Pt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;Mh(n,r,"true"),setTimeout(()=>Mh(n,r,"false"),20)}return!1}function jM(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function UM(n,t){let e=t.keyCode,r=jM(t);if(e==8||Yt&&e==72&&r=="c")return wh(n,-1)||qn(n,-1);if(e==46&&!t.shiftKey||Yt&&e==68&&r=="c")return wh(n,1)||qn(n,1);if(e==13||e==27)return!0;if(e==37||Yt&&e==66&&r=="c"){let i=e==37?kh(n,n.state.selection.from)=="ltr"?-1:1:-1;return vh(n,i,r)||qn(n,i)}else if(e==39||Yt&&e==70&&r=="c"){let i=e==39?kh(n,n.state.selection.from)=="ltr"?1:-1:1;return vh(n,i,r)||qn(n,i)}else{if(e==38||Yt&&e==80&&r=="c")return Sh(n,-1,r)||qn(n,-1);if(e==40||Yt&&e==78&&r=="c")return WM(n)||Sh(n,1,r)||qn(n,1);if(r==(Yt?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function vc(n,t){n.someProp("transformCopied",d=>{t=d(t,n)});let e=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let d=r.firstChild;e.push(d.type.name,d.attrs!=d.type.defaultAttrs?d.attrs:null),r=d.content}let o=n.someProp("clipboardSerializer")||Hn.fromSchema(n.state.schema),a=Km(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=Um[c.nodeName.toLowerCase()]);){for(let d=u.length-1;d>=0;d--){let p=a.createElement(u[d]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${f?` -${f}`:""} ${JSON.stringify(e)}`);let h=n.someProp("clipboardTextSerializer",d=>d(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:l,text:h,slice:t}}function Hm(n,t,e,r,i){let s=i.parent.type.spec.code,o,a;if(!e&&!t)return null;let l=!!t&&(r||s||!e);if(l){if(n.someProp("transformPastedText",h=>{t=h(t,s||r,n)}),s)return a=new R(O.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",h=>{a=h(a,n,!0)}),a;let f=n.someProp("clipboardTextParser",h=>h(t,i,r,n));if(f)a=f;else{let h=i.marks(),{schema:d}=n.state,p=Hn.fromSchema(d);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(d.text(m,h)))})}}else n.someProp("transformPastedHTML",f=>{e=f(e,n)}),o=YM(e),Di&&GM(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Ge.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!KM.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=XM(Ch(a,+u[1],+u[2]),u[4]);else if(a=R.maxOpen(qM(a.content,i),!0),a.openStart||a.openEnd){let f=0,h=0;for(let d=a.content.firstChild;f<a.openStart&&!d.type.spec.isolating;f++,d=d.firstChild);for(let d=a.content.lastChild;h<a.openEnd&&!d.type.spec.isolating;h++,d=d.lastChild);a=Ch(a,f,h)}return n.someProp("transformPasted",f=>{a=f(a,n,l)}),a}const KM=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function qM(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let i=t.node(e).contentMatchAt(t.index(e)),s,o=[];if(n.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&Wm(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=jm(o[o.length-1],s.length));let u=Vm(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return O.from(o)}return n}function Vm(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,O.from(n));return n}function Wm(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let s=Wm(n,t,e,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(O.from(Vm(e,n,i+1))))}}function jm(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,jm(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(O.empty,!0);return n.copy(e.append(r))}function Tl(n,t,e,r,i,s){let o=t<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(s=0),i<r-1&&(a=Tl(a,t,e,r,i+1,s)),i>=e&&(a=t<0?o.contentMatchAt(0).fillBefore(a,s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(O.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,o.copy(a))}function Ch(n,t,e){return t<n.openStart&&(n=new R(Tl(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new R(Tl(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const Um={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Th=null;function Km(){return Th||(Th=document.implementation.createHTMLDocument("title"))}let Ra=null;function JM(n){let t=window.trustedTypes;return t?(Ra||(Ra=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),Ra.createHTML(n)):n}function YM(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=Km().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Um[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),e.innerHTML=JM(n),i)for(let s=0;s<i.length;s++)e=e.querySelector(i[s])||e;return e}function GM(n){let t=n.querySelectorAll(Ot?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function XM(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=e.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=O.from(l.create(r[a+1],i)),s++,o++}return new R(i,s,o)}const Rt={},Lt={},QM={touchstart:!0,touchmove:!0};class ZM{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function tC(n){for(let t in Rt){let e=Rt[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{nC(n,r)&&!kc(n,r)&&(n.editable||!(r.type in Lt))&&e(n,r)},QM[t]?{passive:!0}:void 0)}Pt&&n.dom.addEventListener("input",()=>null),Ol(n)}function Je(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function eC(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Ol(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>kc(n,r))})}function kc(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function nC(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function rC(n,t){!kc(n,t)&&Rt[t.type]&&(n.editable||!(t.type in Lt))&&Rt[t.type](n,t)}Lt.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!Jm(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Ee&&Ot&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),dr&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,bn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||UM(n,e)?e.preventDefault():Je(n,"key")};Lt.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)};Lt.keypress=(n,t)=>{let e=t;if(Jm(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||Yt&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof H)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode),s=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i,s))&&n.dispatch(s()),e.preventDefault()}};function $o(n){return{left:n.clientX,top:n.clientY}}function iC(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function Sc(n,t,e,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(t,a=>o>s.depth?a(n,e,s.nodeAfter,s.before(o),i,!0):a(n,e,s.node(o),s.before(o),i,!1)))return!0;return!1}function rr(n,t,e){if(n.focused||n.focus(),n.state.selection.eq(t))return;let r=n.state.tr.setSelection(t);r.setMeta("pointer",!0),n.dispatch(r)}function sC(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&B.isSelectable(r)?(rr(n,new B(e)),!0):!1}function oC(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof B&&(r=e.node);let s=n.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(B.isSelectable(a)){r&&e.$from.depth>0&&o>=e.$from.depth&&s.before(e.$from.depth+1)==e.$from.pos?i=s.before(e.$from.depth):i=s.before(o);break}}return i!=null?(rr(n,B.create(n.state.doc,i)),!0):!1}function aC(n,t,e,r,i){return Sc(n,"handleClickOn",t,e,r)||n.someProp("handleClick",s=>s(n,t,r))||(i?oC(n,e):sC(n,e))}function lC(n,t,e,r){return Sc(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function cC(n,t,e,r){return Sc(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||uC(n,e,r)}function uC(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(rr(n,H.create(r,0,r.content.size)),!0):!1;let i=r.resolve(t);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)rr(n,H.create(r,a+1,a+1+o.content.size));else if(B.isSelectable(o))rr(n,B.create(r,a));else continue;return!0}}function wc(n){return zs(n)}const qm=Yt?"metaKey":"ctrlKey";Rt.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=wc(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&iC(e,n.input.lastClick)&&!e[qm]&&n.input.lastClick.button==e.button&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:s,button:e.button};let o=n.posAtCoords($o(e));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new fC(n,o,e,!!r)):(s=="doubleClick"?lC:cC)(n,o.pos,o.inside,e)?e.preventDefault():Je(n,"pointer"))};class fC{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[qm],this.allowDefault=r.shiftKey;let s,o;if(e.inside>-1)s=t.state.doc.nodeAt(e.inside),o=e.inside;else{let u=t.state.doc.resolve(e.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=t.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof B&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Zt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Je(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>De(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords($o(t))),this.updateAllowDefault(t),this.allowDefault||!e?Je(this.view,"pointer"):aC(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Pt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ot&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(rr(this.view,j.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):Je(this.view,"pointer")}move(t){this.updateAllowDefault(t),Je(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Rt.touchstart=n=>{n.input.lastTouch=Date.now(),wc(n),Je(n,"pointer")};Rt.touchmove=n=>{n.input.lastTouch=Date.now(),Je(n,"pointer")};Rt.contextmenu=n=>wc(n);function Jm(n,t){return n.composing?!0:Pt&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const hC=Ee?5e3:-1;Lt.compositionstart=Lt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$to;if(t.selection instanceof H&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Ot&&Cm&&dC(n)))n.markCursor=n.state.storedMarks||e.marks(),zs(n,!0),n.markCursor=null;else if(zs(n,!t.selection.empty),Zt&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}Ym(n,hC)};function dC(n){let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(!t||t.nodeType!=1||e>=t.childNodes.length)return!1;let r=t.childNodes[e];return r.nodeType==1&&r.contentEditable=="false"}Lt.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.badSafariComposition?n.domObserver.forceFlush():n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Ym(n,20))};function Ym(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>zs(n),t))}function Gm(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=mC());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function pC(n){let t=n.domSelectionRange();if(!t.focusNode)return null;let e=oM(t.focusNode,t.focusOffset),r=aM(t.focusNode,t.focusOffset);if(e&&r&&e!=r){let i=r.pmViewDesc,s=n.domObserver.lastChangedTextNode;if(e==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=e.pmViewDesc;if(!(!o||!o.isText(e.nodeValue)))return r}}return e||r}function mC(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function zs(n,t=!1){if(!(Ee&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Gm(n),t||n.docView&&n.docView.dirty){let e=bc(n),r=n.state.selection;return e&&!e.eq(r)?n.dispatch(n.state.tr.setSelection(e)):(n.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function gC(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const xi=Vt&&Xe<15||dr&&fM<604;Rt.copy=Lt.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let s=xi?null:e.clipboardData,o=r.content(),{dom:a,text:l}=vc(n,o);s?(e.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):gC(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function yC(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function bC(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?vi(n,r.value,null,i,t):vi(n,r.textContent,r.innerHTML,i,t)},50)}function vi(n,t,e,r,i){let s=Hm(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,s||R.empty)))return!0;if(!s)return!1;let o=yC(s),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Xm(n){let t=n.getData("text/plain")||n.getData("Text");if(t)return t;let e=n.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}Lt.paste=(n,t)=>{let e=t;if(n.composing&&!Ee)return;let r=xi?null:e.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&vi(n,Xm(r),r.getData("text/html"),i,e)?e.preventDefault():bC(n,e)};class Qm{constructor(t,e,r){this.slice=t,this.move=e,this.node=r}}const xC=Yt?"altKey":"ctrlKey";function Zm(n,t){let e=n.someProp("dragCopies",r=>!r(t));return e??!t[xC]}Rt.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords($o(e)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof B?i.to-1:i.to))){if(r&&r.mightDrag)o=B.create(n.state.doc,r.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let f=n.docView.nearestDesc(e.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(o=B.create(n.state.doc,f.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=vc(n,a);(!e.dataTransfer.files.length||!Ot||Mm>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(xi?"Text":"text/html",l.innerHTML),e.dataTransfer.effectAllowed="copyMove",xi||e.dataTransfer.setData("text/plain",c),n.dragging=new Qm(u,Zm(n,e),o)};Rt.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)};Lt.dragover=Lt.dragenter=(n,t)=>t.preventDefault();Lt.drop=(n,t)=>{try{vC(n,t,n.dragging)}finally{n.dragging=null}};function vC(n,t,e){if(!t.dataTransfer)return;let r=n.posAtCoords($o(t));if(!r)return;let i=n.state.doc.resolve(r.pos),s=e&&e.slice;s?n.someProp("transformPasted",d=>{s=d(s,n,!1)}):s=Hm(n,Xm(t.dataTransfer),xi?null:t.dataTransfer.getData("text/html"),!1,i);let o=!!(e&&Zm(n,t));if(n.someProp("handleDrop",d=>d(n,t,s||R.empty,o))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?rm(n.state.doc,i.pos,s):i.pos;a==null&&(a=i.pos);let l=n.state.tr;if(o){let{node:d}=e;d?d.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,f=l.doc;if(u?l.replaceRangeWith(c,c,s.content.firstChild):l.replaceRange(c,c,s),l.doc.eq(f))return;let h=l.doc.resolve(c);if(u&&B.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new B(h));else{let d=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((p,m,g,y)=>d=y),l.setSelection(xc(n,h,l.doc.resolve(d)))}n.focus(),n.dispatch(l.setMeta("uiEvent","drop"))}Rt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&De(n)},20))};Rt.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Rt.beforeinput=(n,t)=>{if(Ot&&Ee&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,bn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Lt)Rt[n]=Lt[n];function ki(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class Fs{constructor(t,e){this.toDOM=t,this.spec=e||An,this.side=this.spec.side||0}map(t,e,r,i){let{pos:s,deleted:o}=t.mapResult(e.from+i,this.side<0?-1:1);return o?null:new It(s-r,s-r,this)}valid(){return!0}eq(t){return this==t||t instanceof Fs&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&ki(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Ze{constructor(t,e){this.attrs=t,this.spec=e||An}map(t,e,r,i){let s=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,o=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new It(s,o,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Ze&&ki(this.attrs,t.attrs)&&ki(this.spec,t.spec)}static is(t){return t.type instanceof Ze}destroy(){}}class Mc{constructor(t,e){this.attrs=t,this.spec=e||An}map(t,e,r,i){let s=t.mapResult(e.from+i,1);if(s.deleted)return null;let o=t.mapResult(e.to+i,-1);return o.deleted||o.pos<=s.pos?null:new It(s.pos-r,o.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),s;return i==e.from&&!(s=t.child(r)).isText&&i+s.nodeSize==e.to}eq(t){return this==t||t instanceof Mc&&ki(this.attrs,t.attrs)&&ki(this.spec,t.spec)}destroy(){}}class It{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new It(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new It(t,t,new Fs(e,r))}static inline(t,e,r,i){return new It(t,e,new Ze(r,i))}static node(t,e,r,i){return new It(t,e,new Mc(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ze}get widget(){return this.type instanceof Fs}}const Gn=[],An={};class st{constructor(t,e){this.local=t.length?t:Gn,this.children=e.length?e:Gn}static create(t,e){return e.length?Hs(e,t,0,An):Et}find(t,e,r){let i=[];return this.findInner(t??0,e??1e9,i,0,r),i}findInner(t,e,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=e&&a.to>=t&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<e&&this.children[o+1]>t){let a=this.children[o]+1;this.children[o+2].findInner(t-a,e-a,r,i+a,s)}}map(t,e,r){return this==Et||t.maps.length==0?this:this.mapInner(t,e,0,0,r||An)}mapInner(t,e,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,r,i);l&&l.type.valid(e,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?kC(this.children,o||[],t,e,r,i,s):o?new st(o.sort(Dn),Gn):Et}add(t,e){return e.length?this==Et?st.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,s=0;t.forEach((a,l)=>{let c=l+r,u;if(u=eg(e,a,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,Hs(u,a,c+1,An)),s+=3}});let o=tg(s?ng(e):e,-r);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||o.splice(a--,1);return new st(o.length?this.local.concat(o).sort(Dn):this.local,i||this.children)}remove(t){return t.length==0||this==Et?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+e,l=r[s+1]+e;for(let u=0,f;u<t.length;u++)(f=t[u])&&f.from>a&&f.to<l&&(t[u]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=Et?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<t.length;s++)if(o=t[s])for(let a=0;a<i.length;a++)i[a].eq(o,e)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new st(i,r):Et}forChild(t,e){if(this==Et)return this;if(e.isLeaf)return st.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(r=this.children[a+2]);break}let s=t+1,o=s+e.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Ze){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new st(i.sort(Dn),Gn);return r?new He([a,r]):a}return r||Et}eq(t){if(this==t)return!0;if(!(t instanceof st)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return Cc(this.localsInner(t))}localsInner(t){if(this==Et)return Gn;if(t.inlineContent||!this.local.some(Ze.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ze||e.push(this.local[r]);return e}forEachSet(t){t(this)}}st.empty=new st([],[]);st.removeOverlap=Cc;const Et=st.empty;class He{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,An));return He.from(r)}forChild(t,e){if(e.isLeaf)return st.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(t,e);s!=Et&&(s instanceof He?r=r.concat(s.members):r.push(s))}return He.from(r)}eq(t){if(!(t instanceof He)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(t);if(s.length)if(!e)e=s;else{r&&(e=e.slice(),r=!1);for(let o=0;o<s.length;o++)e.push(s[o])}}return e?Cc(r?e:e.sort(Dn)):Gn}static from(t){switch(t.length){case 0:return Et;case 1:return t[0];default:return new He(t.every(e=>e instanceof st)?t:t.reduce((e,r)=>e.concat(r instanceof st?r:r.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function kC(n,t,e,r,i,s,o){let a=n.slice();for(let c=0,u=s;c<e.maps.length;c++){let f=0;e.maps[c].forEach((h,d,p,m)=>{let g=m-p-(d-h);for(let y=0;y<a.length;y+=3){let b=a[y+1];if(b<0||h>b+u-f)continue;let v=a[y]+u-f;d>=v?a[y+1]=h<=v?-2:-1:h>=u&&g&&(a[y]+=g,a[y+1]+=g)}f+=g}),u=e.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=e.map(n[c]+s),f=u-i;if(f<0||f>=r.content.size){l=!0;continue}let h=e.map(n[c+1]+s,-1),d=h-i,{index:p,offset:m}=r.content.findIndex(f),g=r.maybeChild(p);if(g&&m==f&&m+g.nodeSize==d){let y=a[c+2].mapInner(e,g,u+1,n[c]+s+1,o);y!=Et?(a[c]=f,a[c+1]=d,a[c+2]=y):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=SC(a,n,t,e,i,s,o),u=Hs(c,r,0,o);t=u.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,h=0;f<u.children.length;f+=3){let d=u.children[f];for(;h<a.length&&a[h]<d;)h+=3;a.splice(h,0,u.children[f],u.children[f+1],u.children[f+2])}}return new st(t.sort(Dn),a)}function tg(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new It(i.from+t,i.to+t,i.type))}return e}function SC(n,t,e,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let f=l.local[u].map(r,i,c);f?e.push(f):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],t[l]+s+1);return e}function eg(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>e&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function ng(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function Hs(n,t,e,r){let i=[],s=!1;t.forEach((a,l)=>{let c=eg(n,a,l+e);if(c){s=!0;let u=Hs(c,a,e+l+1,r);u!=Et&&i.push(l,l+a.nodeSize,u)}});let o=tg(s?ng(n):n,-e).sort(Dn);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new st(o,i):Et}function Dn(n,t){return n.from-t.from||n.to-t.to}function Cc(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let s=t[i];if(s.from==r.from){s.to!=r.to&&(t==n&&(t=n.slice()),t[i]=s.copy(s.from,r.to),Oh(t,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,s.from),Oh(t,i,r.copy(s.from,r.to)));break}}}return t}function Oh(n,t,e){for(;t<n.length&&Dn(e,n[t])>0;)t++;n.splice(t,0,e)}function La(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=Et&&t.push(r)}),n.cursorWrapper&&t.push(st.create(n.state.doc,[n.cursorWrapper.deco])),He.from(t)}const wC={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},MC=Vt&&Xe<=11;class CC{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class TC{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new CC,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Vt&&Xe<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Pt&&t.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),MC&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,wC)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(xh(this.view)){if(this.suppressingSelectionUpdates)return De(this.view);if(Vt&&Xe<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Ln(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let s=t.focusNode;s;s=hr(s))e.add(s);for(let s=t.anchorNode;s;s=hr(s))if(e.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&xh(t)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(t.editable)for(let u=0;u<e.length;u++){let f=this.registerMutation(e[u],l);f&&(s=s<0?f.from:Math.min(f.from,s),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(a=!0))}if(l.some(u=>u.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let u of l)if(u.nodeName=="BR"&&u.parentNode){let f=u.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&u.parentNode.removeChild(u)}}else if(Zt&&l.length){let u=l.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,h]=u;f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let h of u){let d=h.parentNode;d&&d.nodeName=="LI"&&(!f||EC(t,f)!=d)&&h.remove()}}}let c=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Lo(r)&&(c=bc(t))&&c.eq(j.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,De(t),this.currentSelection.set(r),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,o),OC(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,AC(t,l)),this.handleDOMChange(s,o,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||De(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let u=0;u<t.addedNodes.length;u++){let f=t.addedNodes[u];e.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,s=t.nextSibling;if(Vt&&Xe<=11&&t.addedNodes.length)for(let u=0;u<t.addedNodes.length;u++){let{previousSibling:f,nextSibling:h}=t.addedNodes[u];(!f||Array.prototype.indexOf.call(t.addedNodes,f)<0)&&(i=f),(!h||Array.prototype.indexOf.call(t.addedNodes,h)<0)&&(s=h)}let o=i&&i.parentNode==t.target?Ct(i)+1:0,a=r.localPosFromDOM(t.target,o,-1),l=s&&s.parentNode==t.target?Ct(s):t.target.childNodes.length,c=r.localPosFromDOM(t.target,l,1);return{from:a,to:c}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let _h=new WeakMap,Eh=!1;function OC(n){if(!_h.has(n)&&(_h.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Zt,Eh)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Eh=!0}}function Ah(n,t){let e=t.startContainer,r=t.startOffset,i=t.endContainer,s=t.endOffset,o=n.domAtPos(n.state.selection.anchor);return Ln(o.node,o.offset,i,s)&&([e,r,i,s]=[i,s,e,r]),{anchorNode:e,anchorOffset:r,focusNode:i,focusOffset:s}}function _C(n,t){if(t.getComposedRanges){let i=t.getComposedRanges(n.root)[0];if(i)return Ah(n,i)}let e;function r(i){i.preventDefault(),i.stopImmediatePropagation(),e=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),e?Ah(n,e):null}function EC(n,t){for(let e=t.parentNode;e&&e!=n.dom;e=e.parentNode){let r=n.docView.nearestDesc(e,!0);if(r&&r.node.isBlock)return e}return null}function AC(n,t){var e;let{focusNode:r,focusOffset:i}=n.domSelectionRange();for(let s of t)if(((e=s.parentNode)===null||e===void 0?void 0:e.nodeName)=="TR"){let o=s.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let a=o;for(;;){let l=a.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;a=l}a.insertBefore(s,a.firstChild),r==s&&n.domSelection().collapse(s,i)}else s.parentNode.removeChild(s)}}function DC(n,t,e){let{node:r,fromOffset:i,toOffset:s,from:o,to:a}=n.docView.parseRange(t,e),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Lo(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Ot&&n.input.lastKeyCode===8)for(let g=s;g>i;g--){let y=r.childNodes[g-1],b=y.pmViewDesc;if(y.nodeName=="BR"&&!b){s=g;break}if(!b||b.size)break}let f=n.state.doc,h=n.someProp("domParser")||Ge.fromSchema(n.state.schema),d=f.resolve(o),p=null,m=h.parse(r,{topNode:d.parent,topMatch:d.parent.contentMatchAt(d.index()),topOpen:!0,from:i,to:s,preserveWhitespace:d.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:PC,context:d});if(c&&c[0].pos!=null){let g=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=g),p={anchor:g+o,head:y+o}}return{doc:m,sel:p,from:o,to:a}}function PC(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Pt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||Pt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const NC=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function IC(n,t,e,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,t<0){let S=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,M=bc(n,S);if(M&&!n.state.selection.eq(M)){if(Ot&&Ee&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",I=>I(n,bn(13,"Enter"))))return;let E=n.state.tr.setSelection(M);S=="pointer"?E.setMeta("pointer",!0):S=="key"&&E.scrollIntoView(),s&&E.setMeta("composition",s),n.dispatch(E)}return}let o=n.state.doc.resolve(t),a=o.sharedDepth(e);t=o.before(a+1),e=n.state.doc.resolve(e).after(a+1);let l=n.state.selection,c=DC(n,t,e),u=n.state.doc,f=u.slice(c.from,c.to),h,d;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,d="end"):(h=n.state.selection.from,d="start"),n.input.lastKeyCode=null;let p=BC(f.content,c.doc.content,c.from,h,d);if(p&&n.input.domChangeCount++,(dr&&n.input.lastIOSEnter>Date.now()-225||Ee)&&i.some(S=>S.nodeType==1&&!NC.test(S.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",S=>S(n,bn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof H&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let S=Dh(n,n.state.doc,c.sel);if(S&&!S.eq(n.state.selection)){let M=n.state.tr.setSelection(S);s&&M.setMeta("composition",s),n.dispatch(M)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof H&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Vt&&Xe<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),y=u.resolve(p.start),b=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=p.endA;if((dr&&n.input.lastIOSEnter>Date.now()-225&&(!b||i.some(S=>S.nodeName=="DIV"||S.nodeName=="P"))||!b&&m.pos<c.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(c.doc.textBetween(m.pos,g.pos,"","")))&&n.someProp("handleKeyDown",S=>S(n,bn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&LC(u,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",S=>S(n,bn(8,"Backspace")))){Ee&&Ot&&n.domObserver.suppressSelectionUpdates();return}Ot&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),Ee&&!b&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(S){return S(n,bn(13,"Enter"))})},20));let v=p.start,k=p.endA,x=S=>{let M=S||n.state.tr.replace(v,k,c.doc.slice(p.start-c.from,p.endB-c.from));if(c.sel){let E=Dh(n,M.doc,c.sel);E&&!(Ot&&n.composing&&E.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(E.head==v||E.head==M.mapping.map(k)-1)||Vt&&E.empty&&E.head==v)&&M.setSelection(E)}return s&&M.setMeta("composition",s),M.scrollIntoView()},w;if(b)if(m.pos==g.pos){Vt&&Xe<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>De(n),20));let S=x(n.state.tr.delete(v,k)),M=u.resolve(p.start).marksAcross(u.resolve(p.endA));M&&S.ensureMarks(M),n.dispatch(S)}else if(p.endA==p.endB&&(w=RC(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,p.endA-y.start())))){let S=x(n.state.tr);w.type=="add"?S.addMark(v,k,w.mark):S.removeMark(v,k,w.mark),n.dispatch(S)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let S=m.parent.textBetween(m.parentOffset,g.parentOffset),M=()=>x(n.state.tr.insertText(S,v,k));n.someProp("handleTextInput",E=>E(n,v,k,S,M))||n.dispatch(M())}else n.dispatch(x());else n.dispatch(x())}function Dh(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:xc(n,t.resolve(e.anchor),t.resolve(e.head))}function RC(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,s=r,o,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<e.length;u++)s=e[u].removeFromSet(s);if(i.length==1&&s.length==0)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&s.length==1)a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<t.childCount;u++)c.push(l(t.child(u)));if(O.from(c).eq(n))return{mark:a,type:o}}function LC(n,t,e,r,i){if(e-t<=i.pos-r.pos||Ba(r,!0,!1)<i.pos)return!1;let s=n.resolve(t);if(!r.parent.isTextblock){let a=s.nodeAfter;return a!=null&&e==t+a.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(Ba(s,!0,!0));return!o.parent.isTextblock||o.pos>e||Ba(o,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Ba(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function BC(n,t,e,r,i){let s=n.findDiffStart(t,e);if(s==null)return null;let{a:o,b:a}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}if(o<s&&n.size<t.size){let l=r<=s&&r>=o?s-r:0;s-=l,s&&s<t.size&&Ph(t.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-o),o=s}else if(a<s){let l=r<=s&&r>=a?s-r:0;s-=l,s&&s<n.size&&Ph(n.textBetween(s-1,s+1))&&(s+=l?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}function Ph(n){if(n.length!=2)return!1;let t=n.charCodeAt(0),e=n.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class rg{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new ZM,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Bh),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Rh(this),Ih(this),this.nodeViews=Lh(this),this.docView=dh(this.state.doc,Nh(this),La(this),this.dom,this),this.domObserver=new TC(this,(r,i,s,o)=>IC(this,r,i,s,o)),this.domObserver.start(),tC(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Ol(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Bh),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var r;let i=this.state,s=!1,o=!1;t.storedMarks&&this.composing&&(Gm(this),o=!0),this.state=t;let a=i.plugins!=t.plugins||this._props.plugins!=e.plugins;if(a||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let d=Lh(this);zC(d,this.nodeViews)&&(this.nodeViews=d,s=!0)}(a||e.handleDOMEvents!=this._props.handleDOMEvents)&&Ol(this),this.editable=Rh(this),Ih(this);let l=La(this),c=Nh(this),u=i.plugins!=t.plugins&&!i.doc.eq(t.doc)?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(t.doc,c,l);(f||!t.selection.eq(i.selection))&&(o=!0);let h=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&pM(this);if(o){this.domObserver.stop();let d=f&&(Vt||Ot)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&$C(i.selection,t.selection);if(f){let p=Ot?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=pC(this)),(s||!this.docView.update(t.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=dh(t.doc,c,l,this.dom,this)),p&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(d=!0)}d||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&$M(this))?De(this,d):($m(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&mM(h)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof B){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&ah(this,e.getBoundingClientRect(),t)}else ah(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}updateDraggedNode(t,e){let r=t.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-e.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new Qm(t.slice,t.move,i<0?void 0:B.create(this.state.doc,i))}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[t];if(a!=null&&(i=e?e(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[t];if(a!=null&&(i=e?e(a):a))return i}}hasFocus(){if(Vt){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&gM(this.dom),De(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return kM(this,t)}coordsAtPos(t,e=1){return Am(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return TM(this,e||this.state,t)}pasteHTML(t,e){return vi(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return vi(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return vc(this,t)}destroy(){this.docView&&(eC(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],La(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,iM())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return rC(this,t)}domSelectionRange(){let t=this.domSelection();return t?Pt&&this.root.nodeType===11&&cM(this.dom.ownerDocument)==this.dom&&_C(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}rg.prototype.dispatch=function(n){let t=this._props.dispatchTransaction;t?t.call(this,n):this.updateState(this.state.apply(n))};function Nh(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"?t.class+=" "+e[r]:r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),t.translate||(t.translate="no"),[It.node(0,n.state.doc.content.size,t)]}function Ih(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:It.widget(n.state.selection.from,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Rh(n){return!n.someProp("editable",t=>t(n.state)===!1)}function $C(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function Lh(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function zC(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function Bh(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var nn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Vs={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},FC=typeof navigator<"u"&&/Mac/.test(navigator.platform),HC=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Tt=0;Tt<10;Tt++)nn[48+Tt]=nn[96+Tt]=String(Tt);for(var Tt=1;Tt<=24;Tt++)nn[Tt+111]="F"+Tt;for(var Tt=65;Tt<=90;Tt++)nn[Tt]=String.fromCharCode(Tt+32),Vs[Tt]=String.fromCharCode(Tt);for(var $a in nn)Vs.hasOwnProperty($a)||(Vs[$a]=nn[$a]);function VC(n){var t=FC&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||HC&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?Vs:nn)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const WC=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),jC=typeof navigator<"u"&&/Win/.test(navigator.platform);function UC(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,s,o;for(let a=0;a<t.length-1;a++){let l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))WC?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Meta-"+e),s&&(e="Shift-"+e),e}function KC(n){let t=Object.create(null);for(let e in n)t[UC(e)]=n[e];return t}function za(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function qC(n){return new ot({props:{handleKeyDown:ig(n)}})}function ig(n){let t=KC(n);return function(e,r){let i=VC(r),s,o=t[za(i,r)];if(o&&o(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=t[za(i,r,!1)];if(a&&a(e.state,e.dispatch,e))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(jC&&r.ctrlKey&&r.altKey)&&(s=nn[r.keyCode])&&s!=i){let a=t[za(s,r)];if(a&&a(e.state,e.dispatch,e))return!0}}return!1}}var JC=Object.defineProperty,Tc=(n,t)=>{for(var e in t)JC(n,e,{get:t[e],enumerable:!0})};function zo(n){const{state:t,transaction:e}=n;let{selection:r}=e,{doc:i}=e,{storedMarks:s}=e;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=e.selection,i=e.doc,s=e.storedMarks,e}}}var Fo=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:t,state:e}=this,{view:r}=t,{tr:i}=e,s=this.buildProps(i);return Object.fromEntries(Object.entries(n).map(([o,a])=>[o,(...c)=>{const u=a(...c)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o=[],a=!!n,l=n||i.tr,c=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),o.every(f=>f===!0)),u={...Object.fromEntries(Object.entries(e).map(([f,h])=>[f,(...p)=>{const m=this.buildProps(l,t),g=h(...p)(m);return o.push(g),u}])),run:c};return u}createCan(n){const{rawCommands:t,state:e}=this,r=!1,i=n||e.tr,s=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o={tr:n,editor:r,view:s,state:zo({state:i,transaction:n}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(n,t),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...c)=>l(...c)(o)]))}};return o}},sg={};Tc(sg,{blur:()=>YC,clearContent:()=>GC,clearNodes:()=>XC,command:()=>QC,createParagraphNear:()=>ZC,cut:()=>tT,deleteCurrentNode:()=>eT,deleteNode:()=>nT,deleteRange:()=>rT,deleteSelection:()=>iT,enter:()=>sT,exitCode:()=>oT,extendMarkRange:()=>aT,first:()=>lT,focus:()=>uT,forEach:()=>fT,insertContent:()=>hT,insertContentAt:()=>mT,joinBackward:()=>bT,joinDown:()=>yT,joinForward:()=>xT,joinItemBackward:()=>vT,joinItemForward:()=>kT,joinTextblockBackward:()=>ST,joinTextblockForward:()=>wT,joinUp:()=>gT,keyboardShortcut:()=>CT,lift:()=>TT,liftEmptyBlock:()=>OT,liftListItem:()=>_T,newlineInCode:()=>ET,resetAttributes:()=>AT,scrollIntoView:()=>DT,selectAll:()=>PT,selectNodeBackward:()=>NT,selectNodeForward:()=>IT,selectParentNode:()=>RT,selectTextblockEnd:()=>LT,selectTextblockStart:()=>BT,setContent:()=>$T,setMark:()=>iO,setMeta:()=>sO,setNode:()=>oO,setNodeSelection:()=>aO,setTextDirection:()=>lO,setTextSelection:()=>cO,sinkListItem:()=>uO,splitBlock:()=>fO,splitListItem:()=>hO,toggleList:()=>dO,toggleMark:()=>pO,toggleNode:()=>mO,toggleWrap:()=>gO,undoInputRule:()=>yO,unsetAllMarks:()=>bO,unsetMark:()=>xO,unsetTextDirection:()=>vO,updateAttributes:()=>kO,wrapIn:()=>SO,wrapInList:()=>wO});var YC=()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),(e=window==null?void 0:window.getSelection())==null||e.removeAllRanges())}),!0),GC=(n=!0)=>({commands:t})=>t.setContent("",{emitUpdate:n}),XC=()=>({state:n,tr:t,dispatch:e})=>{const{selection:r}=t,{ranges:i}=r;return e&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=t,f=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),d=f.blockRange(h);if(!d)return;const p=vr(d);if(a.type.isTextblock){const{defaultType:m}=f.parent.contentMatchAt(f.index());t.setNodeMarkup(d.start,m)}(p||p===0)&&t.lift(d,p)})}),!0},QC=n=>t=>n(t),ZC=()=>({state:n,dispatch:t})=>xm(n,t),tT=(n,t)=>({editor:e,tr:r})=>{const{state:i}=e,s=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(t);return r.insert(o,s.content),r.setSelection(new H(r.doc.resolve(Math.max(o-1,0)))),!0},eT=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,r=e.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(t){const a=i.before(s),l=i.after(s);n.delete(a,l).scrollIntoView()}return!0}return!1};function dt(n,t){if(typeof n=="string"){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}var nT=n=>({tr:t,state:e,dispatch:r})=>{const i=dt(n,e.schema),s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const l=s.before(o),c=s.after(o);t.delete(l,c).scrollIntoView()}return!0}return!1},rT=n=>({tr:t,dispatch:e})=>{const{from:r,to:i}=n;return e&&t.delete(r,i),!0},iT=()=>({state:n,dispatch:t})=>hc(n,t),sT=()=>({commands:n})=>n.keyboardShortcut("Enter"),oT=()=>({state:n,dispatch:t})=>Ww(n,t);function Oc(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function Ws(n,t,e={strict:!0}){const r=Object.keys(t);return r.length?r.every(i=>e.strict?t[i]===n[i]:Oc(t[i])?t[i].test(n[i]):t[i]===n[i]):!0}function og(n,t,e={}){return n.find(r=>r.type===t&&Ws(Object.fromEntries(Object.keys(e).map(i=>[i,r.attrs[i]])),e))}function $h(n,t,e={}){return!!og(n,t,e)}function _c(n,t,e){var r;if(!n||!t)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===t))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===t)||(e=e||((r=i.node.marks[0])==null?void 0:r.attrs),!og([...i.node.marks],t,e)))return;let o=i.index,a=n.start()+i.offset,l=o+1,c=a+i.node.nodeSize;for(;o>0&&$h([...n.parent.child(o-1).marks],t,e);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&$h([...n.parent.child(l).marks],t,e);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Ie(n,t){if(typeof n=="string"){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}var aT=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const s=Ie(n,r.schema),{doc:o,selection:a}=e,{$from:l,from:c,to:u}=a;if(i){const f=_c(l,s,t);if(f&&f.from<=c&&f.to>=u){const h=H.create(o,f.from,f.to);e.setSelection(h)}}return!0},lT=n=>t=>{const e=typeof n=="function"?n(t):n;for(let r=0;r<e.length;r+=1)if(e[r](t))return!0;return!1};function ag(n){return n instanceof H}function Mn(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function lg(n,t=null){if(!t)return null;const e=j.atStart(n),r=j.atEnd(n);if(t==="start"||t===!0)return e;if(t==="end")return r;const i=e.from,s=r.to;return t==="all"?H.create(n,Mn(0,i,s),Mn(n.content.size,i,s)):H.create(n,Mn(t,i,s),Mn(t,i,s))}function zh(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function js(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function cT(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var uT=(n=null,t={})=>({editor:e,view:r,tr:i,dispatch:s})=>{t={scrollIntoView:!0,...t};const o=()=>{(js()||zh())&&r.dom.focus(),cT()&&!js()&&!zh()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{e.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&e.commands.scrollIntoView())})};try{if(r.hasFocus()&&n===null||n===!1)return!0}catch{return!1}if(s&&n===null&&!ag(e.state.selection))return o(),!0;const a=lg(i.doc,n)||e.state.selection,l=e.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},fT=(n,t)=>e=>n.every((r,i)=>t(r,{...e,index:i})),hT=(n,t)=>({tr:e,commands:r})=>r.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),cg=n=>{const t=n.childNodes;for(let e=t.length-1;e>=0;e-=1){const r=t[e];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&cg(r)}return n};function Zi(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${n}</body>`,e=new window.DOMParser().parseFromString(t,"text/html").body;return cg(e)}function Si(n,t,e){if(n instanceof oe||n instanceof O)return n;e={slice:!0,parseOptions:{},...e};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return O.fromArray(n.map(a=>t.nodeFromJSON(a)));const o=t.nodeFromJSON(n);return e.errorOnInvalidContent&&o.check(),o}catch(s){if(e.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",s),Si("",t,e)}if(i){if(e.errorOnInvalidContent){let o=!1,a="";const l=new Kp({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(e.slice?Ge.fromSchema(l).parseSlice(Zi(n),e.parseOptions):Ge.fromSchema(l).parse(Zi(n),e.parseOptions),e.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const s=Ge.fromSchema(t);return e.slice?s.parseSlice(Zi(n),e.parseOptions).content:s.parse(Zi(n),e.parseOptions)}return Si("",t,e)}function dT(n,t,e){const r=n.steps.length-1;if(r<t)return;const i=n.steps[r];if(!(i instanceof vt||i instanceof St))return;const s=n.mapping.maps[r];let o=0;s.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(j.near(n.doc.resolve(o),e))}var pT=n=>!("type"in n),mT=(n,t,e)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){e={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...e};let a;const l=g=>{s.emit("contentError",{editor:s,error:g,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...e.parseOptions};if(!e.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Si(t,s.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(g){l(g)}try{a=Si(t,s.schema,{parseOptions:c,errorOnInvalidContent:(o=e.errorOnInvalidContent)!=null?o:s.options.enableContentCheck})}catch(g){return l(g),!1}let{from:u,to:f}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},h=!0,d=!0;if((pT(a)?a:[a]).forEach(g=>{g.check(),h=h?g.isText&&g.marks.length===0:!1,d=d?g.isBlock:!1}),u===f&&d){const{parent:g}=r.doc.resolve(u);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(u-=1,f+=1)}let m;if(h){if(Array.isArray(t))m=t.map(g=>g.text||"").join("");else if(t instanceof O){let g="";t.forEach(y=>{y.text&&(g+=y.text)}),m=g}else typeof t=="object"&&t&&t.text?m=t.text:m=t;r.insertText(m,u,f)}else{m=a;const g=r.doc.resolve(u),y=g.node(),b=g.parentOffset===0,v=y.isText||y.isTextblock,k=y.content.size>0;b&&v&&k&&(u=Math.max(0,u-1)),r.replaceWith(u,f,m)}e.updateSelection&&dT(r,r.steps.length-1,-1),e.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:m}),e.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:m})}return!0},gT=()=>({state:n,dispatch:t})=>Fw(n,t),yT=()=>({state:n,dispatch:t})=>Hw(n,t),bT=()=>({state:n,dispatch:t})=>hm(n,t),xT=()=>({state:n,dispatch:t})=>gm(n,t),vT=()=>({state:n,dispatch:t,tr:e})=>{try{const r=No(n.doc,n.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},kT=()=>({state:n,dispatch:t,tr:e})=>{try{const r=No(n.doc,n.selection.$from.pos,1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},ST=()=>({state:n,dispatch:t})=>$w(n,t),wT=()=>({state:n,dispatch:t})=>zw(n,t);function ug(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function MT(n){const t=n.split(/-(?!$)/);let e=t[t.length-1];e==="Space"&&(e=" ");let r,i,s,o;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))js()||ug()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),o&&(e=`Meta-${e}`),s&&(e=`Shift-${e}`),e}var CT=n=>({editor:t,view:e,tr:r,dispatch:i})=>{const s=MT(n).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{e.someProp("handleKeyDown",c=>c(e,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function rn(n,t,e={}){const{from:r,to:i,empty:s}=n.selection,o=t?dt(t,n.schema):null,a=[];n.doc.nodesBetween(r,i,(f,h)=>{if(f.isText)return;const d=Math.max(r,h),p=Math.min(i,h+f.nodeSize);a.push({node:f,from:d,to:p})});const l=i-r,c=a.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>Ws(f.node.attrs,e,{strict:!1}));return s?!!c.length:c.reduce((f,h)=>f+h.to-h.from,0)>=l}var TT=(n,t={})=>({state:e,dispatch:r})=>{const i=dt(n,e.schema);return rn(e,i,t)?Vw(e,r):!1},OT=()=>({state:n,dispatch:t})=>vm(n,t),_T=n=>({state:t,dispatch:e})=>{const r=dt(n,t.schema);return tM(r)(t,e)},ET=()=>({state:n,dispatch:t})=>bm(n,t);function Ho(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function Fh(n,t){const e=typeof t=="string"?[t]:t;return Object.keys(n).reduce((r,i)=>(e.includes(i)||(r[i]=n[i]),r),{})}var AT=(n,t)=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const a=Ho(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(s=dt(n,r.schema)),a==="mark"&&(o=Ie(n,r.schema));let l=!1;return e.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(u,f)=>{s&&s===u.type&&(l=!0,i&&e.setNodeMarkup(f,void 0,Fh(u.attrs,t))),o&&u.marks.length&&u.marks.forEach(h=>{o===h.type&&(l=!0,i&&e.addMark(f,f+u.nodeSize,o.create(Fh(h.attrs,t))))})})}),l},DT=()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),PT=()=>({tr:n,dispatch:t})=>{if(t){const e=new jt(n.doc);n.setSelection(e)}return!0},NT=()=>({state:n,dispatch:t})=>pm(n,t),IT=()=>({state:n,dispatch:t})=>ym(n,t),RT=()=>({state:n,dispatch:t})=>Kw(n,t),LT=()=>({state:n,dispatch:t})=>Yw(n,t),BT=()=>({state:n,dispatch:t})=>Jw(n,t);function _l(n,t,e={},r={}){return Si(n,t,{slice:!1,parseOptions:e,errorOnInvalidContent:r.errorOnInvalidContent})}var $T=(n,{errorOnInvalidContent:t,emitUpdate:e=!0,parseOptions:r={}}={})=>({editor:i,tr:s,dispatch:o,commands:a})=>{const{doc:l}=s;if(r.preserveWhitespace!=="full"){const c=_l(n,i.schema,r,{errorOnInvalidContent:t??i.options.enableContentCheck});return o&&s.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:l.content.size},n,{parseOptions:r,errorOnInvalidContent:t??i.options.enableContentCheck})};function fg(n,t){const e=Ie(t,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===e.name);return a?{...a.attrs}:{}}function hg(n,t){const e=new lm(n);return t.forEach(r=>{r.steps.forEach(i=>{e.step(i)})}),e}function zT(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function FT(n,t,e){const r=[];return n.nodesBetween(t.from,t.to,(i,s)=>{e(i)&&r.push({node:i,pos:s})}),r}function HT(n,t){for(let e=n.depth;e>0;e-=1){const r=n.node(e);if(t(r))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:r}}}function Vo(n){return t=>HT(t.$from,n)}function L(n,t,e){return n.config[t]===void 0&&n.parent?L(n.parent,t,e):typeof n.config[t]=="function"?n.config[t].bind({...e,parent:n.parent?L(n.parent,t,e):null}):n.config[t]}function Ec(n){return n.map(t=>{const e={name:t.name,options:t.options,storage:t.storage},r=L(t,"addExtensions",e);return r?[t,...Ec(r())]:t}).flat(10)}function Ac(n,t){const e=Hn.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function dg(n){return typeof n=="function"}function G(n,t=void 0,...e){return dg(n)?t?n.bind(t)(...e):n(...e):n}function VT(n={}){return Object.keys(n).length===0&&n.constructor===Object}function pr(n){const t=n.filter(i=>i.type==="extension"),e=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:t,nodeExtensions:e,markExtensions:r}}function pg(n){const t=[],{nodeExtensions:e,markExtensions:r}=pr(n),i=[...e,...r],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1},o=e.filter(c=>c.name!=="text").map(c=>c.name),a=r.map(c=>c.name),l=[...o,...a];return n.forEach(c=>{const u={name:c.name,options:c.options,storage:c.storage,extensions:i},f=L(c,"addGlobalAttributes",u);if(!f)return;f().forEach(d=>{let p;Array.isArray(d.types)?p=d.types:d.types==="*"?p=l:d.types==="nodes"?p=o:d.types==="marks"?p=a:p=[],p.forEach(m=>{Object.entries(d.attributes).forEach(([g,y])=>{t.push({type:m,name:g,attribute:{...s,...y}})})})})}),i.forEach(c=>{const u={name:c.name,options:c.options,storage:c.storage},f=L(c,"addAttributes",u);if(!f)return;const h=f();Object.entries(h).forEach(([d,p])=>{const m={...s,...p};typeof(m==null?void 0:m.default)=="function"&&(m.default=m.default()),m!=null&&m.isRequired&&(m==null?void 0:m.default)===void 0&&delete m.default,t.push({type:c.name,name:d,attribute:m})})}),t}function pt(...n){return n.filter(t=>!!t).reduce((t,e)=>{const r={...t};return Object.entries(e).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const a=s?String(s).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=s?s.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[f,h]=u.split(":").map(d=>d.trim());c.set(f,h)}),a.forEach(u=>{const[f,h]=u.split(":").map(d=>d.trim());c.set(f,h)}),r[i]=Array.from(c.entries()).map(([u,f])=>`${u}: ${f}`).join("; ")}else r[i]=s}),r},{})}function wi(n,t){return t.filter(e=>e.type===n.type.name).filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,r)=>pt(e,r),{})}function WT(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function Hh(n,t){return"style"in n?n:{...n,getAttrs:e=>{const r=n.getAttrs?n.getAttrs(e):n.attrs;if(r===!1)return!1;const i=t.reduce((s,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(e):WT(e.getAttribute(o.name));return a==null?s:{...s,[o.name]:a}},{});return{...r,...i}}}}function Vh(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>t==="attrs"&&VT(e)?!1:e!=null))}function Wh(n){var t,e;const r={};return!((t=n==null?void 0:n.attribute)!=null&&t.isRequired)&&"default"in((n==null?void 0:n.attribute)||{})&&(r.default=n.attribute.default),((e=n==null?void 0:n.attribute)==null?void 0:e.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function jT(n,t){var e;const r=pg(n),{nodeExtensions:i,markExtensions:s}=pr(n),o=(e=i.find(c=>L(c,"topNode")))==null?void 0:e.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(y=>y.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:t},h=n.reduce((y,b)=>{const v=L(b,"extendNodeSchema",f);return{...y,...v?v(c):{}}},{}),d=Vh({...h,content:G(L(c,"content",f)),marks:G(L(c,"marks",f)),group:G(L(c,"group",f)),inline:G(L(c,"inline",f)),atom:G(L(c,"atom",f)),selectable:G(L(c,"selectable",f)),draggable:G(L(c,"draggable",f)),code:G(L(c,"code",f)),whitespace:G(L(c,"whitespace",f)),linebreakReplacement:G(L(c,"linebreakReplacement",f)),defining:G(L(c,"defining",f)),isolating:G(L(c,"isolating",f)),attrs:Object.fromEntries(u.map(Wh))}),p=G(L(c,"parseHTML",f));p&&(d.parseDOM=p.map(y=>Hh(y,u)));const m=L(c,"renderHTML",f);m&&(d.toDOM=y=>m({node:y,HTMLAttributes:wi(y,u)}));const g=L(c,"renderText",f);return g&&(d.toText=g),[c.name,d]})),l=Object.fromEntries(s.map(c=>{const u=r.filter(g=>g.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:t},h=n.reduce((g,y)=>{const b=L(y,"extendMarkSchema",f);return{...g,...b?b(c):{}}},{}),d=Vh({...h,inclusive:G(L(c,"inclusive",f)),excludes:G(L(c,"excludes",f)),group:G(L(c,"group",f)),spanning:G(L(c,"spanning",f)),code:G(L(c,"code",f)),attrs:Object.fromEntries(u.map(Wh))}),p=G(L(c,"parseHTML",f));p&&(d.parseDOM=p.map(g=>Hh(g,u)));const m=L(c,"renderHTML",f);return m&&(d.toDOM=g=>m({mark:g,HTMLAttributes:wi(g,u)})),[c.name,d]}));return new Kp({topNode:o,nodes:a,marks:l})}function UT(n){const t=n.filter((e,r)=>n.indexOf(e)!==r);return Array.from(new Set(t))}function ti(n){return n.sort((e,r)=>{const i=L(e,"priority")||100,s=L(r,"priority")||100;return i>s?-1:i<s?1:0})}function mg(n){const t=ti(Ec(n)),e=UT(t.map(r=>r.name));return e.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${e.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}function gg(n,t,e){const{from:r,to:i}=t,{blockSeparator:s=`

`,textSerializers:o={}}=e||{};let a="";return n.nodesBetween(r,i,(l,c,u,f)=>{var h;l.isBlock&&c>r&&(a+=s);const d=o==null?void 0:o[l.type.name];if(d)return u&&(a+=d({node:l,pos:c,parent:u,index:f,range:t})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)==null?void 0:h.slice(Math.max(r,c)-c,i-c))}),a}function KT(n,t){const e={from:0,to:n.content.size};return gg(n,e,t)}function yg(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}function qT(n,t){const e=dt(t,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,a=>{s.push(a)});const o=s.reverse().find(a=>a.type.name===e.name);return o?{...o.attrs}:{}}function bg(n,t){const e=Ho(typeof t=="string"?t:t.name,n.schema);return e==="node"?qT(n,t):e==="mark"?fg(n,t):{}}function JT(n,t=JSON.stringify){const e={};return n.filter(r=>{const i=t(r);return Object.prototype.hasOwnProperty.call(e,i)?!1:e[i]=!0})}function YT(n){const t=JT(n);return t.length===1?t:t.filter((e,r)=>!t.filter((s,o)=>o!==r).some(s=>e.oldRange.from>=s.oldRange.from&&e.oldRange.to<=s.oldRange.to&&e.newRange.from>=s.newRange.from&&e.newRange.to<=s.newRange.to))}function xg(n){const{mapping:t,steps:e}=n,r=[];return t.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=e[s];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=t.slice(s).map(a,-1),u=t.slice(s).map(l),f=t.invert().map(c,-1),h=t.invert().map(u);r.push({oldRange:{from:f,to:h},newRange:{from:c,to:u}})})}),YT(r)}function Dc(n,t,e){const r=[];return n===t?e.resolve(n).marks().forEach(i=>{const s=e.resolve(n),o=_c(s,i.type);o&&r.push({mark:i,...o})}):e.nodesBetween(n,t,(i,s)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}var GT=(n,t,e,r=20)=>{const i=n.doc.resolve(e);let s=r,o=null;for(;s>0&&o===null;){const a=i.node(s);(a==null?void 0:a.type.name)===t?o=a:s-=1}return[o,s]};function Ar(n,t){return t.nodes[n]||t.marks[n]||null}function gs(n,t,e){return Object.fromEntries(Object.entries(e).filter(([r])=>{const i=n.find(s=>s.type===t&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}var XT=(n,t=500)=>{let e="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-t),r,(i,s,o,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)==null?void 0:c.call(l,{node:i,pos:s,parent:o,index:a}))||i.textContent||"%leaf%";e+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-s))}),e};function El(n,t,e={}){const{empty:r,ranges:i}=n.selection,s=t?Ie(t,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>s?s.name===f.type.name:!0).find(f=>Ws(f.attrs,e,{strict:!1}));let o=0;const a=[];if(i.forEach(({$from:f,$to:h})=>{const d=f.pos,p=h.pos;n.doc.nodesBetween(d,p,(m,g)=>{if(s&&m.inlineContent&&!m.type.allowsMarkType(s))return!1;if(!m.isText&&!m.marks.length)return;const y=Math.max(d,g),b=Math.min(p,g+m.nodeSize),v=b-y;o+=v,a.push(...m.marks.map(k=>({mark:k,from:y,to:b})))})}),o===0)return!1;const l=a.filter(f=>s?s.name===f.mark.type.name:!0).filter(f=>Ws(f.mark.attrs,e,{strict:!1})).reduce((f,h)=>f+h.to-h.from,0),c=a.filter(f=>s?f.mark.type!==s&&f.mark.type.excludes(s):!0).reduce((f,h)=>f+h.to-h.from,0);return(l>0?l+c:l)>=o}function QT(n,t,e={}){if(!t)return rn(n,null,e)||El(n,null,e);const r=Ho(t,n.schema);return r==="node"?rn(n,t,e):r==="mark"?El(n,t,e):!1}var ZT=(n,t)=>{const{$from:e,$to:r,$anchor:i}=n.selection;if(t){const s=Vo(a=>a.type.name===t)(n.selection);if(!s)return!1;const o=n.doc.resolve(s.pos+1);return i.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||e.pos!==r.pos)},tO=n=>{const{$from:t,$to:e}=n.selection;return!(t.parentOffset>0||t.pos!==e.pos)};function jh(n,t){return Array.isArray(t)?t.some(e=>(typeof e=="string"?e:e.name)===n.name):t}function Uh(n,t){const{nodeExtensions:e}=pr(t),r=e.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=G(L(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Wo(n,{checkChildren:t=!0,ignoreWhitespace:e=!1}={}){var r;if(e){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(t){let i=!0;return n.content.forEach(s=>{i!==!1&&(Wo(s,{ignoreWhitespace:e,checkChildren:t})||(i=!1))}),i}return!1}function vg(n){return n instanceof B}var kg=class Sg{constructor(t){this.position=t}static fromJSON(t){return new Sg(t.position)}toJSON(){return{position:this.position}}};function eO(n,t){const e=t.mapping.mapResult(n.position);return{position:new kg(e.pos),mapResult:e}}function nO(n){return new kg(n)}function rO(n,t,e){var r;const{selection:i}=t;let s=null;if(ag(i)&&(s=i.$cursor),s){const a=(r=n.storedMarks)!=null?r:s.marks();return s.parent.type.allowsMarkType(e)&&(!!e.isInSet(a)||!a.some(c=>c.type.excludes(e)))}const{ranges:o}=i;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(e):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,f,h)=>{if(c)return!1;if(u.isInline){const d=!h||h.type.allowsMarkType(e),p=!!e.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(e));c=d&&p}return!c}),c})}var iO=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=e,{empty:o,ranges:a}=s,l=Ie(n,r.schema);if(i)if(o){const c=fg(r,l);e.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(h,d)=>{const p=Math.max(d,u),m=Math.min(d+h.nodeSize,f);h.marks.find(y=>y.type===l)?h.marks.forEach(y=>{l===y.type&&e.addMark(p,m,l.create({...y.attrs,...t}))}):e.addMark(p,m,l.create(t))})});return rO(r,e,l)},sO=(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),oO=(n,t={})=>({state:e,dispatch:r,chain:i})=>{const s=dt(n,e.schema);let o;return e.selection.$anchor.sameParent(e.selection.$head)&&(o=e.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:a})=>ih(s,{...o,...t})(e)?!0:a.clearNodes()).command(({state:a})=>ih(s,{...o,...t})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},aO=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,i=Mn(n,0,r.content.size),s=B.create(r,i);t.setSelection(s)}return!0},lO=(n,t)=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=r;let o,a;return typeof t=="number"?(o=t,a=t):t&&"from"in t&&"to"in t?(o=t.from,a=t.to):(o=s.from,a=s.to),i&&e.doc.nodesBetween(o,a,(l,c)=>{l.isText||e.setNodeMarkup(c,void 0,{...l.attrs,dir:n})}),!0},cO=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=H.atStart(r).from,a=H.atEnd(r).to,l=Mn(i,o,a),c=Mn(s,o,a),u=H.create(r,l,c);t.setSelection(u)}return!0},uO=n=>({state:t,dispatch:e})=>{const r=dt(n,t.schema);return rM(r)(t,e)};function Kh(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const r=e.filter(i=>t==null?void 0:t.includes(i.type.name));n.tr.ensureMarks(r)}}var fO=({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:r,editor:i})=>{const{selection:s,doc:o}=t,{$from:a,$to:l}=s,c=i.extensionManager.attributes,u=gs(c,a.node().type.name,a.node().attrs);if(s instanceof B&&s.node.isBlock)return!a.parentOffset||!Ae(o,a.pos)?!1:(r&&(n&&Kh(e,i.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:zT(a.node(-1).contentMatchAt(a.indexAfter(-1)));let d=f&&h?[{type:h,attrs:u}]:void 0,p=Ae(t.doc,t.mapping.map(a.pos),1,d);if(!d&&!p&&Ae(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,d=h?[{type:h,attrs:u}]:void 0),r){if(p&&(s instanceof H&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,d),h&&!f&&!a.parentOffset&&a.parent.type!==h)){const m=t.mapping.map(a.before()),g=t.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}n&&Kh(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return p},hO=(n,t={})=>({tr:e,state:r,dispatch:i,editor:s})=>{var o;const a=dt(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const f=l.node(-1);if(f.type!==a)return!1;const h=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let y=O.empty;const b=l.index(-1)?1:l.index(-2)?2:3;for(let M=l.depth-b;M>=l.depth-3;M-=1)y=O.from(l.node(M).copy(y));const v=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,k={...gs(h,l.node().type.name,l.node().attrs),...t},x=((o=a.contentMatch.defaultType)==null?void 0:o.createAndFill(k))||void 0;y=y.append(O.from(a.createAndFill(null,x)||void 0));const w=l.before(l.depth-(b-1));e.replace(w,l.after(-v),new R(y,4-b,0));let S=-1;e.doc.nodesBetween(w,e.doc.content.size,(M,E)=>{if(S>-1)return!1;M.isTextblock&&M.content.size===0&&(S=E+1)}),S>-1&&e.setSelection(H.near(e.doc.resolve(S))),e.scrollIntoView()}return!0}const d=c.pos===l.end()?f.contentMatchAt(0).defaultType:null,p={...gs(h,f.type.name,f.attrs),...t},m={...gs(h,l.node().type.name,l.node().attrs),...t};e.delete(l.pos,c.pos);const g=d?[{type:a,attrs:p},{type:d,attrs:m}]:[{type:a,attrs:p}];if(!Ae(e.doc,l.pos,2))return!1;if(i){const{selection:y,storedMarks:b}=r,{splittableMarks:v}=s.extensionManager,k=b||y.$to.parentOffset&&y.$from.marks();if(e.split(l.pos,2,g).scrollIntoView(),!k||!i)return!0;const x=k.filter(w=>v.includes(w.type.name));e.ensureMarks(x)}return!0},Fa=(n,t)=>{const e=Vo(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===(i==null?void 0:i.type)&&on(n.doc,e.pos)&&n.join(e.pos),!0},Ha=(n,t)=>{const e=Vo(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(e.start).after(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===(i==null?void 0:i.type)&&on(n.doc,r)&&n.join(r),!0},dO=(n,t,e,r={})=>({editor:i,tr:s,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:h}=i.extensionManager,d=dt(n,o.schema),p=dt(t,o.schema),{selection:m,storedMarks:g}=o,{$from:y,$to:b}=m,v=y.blockRange(b),k=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;const x=Vo(w=>Uh(w.type.name,f))(m);if(v.depth>=1&&x&&v.depth-x.depth<=1){if(x.node.type===d)return c.liftListItem(p);if(Uh(x.node.type.name,f)&&d.validContent(x.node.content)&&a)return l().command(()=>(s.setNodeMarkup(x.pos,d),!0)).command(()=>Fa(s,d)).command(()=>Ha(s,d)).run()}return!e||!k||!a?l().command(()=>u().wrapInList(d,r)?!0:c.clearNodes()).wrapInList(d,r).command(()=>Fa(s,d)).command(()=>Ha(s,d)).run():l().command(()=>{const w=u().wrapInList(d,r),S=k.filter(M=>h.includes(M.type.name));return s.ensureMarks(S),w?!0:c.clearNodes()}).wrapInList(d,r).command(()=>Fa(s,d)).command(()=>Ha(s,d)).run()},pO=(n,t={},e={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=e,o=Ie(n,r.schema);return El(r,o,t)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,t)},mO=(n,t,e={})=>({state:r,commands:i})=>{const s=dt(n,r.schema),o=dt(t,r.schema),a=rn(r,s,e);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(o,l):i.setNode(s,{...l,...e})},gO=(n,t={})=>({state:e,commands:r})=>{const i=dt(n,e.schema);return rn(e,i,t)?r.lift(i):r.wrapIn(i,t)},yO=()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let r=0;r<e.length;r+=1){const i=e[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(t){const o=n.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,l))}else o.delete(s.from,s.to)}return!0}}return!1},bO=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:r,ranges:i}=e;return r||t&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},xO=(n,t={})=>({tr:e,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=e,l=Ie(n,r.schema),{$from:c,empty:u,ranges:f}=a;if(!i)return!0;if(u&&o){let{from:h,to:d}=a;const p=(s=c.marks().find(g=>g.type===l))==null?void 0:s.attrs,m=_c(c,l,p);m&&(h=m.from,d=m.to),e.removeMark(h,d,l)}else f.forEach(h=>{e.removeMark(h.$from.pos,h.$to.pos,l)});return e.removeStoredMark(l),!0},vO=n=>({tr:t,state:e,dispatch:r})=>{const{selection:i}=e;let s,o;return typeof n=="number"?(s=n,o=n):n&&"from"in n&&"to"in n?(s=n.from,o=n.to):(s=i.from,o=i.to),r&&t.doc.nodesBetween(s,o,(a,l)=>{if(a.isText)return;const c={...a.attrs};delete c.dir,t.setNodeMarkup(l,void 0,c)}),!0},kO=(n,t={})=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const a=Ho(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(s=dt(n,r.schema)),a==="mark"&&(o=Ie(n,r.schema));let l=!1;return e.selection.ranges.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;let h,d,p,m;e.selection.empty?r.doc.nodesBetween(u,f,(g,y)=>{s&&s===g.type&&(l=!0,p=Math.max(y,u),m=Math.min(y+g.nodeSize,f),h=y,d=g)}):r.doc.nodesBetween(u,f,(g,y)=>{y<u&&s&&s===g.type&&(l=!0,p=Math.max(y,u),m=Math.min(y+g.nodeSize,f),h=y,d=g),y>=u&&y<=f&&(s&&s===g.type&&(l=!0,i&&e.setNodeMarkup(y,void 0,{...g.attrs,...t})),o&&g.marks.length&&g.marks.forEach(b=>{if(o===b.type&&(l=!0,i)){const v=Math.max(y,u),k=Math.min(y+g.nodeSize,f);e.addMark(v,k,o.create({...b.attrs,...t}))}}))}),d&&(h!==void 0&&i&&e.setNodeMarkup(h,void 0,{...d.attrs,...t}),o&&d.marks.length&&d.marks.forEach(g=>{o===g.type&&i&&e.addMark(p,m,o.create({...g.attrs,...t}))}))}),l},SO=(n,t={})=>({state:e,dispatch:r})=>{const i=dt(n,e.schema);return Gw(i,t)(e,r)},wO=(n,t={})=>({state:e,dispatch:r})=>{const i=dt(n,e.schema);return Xw(i,t)(e,r)},MO=class{constructor(){this.callbacks={}}on(n,t){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(t),this}emit(n,...t){const e=this.callbacks[n];return e&&e.forEach(r=>r.apply(this,t)),this}off(n,t){const e=this.callbacks[n];return e&&(t?this.callbacks[n]=e.filter(r=>r!==t):delete this.callbacks[n]),this}once(n,t){const e=(...r)=>{this.off(n,e),t.apply(this,r)};return this.on(n,e)}removeAllListeners(){this.callbacks={}}},jo=class{constructor(n){var t;this.find=n.find,this.handler=n.handler,this.undoable=(t=n.undoable)!=null?t:!0}},CO=(n,t)=>{if(Oc(t))return t.exec(n);const e=t(n);if(!e)return null;const r=[e.text];return r.index=e.index,r.input=n,r.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(e.replaceWith)),r};function ts(n){var t;const{editor:e,from:r,to:i,text:s,rules:o,plugin:a}=n,{view:l}=e;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(t=c.nodeBefore||c.nodeAfter)!=null&&t.marks.find(h=>h.type.spec.code))return!1;let u=!1;const f=XT(c)+s;return o.forEach(h=>{if(u)return;const d=CO(f,h.find);if(!d)return;const p=l.state.tr,m=zo({state:l.state,transaction:p}),g={from:r-(d[0].length-s.length),to:i},{commands:y,chain:b,can:v}=new Fo({editor:e,state:m});h.handler({state:m,range:g,match:d,commands:y,chain:b,can:v})===null||!p.steps.length||(h.undoable&&p.setMeta(a,{transform:p,from:r,to:i,text:s}),l.dispatch(p),u=!0)}),u}function TO(n){const{editor:t,rules:e}=n,r=new ot({state:{init(){return null},apply(i,s,o){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Ac(O.from(u),o.schema);const{from:f}=l,h=f+u.length;ts({editor:t,from:f,to:h,text:u,rules:e,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,a){return ts({editor:t,from:s,to:o,text:a,rules:e,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&ts({editor:t,from:s.pos,to:s.pos,text:"",rules:e,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?ts({editor:t,from:o.pos,to:o.pos,text:`
`,rules:e,plugin:r}):!1}},isInputRules:!0});return r}function OO(n){return Object.prototype.toString.call(n).slice(8,-1)}function es(n){return OO(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function wg(n,t){const e={...n};return es(n)&&es(t)&&Object.keys(t).forEach(r=>{es(t[r])&&es(n[r])?e[r]=wg(n[r],t[r]):e[r]=t[r]}),e}var Pc=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...G(L(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...G(L(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const t=this.extend({...this.config,addOptions:()=>wg(this.options,n)});return t.name=this.name,t.parent=this.parent,t}extend(n={}){const t=new this.constructor({...this.config,...n});return t.parent=this,this.child=t,t.name="name"in n?n.name:t.parent.name,t}},Vn=class Mg extends Pc{constructor(){super(...arguments),this.type="mark"}static create(t={}){const e=typeof t=="function"?t():t;return new Mg(e)}static handleExit({editor:t,mark:e}){const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===e.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===e.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function _O(n){return typeof n=="number"}var EO=class{constructor(n){this.find=n.find,this.handler=n.handler}},AO=(n,t,e)=>{if(Oc(t))return[...n.matchAll(t)];const r=t(n,e);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=n,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function DO(n){const{editor:t,state:e,from:r,to:i,rule:s,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Fo({editor:t,state:e}),f=[];return e.doc.nodesBetween(r,i,(d,p)=>{var m,g,y,b,v;if((g=(m=d.type)==null?void 0:m.spec)!=null&&g.code||!(d.isText||d.isTextblock||d.isInline))return;const k=(v=(b=(y=d.content)==null?void 0:y.size)!=null?b:d.nodeSize)!=null?v:0,x=Math.max(r,p),w=Math.min(i,p+k);if(x>=w)return;const S=d.isText?d.text||"":d.textBetween(x-p,w-p,void 0,"");AO(S,s.find,o).forEach(E=>{if(E.index===void 0)return;const I=x+E.index+1,A=I+E[0].length,z={from:e.tr.mapping.map(I),to:e.tr.mapping.map(A)},K=s.handler({state:e,range:z,match:E,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});f.push(K)})}),f.every(d=>d!==null)}var ns=null,PO=n=>{var t;const e=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=e.clipboardData)==null||t.setData("text/html",n),e};function NO(n){const{editor:t,rules:e}=n;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:f,to:h,rule:d,pasteEvt:p})=>{const m=u.tr,g=zo({state:u,transaction:m});if(!(!DO({editor:t,state:g,from:Math.max(f-1,0),to:h.b-1,rule:d,pasteEvent:p,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return e.map(u=>new ot({view(f){const h=p=>{var m;r=(m=f.dom.parentElement)!=null&&m.contains(p.target)?f.dom.parentElement:null,r&&(ns=t)},d=()=>{ns&&(ns=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",d),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",d)}}},props:{handleDOMEvents:{drop:(f,h)=>{if(s=r===f.dom.parentElement,a=h,!s){const d=ns;d!=null&&d.isEditable&&setTimeout(()=>{const p=d.state.selection;p&&d.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(f,h)=>{var d;const p=(d=h.clipboardData)==null?void 0:d.getData("text/html");return o=h,i=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(f,h,d)=>{const p=f[0],m=p.getMeta("uiEvent")==="paste"&&!i,g=p.getMeta("uiEvent")==="drop"&&!s,y=p.getMeta("applyPasteRules"),b=!!y;if(!m&&!g&&!b)return;if(b){let{text:x}=y;typeof x=="string"?x=x:x=Ac(O.from(x),d.schema);const{from:w}=y,S=w+x.length,M=PO(x);return l({rule:u,state:d,from:w,to:{b:S},pasteEvt:M})}const v=h.doc.content.findDiffStart(d.doc.content),k=h.doc.content.findDiffEnd(d.doc.content);if(!(!_O(v)||!k||v===k.b))return l({rule:u,state:d,from:v,to:k,pasteEvt:o})}}))}var Uo=class{constructor(n,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=n,this.extensions=mg(n),this.schema=jT(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((n,t)=>{const e={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:Ar(t.name,this.schema)},r=L(t,"addCommands",e);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return ti([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:Ar(r.name,this.schema)},s=[],o=L(r,"addKeyboardShortcuts",i);let a={};if(r.type==="mark"&&L(r,"exitable",i)&&(a.ArrowRight=()=>Vn.handleExit({editor:n,mark:r})),o){const h=Object.fromEntries(Object.entries(o()).map(([d,p])=>[d,()=>p({editor:n})]));a={...a,...h}}const l=qC(a);s.push(l);const c=L(r,"addInputRules",i);if(jh(r,n.options.enableInputRules)&&c){const h=c();if(h&&h.length){const d=TO({editor:n,rules:h}),p=Array.isArray(d)?d:[d];s.push(...p)}}const u=L(r,"addPasteRules",i);if(jh(r,n.options.enablePasteRules)&&u){const h=u();if(h&&h.length){const d=NO({editor:n,rules:h});s.push(...d)}}const f=L(r,"addProseMirrorPlugins",i);if(f){const h=f();s.push(...h)}return s})}get attributes(){return pg(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:t}=pr(this.extensions);return Object.fromEntries(t.filter(e=>!!L(e,"addNodeView")).map(e=>{const r=this.attributes.filter(l=>l.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:dt(e.name,this.schema)},s=L(e,"addNodeView",i);if(!s)return[];const o=s();if(!o)return[];const a=(l,c,u,f,h)=>{const d=wi(l,r);return o({node:l,view:c,getPos:u,decorations:f,innerDecorations:h,editor:n,extension:e,HTMLAttributes:d})};return[e.name,a]}))}dispatchTransaction(n){const{editor:t}=this;return ti([...this.extensions].reverse()).reduceRight((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:Ar(i.name,this.schema)},o=L(i,"dispatchTransaction",s);return o?a=>{o.call(s,{transaction:a,next:r})}:r},n)}transformPastedHTML(n){const{editor:t}=this;return ti([...this.extensions]).reduce((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:Ar(i.name,this.schema)},o=L(i,"transformPastedHTML",s);return o?(a,l)=>{const c=r(a,l);return o.call(s,c)}:r},n||(r=>r))}get markViews(){const{editor:n}=this,{markExtensions:t}=pr(this.extensions);return Object.fromEntries(t.filter(e=>!!L(e,"addMarkView")).map(e=>{const r=this.attributes.filter(a=>a.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:Ie(e.name,this.schema)},s=L(e,"addMarkView",i);if(!s)return[];const o=(a,l,c)=>{const u=wi(a,r);return s()({mark:a,view:l,inline:c,editor:n,extension:e,HTMLAttributes:u,updateAttributes:f=>{KO(a,n,f)}})};return[e.name,o]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(t=>[t.name,t.storage])),n.forEach(t=>{var e;const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:Ar(t.name,this.schema)};t.type==="mark"&&((e=G(L(t,"keepOnSplit",r)))==null||e)&&this.splittableMarks.push(t.name);const i=L(t,"onBeforeCreate",r),s=L(t,"onCreate",r),o=L(t,"onUpdate",r),a=L(t,"onSelectionUpdate",r),l=L(t,"onTransaction",r),c=L(t,"onFocus",r),u=L(t,"onBlur",r),f=L(t,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}};Uo.resolve=mg;Uo.sort=ti;Uo.flatten=Ec;var IO={};Tc(IO,{ClipboardTextSerializer:()=>Tg,Commands:()=>Og,Delete:()=>_g,Drop:()=>Eg,Editable:()=>Ag,FocusEvents:()=>Pg,Keymap:()=>Ng,Paste:()=>Ig,Tabindex:()=>Rg,TextDirection:()=>Lg,focusEventsPluginKey:()=>Dg});var ft=class Cg extends Pc{constructor(){super(...arguments),this.type="extension"}static create(t={}){const e=typeof t=="function"?t():t;return new Cg(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}},Tg=ft.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ot({key:new yt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:r,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),a=Math.max(...s.map(u=>u.$to.pos)),l=yg(e);return gg(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Og=ft.create({name:"commands",addCommands(){return{...sg}}}),_g=ft.create({name:"delete",onUpdate({transaction:n,appendedTransactions:t}){var e,r,i;const s=()=>{var o,a,l,c;if((c=(l=(a=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,n))!=null?c:n.getMeta("y-sync$"))return;const u=hg(n.before,[n,...t]);xg(u).forEach(d=>{u.mapping.mapResult(d.oldRange.from).deletedAfter&&u.mapping.mapResult(d.oldRange.to).deletedBefore&&u.before.nodesBetween(d.oldRange.from,d.oldRange.to,(p,m)=>{const g=m+p.nodeSize-2,y=d.oldRange.from<=m&&g<=d.oldRange.to;this.editor.emit("delete",{type:"node",node:p,from:m,to:g,newFrom:u.mapping.map(m),newTo:u.mapping.map(g),deletedRange:d.oldRange,newRange:d.newRange,partial:!y,editor:this.editor,transaction:n,combinedTransform:u})})});const h=u.mapping;u.steps.forEach((d,p)=>{var m,g;if(d instanceof ie){const y=h.slice(p).map(d.from,-1),b=h.slice(p).map(d.to),v=h.invert().map(y,-1),k=h.invert().map(b),x=(m=u.doc.nodeAt(y-1))==null?void 0:m.marks.some(S=>S.eq(d.mark)),w=(g=u.doc.nodeAt(b))==null?void 0:g.marks.some(S=>S.eq(d.mark));this.editor.emit("delete",{type:"mark",mark:d.mark,from:d.from,to:d.to,deletedRange:{from:v,to:k},newRange:{from:y,to:b},partial:!!(w||x),editor:this.editor,transaction:n,combinedTransform:u})}})};(i=(r=(e=this.editor.options.coreExtensionOptions)==null?void 0:e.delete)==null?void 0:r.async)==null||i?setTimeout(s,0):s()}}),Eg=ft.create({name:"drop",addProseMirrorPlugins(){return[new ot({key:new yt("tiptapDrop"),props:{handleDrop:(n,t,e,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:e,moved:r})}}})]}}),Ag=ft.create({name:"editable",addProseMirrorPlugins(){return[new ot({key:new yt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Dg=new yt("focusEvents"),Pg=ft.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new ot({key:Dg,props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,e)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Ng=ft.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:f}=l,{pos:h,parent:d}=f,p=f.parent.isTextblock&&h>0?a.doc.resolve(h-1):f,m=p.parent.type.spec.isolating,g=f.pos-f.parentOffset,y=m&&p.parent.childCount===1?g===f.pos:j.atStart(c).from===h;return!u||!d.type.isTextblock||d.textContent.length||!y||y&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return js()||ug()?s:i},addProseMirrorPlugins(){return[new ot({key:new yt("clearDocument"),appendTransaction:(n,t,e)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!t.doc.eq(e.doc),i=n.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:a}=t.selection,l=j.atStart(t.doc).from,c=j.atEnd(t.doc).to;if(s||!(o===l&&a===c)||!Wo(e.doc))return;const h=e.tr,d=zo({state:e,transaction:h}),{commands:p}=new Fo({editor:this.editor,state:d});if(p.clearNodes(),!!h.steps.length)return h}})]}}),Ig=ft.create({name:"paste",addProseMirrorPlugins(){return[new ot({key:new yt("tiptapPaste"),props:{handlePaste:(n,t,e)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:e})}}})]}}),Rg=ft.create({name:"tabindex",addProseMirrorPlugins(){return[new ot({key:new yt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Lg=ft.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=pr(this.extensions);return[{types:n.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const e=t.getAttribute("dir");return e&&(e==="ltr"||e==="rtl"||e==="auto")?e:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new ot({key:new yt("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),RO=class $r{constructor(t,e,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=e,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}e=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:e,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new $r(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new $r(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new $r(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,r)=>{const i=e.isBlock&&!e.isTextblock,s=e.isAtom&&!e.isText,o=e.isInline,a=this.pos+r+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(a);if(!i&&!o&&l.depth<=this.depth)return;const c=new $r(l,this.editor,i,i||o?e:null);i&&(c.actualDepth=this.depth+1),t.push(c)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===t)if(Object.keys(e).length>0){const s=i.node.attrs,o=Object.keys(e);for(let a=0;a<o.length;a+=1){const l=o[a];if(s[l]!==e[l])break}}else r=i;i=i.parent}return r}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(e);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===t&&s.every(l=>e[l]===o.node.attrs[l])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(t,e,r))))}),i}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}},LO=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function BO(n,t,e){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}var WE=class extends MO{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:i})=>{throw i},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:eO,createMappablePosition:nO},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:i,slice:s,moved:o})=>this.options.onDrop(i,s,o)),this.on("paste",({event:i,slice:s})=>this.options.onPaste(i,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),r=lg(e,this.options.autofocus);this.editorState=Zn.create({doc:e,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=BO(LO,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const r=dg(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;r=r.filter(a=>!a.key.startsWith(o))}),e.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var t,e;const i=[...this.options.enableCoreExtensions?[Ag,Tg.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),Og,Pg,Ng,Rg,Eg,Ig,_g,Lg.configure({direction:this.options.textDirection})].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new Uo(i,this)}createCommandManager(){this.commandManager=new Fo({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=_l(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=_l(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:r}=this.options,i=e.dispatchTransaction||this.dispatchTransaction.bind(this),s=r?this.extensionManager.dispatchTransaction(i):i,o=e.transformPastedHTML,a=this.extensionManager.transformPastedHTML(o);this.editorView=new rg(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:s,transformPastedHTML:a,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const l=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(l),this.prependClass(),this.injectCSS();const c=this.view.dom;c.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var f;return(f=this.capturedTransaction)==null?void 0:f.step(u)});return}const{state:e,transactions:r}=this.state.applyTransaction(t),i=!this.state.selection.eq(e.selection),s=r.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),i&&this.emit("selectionUpdate",{editor:this,transaction:t});const a=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=a==null?void 0:a.getMeta("focus"),c=a==null?void 0:a.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:a}),c&&this.emit("blur",{editor:this,event:c.event,transaction:a}),!(t.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return bg(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,i=typeof t=="string"?e:t;return QT(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ac(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return KT(this.state.doc,{blockSeparator:e,textSerializers:{...yg(this.schema),...r}})}get isEmpty(){return Wo(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new RO(e,this)}get $doc(){return this.$pos(0)}};function mr(n){return new jo({find:n.find,handler:({state:t,range:e,match:r})=>{const i=G(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=t,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=e.from+a.indexOf(o),u=c+o.length;if(Dc(e.from,e.to,t.doc).filter(d=>d.mark.type.excluded.find(m=>m===n.type&&m!==d.mark.type)).filter(d=>d.to>c).length)return null;u<e.to&&s.delete(u,e.to),c>e.from&&s.delete(e.from+l,c);const h=e.from+l+o.length;s.addMark(e.from+l,h,n.type.create(i||{})),s.removeStoredMark(n.type)}},undoable:n.undoable})}function $O(n){return new jo({find:n.find,handler:({state:t,range:e,match:r})=>{const i=G(n.getAttributes,void 0,r)||{},{tr:s}=t,o=e.from;let a=e.to;const l=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const f=r[0][r[0].length-1];s.insertText(f,o+r[0].length-1),s.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;s.insert(c,n.type.create(i)).delete(s.mapping.map(o),s.mapping.map(a))}s.scrollIntoView()},undoable:n.undoable})}function Al(n){return new jo({find:n.find,handler:({state:t,range:e,match:r})=>{const i=t.doc.resolve(e.from),s=G(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,s)},undoable:n.undoable})}function gr(n){return new jo({find:n.find,handler:({state:t,range:e,match:r,chain:i})=>{const s=G(n.getAttributes,void 0,r)||{},o=t.tr.delete(e.from,e.to),l=o.doc.resolve(e.from).blockRange(),c=l&&uc(l,n.type,s);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:f,storedMarks:h}=t,{splittableMarks:d}=n.editor.extensionManager,p=h||f.$to.parentOffset&&f.$from.marks();if(p){const m=p.filter(g=>d.includes(g.type.name));o.ensureMarks(m)}}if(n.keepAttributes){const f=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,s).run()}const u=o.doc.resolve(e.from-1).nodeBefore;u&&u.type===n.type&&on(o.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(e.from-1)},undoable:n.undoable})}function zO(n,t){const{selection:e}=n,{$from:r}=e;if(e instanceof B){const s=r.index();return r.parent.canReplaceWith(s,s+1,t)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(t))return!0;i-=1}return!1}var FO={};Tc(FO,{createAtomBlockMarkdownSpec:()=>HO,createBlockMarkdownSpec:()=>VO,createInlineMarkdownSpec:()=>UO,parseAttributes:()=>Nc,parseIndentedBlocks:()=>Dl,renderNestedMarkdownContent:()=>Rc,serializeAttributes:()=>Ic});function Nc(n){if(!(n!=null&&n.trim()))return{};const t={},e=[],r=n.replace(/["']([^"']*)["']/g,c=>(e.push(c),`__QUOTED_${e.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const c=i.map(u=>u.trim().slice(1));t.class=c.join(" ")}const s=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(t.id=s[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,c,u])=>{var f;const h=parseInt(((f=u.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),d=e[h];d&&(t[c]=d.slice(1,-1))});const l=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(t[u]=!0)}),t}function Ic(n){if(!n||Object.keys(n).length===0)return"";const t=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>t.push(`.${r}`)),n.id&&t.push(`#${n.id}`),Object.entries(n).forEach(([e,r])=>{e==="class"||e==="id"||(r===!0?t.push(e):r!==!1&&r!=null&&t.push(`${e}="${String(r)}"`))}),t.join(" ")}function HO(n){const{nodeName:t,name:e,parseAttributes:r=Nc,serializeAttributes:i=Ic,defaultAttributes:s={},requiredAttributes:o=[],allowedAttributes:a}=n,l=e||t,c=u=>{if(!a)return u;const f={};return a.forEach(h=>{h in u&&(f[h]=u[h])}),f};return{parseMarkdown:(u,f)=>{const h={...s,...u.attributes};return f.createNode(t,h,[])},markdownTokenizer:{name:t,level:"block",start(u){var f;const h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),d=(f=u.match(h))==null?void 0:f.index;return d!==void 0?d:-1},tokenize(u,f,h){const d=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),p=u.match(d);if(!p)return;const m=p[1]||"",g=r(m);if(!o.find(b=>!(b in g)))return{type:t,raw:p[0],attributes:g}}},renderMarkdown:u=>{const f=c(u.attrs||{}),h=i(f),d=h?` {${h}}`:"";return`:::${l}${d} :::`}}}function VO(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=Nc,serializeAttributes:s=Ic,defaultAttributes:o={},content:a="block",allowedAttributes:l}=n,c=e||t,u=f=>{if(!l)return f;const h={};return l.forEach(d=>{d in f&&(h[d]=f[d])}),h};return{parseMarkdown:(f,h)=>{let d;if(r){const m=r(f);d=typeof m=="string"?[{type:"text",text:m}]:m}else a==="block"?d=h.parseChildren(f.tokens||[]):d=h.parseInline(f.tokens||[]);const p={...o,...f.attributes};return h.createNode(t,p,d)},markdownTokenizer:{name:t,level:"block",start(f){var h;const d=new RegExp(`^:::${c}`,"m"),p=(h=f.match(d))==null?void 0:h.index;return p!==void 0?p:-1},tokenize(f,h,d){var p;const m=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),g=f.match(m);if(!g)return;const[y,b=""]=g,v=i(b);let k=1;const x=y.length;let w="";const S=/^:::([\w-]*)(\s.*)?/gm,M=f.slice(x);for(S.lastIndex=0;;){const E=S.exec(M);if(E===null)break;const I=E.index,A=E[1];if(!((p=E[2])!=null&&p.endsWith(":::"))){if(A)k+=1;else if(k-=1,k===0){const z=M.slice(0,I);w=z.trim();const K=f.slice(0,x+I+E[0].length);let D=[];if(w)if(a==="block")for(D=d.blockTokens(z),D.forEach(C=>{C.text&&(!C.tokens||C.tokens.length===0)&&(C.tokens=d.inlineTokens(C.text))});D.length>0;){const C=D[D.length-1];if(C.type==="paragraph"&&(!C.text||C.text.trim()===""))D.pop();else break}else D=d.inlineTokens(w);return{type:t,raw:K,attributes:v,content:w,tokens:D}}}}}},renderMarkdown:(f,h)=>{const d=u(f.attrs||{}),p=s(d),m=p?` {${p}}`:"",g=h.renderChildren(f.content||[],`

`);return`:::${c}${m}

${g}

:::`}}}function WO(n){if(!n.trim())return{};const t={},e=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=e.exec(n);for(;r!==null;){const[,i,s,o]=r;t[i]=s||o,r=e.exec(n)}return t}function jO(n){return Object.entries(n).filter(([,t])=>t!=null).map(([t,e])=>`${t}="${e}"`).join(" ")}function UO(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=WO,serializeAttributes:s=jO,defaultAttributes:o={},selfClosing:a=!1,allowedAttributes:l}=n,c=e||t,u=h=>{if(!l)return h;const d={};return l.forEach(p=>{const m=typeof p=="string"?p:p.name,g=typeof p=="string"?void 0:p.skipIfDefault;if(m in h){const y=h[m];if(g!==void 0&&y===g)return;d[m]=y}}),d},f=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,d)=>{const p={...o,...h.attributes};if(a)return d.createNode(t,p);const m=r?r(h):h.content||"";return m?d.createNode(t,p,[d.createTextNode(m)]):d.createNode(t,p,[])},markdownTokenizer:{name:t,level:"inline",start(h){const d=a?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),p=h.match(d),m=p==null?void 0:p.index;return m!==void 0?m:-1},tokenize(h,d,p){const m=a?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),g=h.match(m);if(!g)return;let y="",b="";if(a){const[,k]=g;b=k}else{const[,k,x]=g;b=k,y=x||""}const v=i(b.trim());return{type:t,raw:g[0],content:y.trim(),attributes:v}}},renderMarkdown:h=>{let d="";r?d=r(h):h.content&&h.content.length>0&&(d=h.content.filter(y=>y.type==="text").map(y=>y.text).join(""));const p=u(h.attrs||{}),m=s(p),g=m?` ${m}`:"";return a?`[${c}${g}]`:`[${c}${g}]${d}[/${c}]`}}}function Dl(n,t,e){var r,i,s,o;const a=n.split(`
`),l=[];let c="",u=0;const f=t.baseIndentSize||2;for(;u<a.length;){const h=a[u],d=h.match(t.itemPattern);if(!d){if(l.length>0)break;if(h.trim()===""){u+=1,c=`${c}${h}
`;continue}else return}const p=t.extractItemData(d),{indentLevel:m,mainContent:g}=p;c=`${c}${h}
`;const y=[g];for(u+=1;u<a.length;){const x=a[u];if(x.trim()===""){const S=a.slice(u+1).findIndex(I=>I.trim()!=="");if(S===-1)break;if((((i=(r=a[u+1+S].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>m){y.push(x),c=`${c}${x}
`,u+=1;continue}else break}if((((o=(s=x.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:o.length)||0)>m)y.push(x),c=`${c}${x}
`,u+=1;else break}let b;const v=y.slice(1);if(v.length>0){const x=v.map(w=>w.slice(m+f)).join(`
`);x.trim()&&(t.customNestedParser?b=t.customNestedParser(x):b=e.blockTokens(x))}const k=t.createToken(p,b);l.push(k)}if(l.length!==0)return{items:l,raw:c}}function Rc(n,t,e,r){if(!n||!Array.isArray(n.content))return"";const i=typeof e=="function"?e(r):e,[s,...o]=n.content,a=t.renderChildren([s]),l=[`${i}${a}`];return o&&o.length>0&&o.forEach(c=>{const u=t.renderChildren([c]);if(u){const f=u.split(`
`).map(h=>h?t.indent(h):"").join(`
`);l.push(f)}}),l.join(`
`)}function KO(n,t,e={}){const{state:r}=t,{doc:i,tr:s}=r,o=n;i.descendants((a,l)=>{const c=s.mapping.map(l),u=s.mapping.map(l)+a.nodeSize;let f=null;if(a.marks.forEach(d=>{if(d!==o)return!1;f=d}),!f)return;let h=!1;if(Object.keys(e).forEach(d=>{e[d]!==f.attrs[d]&&(h=!0)}),h){const d=n.type.create({...n.attrs,...e});s.removeMark(c,u,n.type),s.addMark(c,u,d)}}),s.docChanged&&t.view.dispatch(s)}var Ut=class Bg extends Pc{constructor(){super(...arguments),this.type="node"}static create(t={}){const e=typeof t=="function"?t():t;return new Bg(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function $n(n){return new EO({find:n.find,handler:({state:t,range:e,match:r,pasteEvent:i})=>{const s=G(n.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=t,a=r[r.length-1],l=r[0];let c=e.to;if(a){const u=l.search(/\S/),f=e.from+l.indexOf(a),h=f+a.length;if(Dc(e.from,e.to,t.doc).filter(p=>p.mark.type.excluded.find(g=>g===n.type&&g!==p.mark.type)).filter(p=>p.to>f).length)return null;h<e.to&&o.delete(h,e.to),f>e.from&&o.delete(e.from+u,f),c=e.from+u+a.length,o.addMark(e.from+u,c,n.type.create(s||{})),o.removeStoredMark(n.type)}}})}var Us=(n,t)=>{if(n==="slot")return 0;if(n instanceof Function)return n(t);const{children:e,...r}=t??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,e]},qO=/^\s*>\s$/,JO=Ut.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return Us("blockquote",{...pt(this.options.HTMLAttributes,n),children:Us("slot",{})})},parseMarkdown:(n,t)=>t.createNode("blockquote",void 0,t.parseChildren(n.tokens||[])),renderMarkdown:(n,t)=>{if(!n.content)return"";const e=">",r=[];return n.content.forEach(i=>{const a=t.renderChildren([i]).split(`
`).map(l=>l.trim()===""?e:`${e} ${l}`);r.push(a.join(`
`))}),r.join(`
${e}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[gr({find:qO,type:this.type})]}}),YO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,GO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,XO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,QO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,ZO=Vn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return Us("strong",{...pt(this.options.HTMLAttributes,n),children:Us("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,t)=>t.applyMark("bold",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`**${t.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[mr({find:YO,type:this.type}),mr({find:XO,type:this.type})]},addPasteRules(){return[$n({find:GO,type:this.type}),$n({find:QO,type:this.type})]}}),t_=/(^|[^`])`([^`]+)`(?!`)$/,e_=/(^|[^`])`([^`]+)`(?!`)/g,n_=Vn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",pt(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,t)=>t.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,t)=>n.content?`\`${t.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[mr({find:t_,type:this.type})]},addPasteRules(){return[$n({find:e_,type:this.type})]}}),Va=4,r_=/^```([a-z]+)?[\s\n]$/,i_=/^~~~([a-z]+)?[\s\n]$/,s_=Ut.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Va,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var t;const{languageClassPrefix:e}=this.options;if(!e)return null;const s=[...((t=n.firstElementChild)==null?void 0:t.classList)||[]].filter(o=>o.startsWith(e)).map(o=>o.replace(e,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:t}){return["pre",pt(this.options.HTMLAttributes,t),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,t)=>{var e;return((e=n.raw)==null?void 0:e.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:n.lang||null},n.text?[t.createTextNode(n.text)]:[])},renderMarkdown:(n,t)=>{var e;let r="";const i=((e=n.attrs)==null?void 0:e.language)||"";return n.content?r=[`\`\`\`${i}`,t.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:t})=>t.setNode(this.name,n),toggleCodeBlock:n=>({commands:t})=>t.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:t}=this.editor.state.selection,e=t.pos===1;return!n||t.parent.type.name!==this.name?!1:e||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:Va,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;if(s.parent.type!==this.type)return!1;const a=" ".repeat(e);return o?n.commands.insertContent(a):n.commands.command(({tr:l})=>{const{from:c,to:u}=i,d=r.doc.textBetween(c,u,`
`,`
`).split(`
`).map(p=>a+p).join(`
`);return l.replaceWith(c,u,r.schema.text(d)),!0})},"Shift-Tab":({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:Va,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;return s.parent.type!==this.type?!1:o?n.commands.command(({tr:a})=>{var l;const{pos:c}=s,u=s.start(),f=s.end(),d=r.doc.textBetween(u,f,`
`,`
`).split(`
`);let p=0,m=0;const g=c-u;for(let w=0;w<d.length;w+=1){if(m+d[w].length>=g){p=w;break}m+=d[w].length+1}const b=((l=d[p].match(/^ */))==null?void 0:l[0])||"",v=Math.min(b.length,e);if(v===0)return!0;let k=u;for(let w=0;w<p;w+=1)k+=d[w].length+1;return a.delete(k,k+v),c-k<=v&&a.setSelection(H.create(a.doc,k)),!0}):n.commands.command(({tr:a})=>{const{from:l,to:c}=i,h=r.doc.textBetween(l,c,`
`,`
`).split(`
`).map(d=>{var p;const m=((p=d.match(/^ */))==null?void 0:p[0])||"",g=Math.min(m.length,e);return d.slice(g)}).join(`
`);return a.replaceWith(l,c,r.schema.text(h)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=n,{selection:e}=t,{$from:r,empty:i}=e;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=n,{selection:e,doc:r}=t,{$from:i,empty:s}=e;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(j.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[Al({find:r_,type:this.type,getAttributes:n=>({language:n[1]})}),Al({find:i_,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new ot({key:new yt("codeBlockVSCodeHandler"),props:{handlePaste:(n,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const e=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!e||!s)return!1;const{tr:o,schema:a}=n.state,l=a.text(e.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(H.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),o_=Ut.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`

`):""}),a_=Ut.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",pt(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:t,state:e,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=e;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const f=l.filter(h=>a.includes(h.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),l_=Ut.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:t}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,pt(this.options.HTMLAttributes,t),0]},parseMarkdown:(n,t)=>t.createNode("heading",{level:n.depth||1},t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>{var e;const r=(e=n.attrs)!=null&&e.level?parseInt(n.attrs.level,10):1,i="#".repeat(r);return n.content?`${i} ${t.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.setNode(this.name,n):!1,toggleHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,t)=>({...n,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(n=>Al({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),c_=Ut.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",pt(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:t})=>{if(!zO(t,t.schema.nodes[this.name]))return!1;const{selection:e}=t,{$to:r}=e,i=n();return vg(e)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:s,tr:o,dispatch:a})=>{if(a){const{$to:l}=o.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?o.setSelection(H.create(o.doc,l.pos+1)):l.nodeAfter.isBlock?o.setSelection(B.create(o.doc,l.pos)):o.setSelection(H.create(o.doc,l.pos));else{const u=s.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=u==null?void 0:u.create();f&&(o.insert(c,f),o.setSelection(H.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[$O({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),u_=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,f_=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,h_=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,d_=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,p_=Vn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,t)=>t.applyMark("italic",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`*${t.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[mr({find:u_,type:this.type}),mr({find:h_,type:this.type})]},addPasteRules(){return[$n({find:f_,type:this.type}),$n({find:d_,type:this.type})]}});const m_="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",g_="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Pl="numeric",Nl="ascii",Il="alpha",ei="asciinumeric",zr="alphanumeric",Rl="domain",$g="emoji",y_="scheme",b_="slashscheme",Wa="whitespace";function x_(n,t){return n in t||(t[n]=[]),t[n]}function Cn(n,t,e){t[Pl]&&(t[ei]=!0,t[zr]=!0),t[Nl]&&(t[ei]=!0,t[Il]=!0),t[ei]&&(t[zr]=!0),t[Il]&&(t[zr]=!0),t[zr]&&(t[Rl]=!0),t[$g]&&(t[Rl]=!0);for(const r in t){const i=x_(r,e);i.indexOf(n)<0&&i.push(n)}}function v_(n,t){const e={};for(const r in t)t[r].indexOf(n)>=0&&(e[r]=!0);return e}function Ft(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Ft.groups={};Ft.prototype={accepts(){return!!this.t},go(n){const t=this,e=t.j[n];if(e)return e;for(let r=0;r<t.jr.length;r++){const i=t.jr[r][0],s=t.jr[r][1];if(s&&i.test(n))return s}return t.jd},has(n,t=!1){return t?n in this.j:!!this.go(n)},ta(n,t,e,r){for(let i=0;i<n.length;i++)this.tt(n[i],t,e,r)},tr(n,t,e,r){r=r||Ft.groups;let i;return t&&t.j?i=t:(i=new Ft(t),e&&r&&Cn(t,e,r)),this.jr.push([n,i]),i},ts(n,t,e,r){let i=this;const s=n.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(n[o]);return i.tt(n[s-1],t,e,r)},tt(n,t,e,r){r=r||Ft.groups;const i=this;if(t&&t.j)return i.j[n]=t,t;const s=t;let o,a=i.go(n);if(a?(o=new Ft,Object.assign(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new Ft,s){if(r)if(o.t&&typeof o.t=="string"){const l=Object.assign(v_(o.t,r),e);Cn(s,l,r)}else e&&Cn(s,e,r);o.t=s}return i.j[n]=o,o}};const W=(n,t,e,r,i)=>n.ta(t,e,r,i),at=(n,t,e,r,i)=>n.tr(t,e,r,i),qh=(n,t,e,r,i)=>n.ts(t,e,r,i),_=(n,t,e,r,i)=>n.tt(t,e,r,i),Ce="WORD",Ll="UWORD",zg="ASCIINUMERICAL",Fg="ALPHANUMERICAL",Mi="LOCALHOST",Bl="TLD",$l="UTLD",ys="SCHEME",Xn="SLASH_SCHEME",Lc="NUM",zl="WS",Bc="NL",ni="OPENBRACE",ri="CLOSEBRACE",Ks="OPENBRACKET",qs="CLOSEBRACKET",Js="OPENPAREN",Ys="CLOSEPAREN",Gs="OPENANGLEBRACKET",Xs="CLOSEANGLEBRACKET",Qs="FULLWIDTHLEFTPAREN",Zs="FULLWIDTHRIGHTPAREN",to="LEFTCORNERBRACKET",eo="RIGHTCORNERBRACKET",no="LEFTWHITECORNERBRACKET",ro="RIGHTWHITECORNERBRACKET",io="FULLWIDTHLESSTHAN",so="FULLWIDTHGREATERTHAN",oo="AMPERSAND",ao="APOSTROPHE",lo="ASTERISK",ze="AT",co="BACKSLASH",uo="BACKTICK",fo="CARET",Ve="COLON",$c="COMMA",ho="DOLLAR",fe="DOT",po="EQUALS",zc="EXCLAMATION",Jt="HYPHEN",ii="PERCENT",mo="PIPE",go="PLUS",yo="POUND",si="QUERY",Fc="QUOTE",Hg="FULLWIDTHMIDDLEDOT",Hc="SEMI",he="SLASH",oi="TILDE",bo="UNDERSCORE",Vg="EMOJI",xo="SYM";var Wg=Object.freeze({__proto__:null,ALPHANUMERICAL:Fg,AMPERSAND:oo,APOSTROPHE:ao,ASCIINUMERICAL:zg,ASTERISK:lo,AT:ze,BACKSLASH:co,BACKTICK:uo,CARET:fo,CLOSEANGLEBRACKET:Xs,CLOSEBRACE:ri,CLOSEBRACKET:qs,CLOSEPAREN:Ys,COLON:Ve,COMMA:$c,DOLLAR:ho,DOT:fe,EMOJI:Vg,EQUALS:po,EXCLAMATION:zc,FULLWIDTHGREATERTHAN:so,FULLWIDTHLEFTPAREN:Qs,FULLWIDTHLESSTHAN:io,FULLWIDTHMIDDLEDOT:Hg,FULLWIDTHRIGHTPAREN:Zs,HYPHEN:Jt,LEFTCORNERBRACKET:to,LEFTWHITECORNERBRACKET:no,LOCALHOST:Mi,NL:Bc,NUM:Lc,OPENANGLEBRACKET:Gs,OPENBRACE:ni,OPENBRACKET:Ks,OPENPAREN:Js,PERCENT:ii,PIPE:mo,PLUS:go,POUND:yo,QUERY:si,QUOTE:Fc,RIGHTCORNERBRACKET:eo,RIGHTWHITECORNERBRACKET:ro,SCHEME:ys,SEMI:Hc,SLASH:he,SLASH_SCHEME:Xn,SYM:xo,TILDE:oi,TLD:Bl,UNDERSCORE:bo,UTLD:$l,UWORD:Ll,WORD:Ce,WS:zl});const ke=/[a-z]/,Dr=new RegExp("\\p{L}","u"),ja=new RegExp("\\p{Emoji}","u"),Se=/\d/,Ua=/\s/,Jh="\r",Ka=`
`,k_="",S_="",qa="";let rs=null,is=null;function w_(n=[]){const t={};Ft.groups=t;const e=new Ft;rs==null&&(rs=Yh(m_)),is==null&&(is=Yh(g_)),_(e,"'",ao),_(e,"{",ni),_(e,"}",ri),_(e,"[",Ks),_(e,"]",qs),_(e,"(",Js),_(e,")",Ys),_(e,"<",Gs),_(e,">",Xs),_(e,"",Qs),_(e,"",Zs),_(e,"",to),_(e,"",eo),_(e,"",no),_(e,"",ro),_(e,"",io),_(e,"",so),_(e,"&",oo),_(e,"*",lo),_(e,"@",ze),_(e,"`",uo),_(e,"^",fo),_(e,":",Ve),_(e,",",$c),_(e,"$",ho),_(e,".",fe),_(e,"=",po),_(e,"!",zc),_(e,"-",Jt),_(e,"%",ii),_(e,"|",mo),_(e,"+",go),_(e,"#",yo),_(e,"?",si),_(e,'"',Fc),_(e,"/",he),_(e,";",Hc),_(e,"~",oi),_(e,"_",bo),_(e,"\\",co),_(e,"",Hg);const r=at(e,Se,Lc,{[Pl]:!0});at(r,Se,r);const i=at(r,ke,zg,{[ei]:!0}),s=at(r,Dr,Fg,{[zr]:!0}),o=at(e,ke,Ce,{[Nl]:!0});at(o,Se,i),at(o,ke,o),at(i,Se,i),at(i,ke,i);const a=at(e,Dr,Ll,{[Il]:!0});at(a,ke),at(a,Se,s),at(a,Dr,a),at(s,Se,s),at(s,ke),at(s,Dr,s);const l=_(e,Ka,Bc,{[Wa]:!0}),c=_(e,Jh,zl,{[Wa]:!0}),u=at(e,Ua,zl,{[Wa]:!0});_(e,qa,u),_(c,Ka,l),_(c,qa,u),at(c,Ua,u),_(u,Jh),_(u,Ka),at(u,Ua,u),_(u,qa,u);const f=at(e,ja,Vg,{[$g]:!0});_(f,"#"),at(f,ja,f),_(f,k_,f);const h=_(f,S_);_(h,"#"),at(h,ja,f);const d=[[ke,o],[Se,i]],p=[[ke,null],[Dr,a],[Se,s]];for(let m=0;m<rs.length;m++)Le(e,rs[m],Bl,Ce,d);for(let m=0;m<is.length;m++)Le(e,is[m],$l,Ll,p);Cn(Bl,{tld:!0,ascii:!0},t),Cn($l,{utld:!0,alpha:!0},t),Le(e,"file",ys,Ce,d),Le(e,"mailto",ys,Ce,d),Le(e,"http",Xn,Ce,d),Le(e,"https",Xn,Ce,d),Le(e,"ftp",Xn,Ce,d),Le(e,"ftps",Xn,Ce,d),Cn(ys,{scheme:!0,ascii:!0},t),Cn(Xn,{slashscheme:!0,ascii:!0},t),n=n.sort((m,g)=>m[0]>g[0]?1:-1);for(let m=0;m<n.length;m++){const g=n[m][0],b=n[m][1]?{[y_]:!0}:{[b_]:!0};g.indexOf("-")>=0?b[Rl]=!0:ke.test(g)?Se.test(g)?b[ei]=!0:b[Nl]=!0:b[Pl]=!0,qh(e,g,g,b)}return qh(e,"localhost",Mi,{ascii:!0}),e.jd=new Ft(xo),{start:e,tokens:Object.assign({groups:t},Wg)}}function jg(n,t){const e=M_(t.replace(/[A-Z]/g,a=>a.toLowerCase())),r=e.length,i=[];let s=0,o=0;for(;o<r;){let a=n,l=null,c=0,u=null,f=-1,h=-1;for(;o<r&&(l=a.go(e[o]));)a=l,a.accepts()?(f=0,h=0,u=a):f>=0&&(f+=e[o].length,h++),c+=e[o].length,s+=e[o].length,o++;s-=f,o-=h,c-=f,i.push({t:u.t,v:t.slice(s-c,s),s:s-c,e:s})}return i}function M_(n){const t=[],e=n.length;let r=0;for(;r<e;){let i=n.charCodeAt(r),s,o=i<55296||i>56319||r+1===e||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);t.push(o),r+=o.length}return t}function Le(n,t,e,r,i){let s;const o=t.length;for(let a=0;a<o-1;a++){const l=t[a];n.j[l]?s=n.j[l]:(s=new Ft(r),s.jr=i.slice(),n.j[l]=s),n=s}return s=new Ft(e),s.jr=i.slice(),n.j[t[o-1]]=s,s}function Yh(n){const t=[],e=[];let r=0,i="0123456789";for(;r<n.length;){let s=0;for(;i.indexOf(n[r+s])>=0;)s++;if(s>0){t.push(e.join(""));for(let o=parseInt(n.substring(r,r+s),10);o>0;o--)e.pop();r+=s}else e.push(n[r]),r++}return t}const Ci={defaultProtocol:"http",events:null,format:Gh,formatHref:Gh,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Vc(n,t=null){let e=Object.assign({},Ci);n&&(e=Object.assign(e,n instanceof Vc?n.o:n));const r=e.ignoreTags,i=[];for(let s=0;s<r.length;s++)i.push(r[s].toUpperCase());this.o=e,t&&(this.defaultRender=t),this.ignoreTags=i}Vc.prototype={o:Ci,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,t,e){const r=t!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=e.t in i?i[e.t]:Ci[n],typeof i=="function"&&r&&(i=i(t,e))):typeof i=="function"&&r&&(i=i(t,e.t,e)),i)},getObj(n,t,e){let r=this.o[n];return typeof r=="function"&&t!=null&&(r=r(t,e.t,e)),r},render(n){const t=n.render(this);return(this.get("render",null,n)||this.defaultRender)(t,n.t,n)}};function Gh(n){return n}function Ug(n,t){this.t="token",this.v=n,this.tk=t}Ug.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const t=this.toString(),e=n.get("truncate",t,this),r=n.get("format",t,this);return e&&r.length>e?r.substring(0,e)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Ci.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const t=this,e=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",e,this),i=n.get("tagName",e,t),s=this.toFormattedString(n),o={},a=n.get("className",e,t),l=n.get("target",e,t),c=n.get("rel",e,t),u=n.getObj("attributes",e,t),f=n.getObj("events",e,t);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&Object.assign(o,u),{tagName:i,attributes:o,content:s,eventListeners:f}}};function Ko(n,t){class e extends Ug{constructor(i,s){super(i,s),this.t=n}}for(const r in t)e.prototype[r]=t[r];return e.t=n,e}const Xh=Ko("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Qh=Ko("text"),C_=Ko("nl"),ss=Ko("url",{isLink:!0,toHref(n=Ci.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Mi&&n[1].t===Ve}}),qt=n=>new Ft(n);function T_({groups:n}){const t=n.domain.concat([oo,lo,ze,co,uo,fo,ho,po,Jt,Lc,ii,mo,go,yo,he,xo,oi,bo]),e=[ao,Ve,$c,fe,zc,ii,si,Fc,Hc,Gs,Xs,ni,ri,qs,Ks,Js,Ys,Qs,Zs,to,eo,no,ro,io,so],r=[oo,ao,lo,co,uo,fo,ho,po,Jt,ni,ri,ii,mo,go,yo,si,he,xo,oi,bo],i=qt(),s=_(i,oi);W(s,r,s),W(s,n.domain,s);const o=qt(),a=qt(),l=qt();W(i,n.domain,o),W(i,n.scheme,a),W(i,n.slashscheme,l),W(o,r,s),W(o,n.domain,o);const c=_(o,ze);_(s,ze,c),_(a,ze,c),_(l,ze,c);const u=_(s,fe);W(u,r,s),W(u,n.domain,s);const f=qt();W(c,n.domain,f),W(f,n.domain,f);const h=_(f,fe);W(h,n.domain,f);const d=qt(Xh);W(h,n.tld,d),W(h,n.utld,d),_(c,Mi,d);const p=_(f,Jt);_(p,Jt,p),W(p,n.domain,f),W(d,n.domain,f),_(d,fe,h),_(d,Jt,p);const m=_(d,Ve);W(m,n.numeric,Xh);const g=_(o,Jt),y=_(o,fe);_(g,Jt,g),W(g,n.domain,o),W(y,r,s),W(y,n.domain,o);const b=qt(ss);W(y,n.tld,b),W(y,n.utld,b),W(b,n.domain,o),W(b,r,s),_(b,fe,y),_(b,Jt,g),_(b,ze,c);const v=_(b,Ve),k=qt(ss);W(v,n.numeric,k);const x=qt(ss),w=qt();W(x,t,x),W(x,e,w),W(w,t,x),W(w,e,w),_(b,he,x),_(k,he,x);const S=_(a,Ve),M=_(l,Ve),E=_(M,he),I=_(E,he);W(a,n.domain,o),_(a,fe,y),_(a,Jt,g),W(l,n.domain,o),_(l,fe,y),_(l,Jt,g),W(S,n.domain,x),_(S,he,x),_(S,si,x),W(I,n.domain,x),W(I,t,x),_(I,he,x);const A=[[ni,ri],[Ks,qs],[Js,Ys],[Gs,Xs],[Qs,Zs],[to,eo],[no,ro],[io,so]];for(let z=0;z<A.length;z++){const[K,D]=A[z],C=_(x,K);_(w,K,C),_(C,D,x);const T=qt(ss);W(C,t,T);const P=qt();W(C,e),W(T,t,T),W(T,e,P),W(P,t,T),W(P,e,P),_(T,D,x),_(P,D,x)}return _(i,Mi,b),_(i,Bc,C_),{start:i,tokens:Wg}}function O_(n,t,e){let r=e.length,i=0,s=[],o=[];for(;i<r;){let a=n,l=null,c=null,u=0,f=null,h=-1;for(;i<r&&!(l=a.go(e[i].t));)o.push(e[i++]);for(;i<r&&(c=l||a.go(e[i].t));)l=null,a=c,a.accepts()?(h=0,f=a):h>=0&&h++,i++,u++;if(h<0)i-=u,i<r&&(o.push(e[i]),i++);else{o.length>0&&(s.push(Ja(Qh,t,o)),o=[]),i-=h,u-=h;const d=f.t,p=e.slice(i-u,i);s.push(Ja(d,t,p))}}return o.length>0&&s.push(Ja(Qh,t,o)),s}function Ja(n,t,e){const r=e[0].s,i=e[e.length-1].e,s=t.slice(r,i);return new n(s,e)}const __=typeof console<"u"&&console&&console.warn||(()=>{}),E_="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",et={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function A_(){return Ft.groups={},et.scanner=null,et.parser=null,et.tokenQueue=[],et.pluginQueue=[],et.customSchemes=[],et.initialized=!1,et}function Zh(n,t=!1){if(et.initialized&&__(`linkifyjs: already initialized - will not register custom scheme "${n}" ${E_}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);et.customSchemes.push([n,t])}function D_(){et.scanner=w_(et.customSchemes);for(let n=0;n<et.tokenQueue.length;n++)et.tokenQueue[n][1]({scanner:et.scanner});et.parser=T_(et.scanner.tokens);for(let n=0;n<et.pluginQueue.length;n++)et.pluginQueue[n][1]({scanner:et.scanner,parser:et.parser});return et.initialized=!0,et}function Wc(n){return et.initialized||D_(),O_(et.parser.start,n,jg(et.scanner.start,n))}Wc.scan=jg;function Kg(n,t=null,e=null){if(t&&typeof t=="object"){if(e)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);e=t,t=null}const r=new Vc(e),i=Wc(n),s=[];for(let o=0;o<i.length;o++){const a=i[o];a.isLink&&(!t||a.t===t)&&r.check(a)&&s.push(a.toFormattedObject(r))}return s}var jc="[\0- -\u2029]",P_=new RegExp(jc),N_=new RegExp(`${jc}$`),I_=new RegExp(jc,"g");function R_(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function L_(n){return new ot({key:new yt("autolink"),appendTransaction:(t,e,r)=>{const i=t.some(c=>c.docChanged)&&!e.doc.eq(r.doc),s=t.some(c=>c.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,a=hg(e.doc,[...t]);if(xg(a).forEach(({newRange:c})=>{const u=FT(r.doc,c,d=>d.isTextblock);let f,h;if(u.length>1)f=u[0],h=r.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(u.length){const d=r.doc.textBetween(c.from,c.to," "," ");if(!N_.test(d))return;f=u[0],h=r.doc.textBetween(f.pos,c.to,void 0," ")}if(f&&h){const d=h.split(P_).filter(Boolean);if(d.length<=0)return!1;const p=d[d.length-1],m=f.pos+h.lastIndexOf(p);if(!p)return!1;const g=Wc(p).map(y=>y.toObject(n.defaultProtocol));if(!R_(g))return!1;g.filter(y=>y.isLink).map(y=>({...y,from:m+y.start+1,to:m+y.end+1})).filter(y=>r.schema.marks.code?!r.doc.rangeHasMark(y.from,y.to,r.schema.marks.code):!0).filter(y=>n.validate(y.value)).filter(y=>n.shouldAutoLink(y.value)).forEach(y=>{Dc(y.from,y.to,r.doc).some(b=>b.mark.type===n.type)||o.addMark(y.from,y.to,n.type.create({href:y.href}))})}}),!!o.steps.length)return o}})}function B_(n){return new ot({key:new yt("handleClickLink"),props:{handleClick:(t,e,r)=>{var i,s;if(r.button!==0||!t.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{const l=r.target;if(!l)return!1;const c=n.editor.view.dom;o=l.closest("a"),o&&!c.contains(o)&&(o=null)}if(!o)return!1;let a=!1;if(n.enableClickSelection&&(a=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){const l=bg(t.state,n.type.name),c=(i=o.href)!=null?i:l.href,u=(s=o.target)!=null?s:l.target;c&&(window.open(c,u),a=!0)}return a}}})}function $_(n){return new ot({key:new yt("handlePasteLink"),props:{handlePaste:(t,e,r)=>{const{shouldAutoLink:i}=n,{state:s}=t,{selection:o}=s,{empty:a}=o;if(a)return!1;let l="";r.content.forEach(u=>{l+=u.textContent});const c=Kg(l,{defaultProtocol:n.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c||i!==void 0&&!i(c.value)?!1:n.editor.commands.setMark(n.type,{href:c.href})}}})}function dn(n,t){const e=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&e.push(i)}),!n||n.replace(I_,"").match(new RegExp(`^(?:(?:${e.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var z_=Vn.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){Zh(n);return}Zh(n.scheme,n.optionalSlashes)})},onDestroy(){A_()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,t)=>!!dn(n,t.protocols),validate:n=>!!n,shouldAutoLink:n=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(n),e=/^[a-z][a-z0-9+.-]*:/i.test(n);if(t||e&&!n.includes("@"))return!0;const i=(n.includes("@")?n.split("@").pop():n).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const t=n.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!dn(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:t=>!!dn(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",pt(this.options.HTMLAttributes,n),0]:["a",pt(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,t)=>t.applyMark("link",t.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,t)=>{var e,r,i,s;const o=(r=(e=n.attrs)==null?void 0:e.href)!=null?r:"",a=(s=(i=n.attrs)==null?void 0:i.title)!=null?s:"",l=t.renderChildren(n);return a?`[${l}](${o} "${a}")`:`[${l}](${o})`},addCommands(){return{setLink:n=>({chain:t})=>{const{href:e}=n;return this.options.isAllowedUri(e,{defaultValidate:r=>!!dn(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:t})=>{const{href:e}=n||{};return e&&!this.options.isAllowedUri(e,{defaultValidate:r=>!!dn(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[$n({find:n=>{const t=[];if(n){const{protocols:e,defaultProtocol:r}=this.options,i=Kg(n).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:o=>!!dn(o,e),protocols:e,defaultProtocol:r}));i.length&&i.forEach(s=>{this.options.shouldAutoLink(s.value)&&t.push({text:s.value,data:{href:s.href},index:s.start})})}return t},type:this.type,getAttributes:n=>{var t;return{href:(t=n.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:t,defaultProtocol:e}=this.options;return this.options.autolink&&n.push(L_({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!dn(i,t),protocols:t,defaultProtocol:e}),shouldAutoLink:this.options.shouldAutoLink})),n.push(B_({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push($_({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),F_=Object.defineProperty,H_=(n,t)=>{for(var e in t)F_(n,e,{get:t[e],enumerable:!0})},V_="listItem",td="textStyle",ed=/^\s*([-+*])\s$/,qg=Ut.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",pt(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?t.parseChildren(n.items):[]},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(V_,this.editor.getAttributes(td)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=gr({find:ed,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=gr({find:ed,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(td),editor:this.editor})),[n]}}),Jg=Ut.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",pt(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,t)=>{if(n.type!=="list_item")return[];let e=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(i=>i.type==="paragraph"))e=t.parseChildren(n.tokens);else{const i=n.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(e=[{type:"paragraph",content:t.parseInline(i.tokens)}],n.tokens.length>1){const o=n.tokens.slice(1),a=t.parseChildren(o);e.push(...a)}}else e=t.parseChildren(n.tokens)}return e.length===0&&(e=[{type:"paragraph",content:[]}]),{type:"listItem",content:e}},renderMarkdown:(n,t,e)=>Rc(n,t,r=>{var i,s;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((s=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:s.start)||1)+r.index}. `:"- "},e),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),W_={};H_(W_,{findListItemPos:()=>Ni,getNextListDepth:()=>Uc,handleBackspace:()=>Fl,handleDelete:()=>Hl,hasListBefore:()=>Yg,hasListItemAfter:()=>j_,hasListItemBefore:()=>Gg,listItemHasSubList:()=>Xg,nextListIsDeeper:()=>Qg,nextListIsHigher:()=>Zg});var Ni=(n,t)=>{const{$from:e}=t.selection,r=dt(n,t.schema);let i=null,s=e.depth,o=e.pos,a=null;for(;s>0&&a===null;)i=e.node(s),i.type===r?a=s:(s-=1,o-=1);return a===null?null:{$pos:t.doc.resolve(o),depth:a}},Uc=(n,t)=>{const e=Ni(n,t);if(!e)return!1;const[,r]=GT(t,n,e.$pos.pos+4);return r},Yg=(n,t,e)=>{const{$anchor:r}=n.selection,i=Math.max(0,r.pos-2),s=n.doc.resolve(i).node();return!(!s||!e.includes(s.type.name))},Gg=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-2);return!(i.index()===0||((e=i.nodeBefore)==null?void 0:e.type.name)!==n)},Xg=(n,t,e)=>{if(!e)return!1;const r=dt(n,t.schema);let i=!1;return e.descendants(s=>{s.type===r&&(i=!0)}),i},Fl=(n,t,e)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!rn(n.state,t)&&Yg(n.state,t,e)){const{$anchor:a}=n.state.selection,l=n.state.doc.resolve(a.before()-1),c=[];l.node().descendants((h,d)=>{h.type.name===t&&c.push({node:h,pos:d})});const u=c.at(-1);if(!u)return!1;const f=n.state.doc.resolve(l.start()+u.pos+1);return n.chain().cut({from:a.start()-1,to:a.end()+1},f.end()).joinForward().run()}if(!rn(n.state,t)||!tO(n.state))return!1;const r=Ni(t,n.state);if(!r)return!1;const s=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=Xg(t,n.state,s);return Gg(t,n.state)&&!o?n.commands.joinItemBackward():n.chain().liftListItem(t).run()},Qg=(n,t)=>{const e=Uc(n,t),r=Ni(n,t);return!r||!e?!1:e>r.depth},Zg=(n,t)=>{const e=Uc(n,t),r=Ni(n,t);return!r||!e?!1:e<r.depth},Hl=(n,t)=>{if(!rn(n.state,t)||!ZT(n.state,t))return!1;const{selection:e}=n.state,{$from:r,$to:i}=e;return!e.empty&&r.sameParent(i)?!1:Qg(t,n.state)?n.chain().focus(n.state.selection.from+4).lift(t).joinBackward().run():Zg(t,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},j_=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((e=i.nodeAfter)==null?void 0:e.type.name)!==n)},ty=ft.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&Hl(n,e)&&(t=!0)}),t},"Mod-Delete":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&Hl(n,e)&&(t=!0)}),t},Backspace:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&Fl(n,e,r)&&(t=!0)}),t},"Mod-Backspace":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&Fl(n,e,r)&&(t=!0)}),t}}}}),nd=/^(\s*)(\d+)\.\s+(.*)$/,U_=/^\s/;function K_(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e],s=i.match(nd);if(!s)break;const[,o,a,l]=s,c=o.length;let u=l,f=e+1;const h=[i];for(;f<n.length;){const d=n[f];if(d.match(nd))break;if(d.trim()==="")h.push(d),u+=`
`,f+=1;else if(d.match(U_))h.push(d),u+=`
${d.slice(c+2)}`,f+=1;else break}t.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:h.join(`
`)}),r=f,e=f}return[t,r]}function ey(n,t,e){var r;const i=[];let s=0;for(;s<n.length;){const o=n[s];if(o.indent===t){const a=o.content.split(`
`),l=((r=a[0])==null?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:e.inlineTokens(l)});const u=a.slice(1).join(`
`).trim();if(u){const d=e.blockTokens(u);c.push(...d)}let f=s+1;const h=[];for(;f<n.length&&n[f].indent>t;)h.push(n[f]),f+=1;if(h.length>0){const d=Math.min(...h.map(m=>m.indent)),p=ey(h,d,e);c.push({type:"list",ordered:!0,start:h[0].number,items:p,raw:h.map(m=>m.raw).join(`
`)})}i.push({type:"list_item",raw:o.raw,tokens:c}),s=f}else s+=1}return i}function q_(n,t){return n.map(e=>{if(e.type!=="list_item")return t.parseChildren([e])[0];const r=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...t.parseChildren([i]));else if(i.type==="text"&&i.tokens){const s=t.parseChildren([i]);r.push({type:"paragraph",content:s})}else{const s=t.parseChildren([i]);s.length>0&&r.push(...s)}}),{type:"listItem",content:r}})}var J_="listItem",rd="textStyle",id=/^(\d+)\.\s$/,ny=Ut.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:t,...e}=n;return t===1?["ol",pt(this.options.HTMLAttributes,e),0]:["ol",pt(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>{if(n.type!=="list"||!n.ordered)return[];const e=n.start||1,r=n.items?q_(n.items,t):[];return e!==1?{type:"orderedList",attrs:{start:e},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const t=n.match(/^(\s*)(\d+)\.\s+/),e=t==null?void 0:t.index;return e!==void 0?e:-1},tokenize:(n,t,e)=>{var r;const i=n.split(`
`),[s,o]=K_(i);if(s.length===0)return;const a=ey(s,0,e);return a.length===0?void 0:{type:"list",ordered:!0,start:((r=s[0])==null?void 0:r.number)||1,items:a,raw:i.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(J_,this.editor.getAttributes(rd)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=gr({find:id,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=gr({find:id,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(rd)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[n]}}),Y_=/^\s*(\[([( |x])?\])\s$/,G_=Ut.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const t=n.getAttribute("data-checked");return t===""||t==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:t}){return["li",pt(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,t)=>{const e=[];if(n.tokens&&n.tokens.length>0?e.push(t.createNode("paragraph",{},t.parseInline(n.tokens))):n.text?e.push(t.createNode("paragraph",{},[t.createNode("text",{text:n.text})])):e.push(t.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=t.parseChildren(n.nestedTokens);e.push(...r)}return t.createNode("taskItem",{checked:n.checked||!1},e)},renderMarkdown:(n,t)=>{var e;const i=`- [${(e=n.attrs)!=null&&e.checked?"x":" "}] `;return Rc(n,t,i)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:t,getPos:e,editor:r})=>{const i=document.createElement("li"),s=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=f=>{var h,d;a.ariaLabel=((d=(h=this.options.a11y)==null?void 0:h.checkboxLabel)==null?void 0:d.call(h,f,a.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};c(n),s.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",f=>f.preventDefault()),a.addEventListener("change",f=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:h}=f.target;r.isEditable&&typeof e=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const p=e();if(typeof p!="number")return!1;const m=d.doc.nodeAt(p);return d.setNodeMarkup(p,void 0,{...m==null?void 0:m.attrs,checked:h}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,h)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,h])=>{i.setAttribute(f,h)}),i.dataset.checked=n.attrs.checked,a.checked=n.attrs.checked,s.append(a,o),i.append(s,l),Object.entries(t).forEach(([f,h])=>{i.setAttribute(f,h)});let u=new Set(Object.keys(t));return{dom:i,contentDOM:l,update:f=>{if(f.type!==this.type)return!1;i.dataset.checked=f.attrs.checked,a.checked=f.attrs.checked,c(f);const h=r.extensionManager.attributes,d=wi(f,h),p=new Set(Object.keys(d)),m=this.options.HTMLAttributes;return u.forEach(g=>{p.has(g)||(g in m?i.setAttribute(g,m[g]):i.removeAttribute(g))}),Object.entries(d).forEach(([g,y])=>{y==null?g in m?i.setAttribute(g,m[g]):i.removeAttribute(g):i.setAttribute(g,y)}),u=p,!0}}}},addInputRules(){return[gr({find:Y_,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),X_=Ut.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",pt(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,t)=>t.createNode("taskList",{},t.parseChildren(n.items||[])),renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var t;const e=(t=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return e!==void 0?e:-1},tokenize(n,t,e){const r=s=>{const o=Dl(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:e.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},e);return o?[{type:"taskList",raw:o.raw,items:o.items}]:e.blockTokens(s)},i=Dl(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,o)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:e.inlineTokens(s.mainContent),nestedTokens:o}),customNestedParser:r},e);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});ft.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(qg.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(Jg.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(ty.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(ny.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(G_.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(X_.configure(this.options.taskList)),n}});var sd="&nbsp;",Q_="",Z_=Ut.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",pt(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,t)=>{const e=n.tokens||[];if(e.length===1&&e[0].type==="image")return t.parseChildren([e[0]]);const r=t.parseInline(e);return r.length===1&&r[0].type==="text"&&(r[0].text===sd||r[0].text===Q_)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,r)},renderMarkdown:(n,t)=>{if(!n)return"";const e=Array.isArray(n.content)?n.content:[];return e.length===0?sd:t.renderChildren(e)},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),tE=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,eE=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,nE=Vn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",pt(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,t)=>t.applyMark("strike",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`~~${t.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[mr({find:tE,type:this.type})]},addPasteRules(){return[$n({find:eE,type:this.type})]}}),rE=Ut.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),iE=Vn.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",pt(this.options.HTMLAttributes,n),0]},parseMarkdown(n,t){return t.applyMark(this.name||"underline",t.parseInline(n.tokens||[]))},renderMarkdown(n,t){return`++${t.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,t,e){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!i)return;const s=i[2].trim();return{type:"underline",raw:i[0],text:s,tokens:e.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function sE(n={}){return new ot({view(t){return new oE(t,n)}})}class oE{constructor(t,e){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=e.width)!==null&&r!==void 0?r:1,this.color=e.color===!1?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return t.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){this.cursorPos!=null&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),e=!t.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,a=s.height/i.offsetHeight;if(e){let f=t.nodeBefore,h=t.nodeAfter;if(f||h){let d=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(d){let p=d.getBoundingClientRect(),m=f?p.bottom:p.top;f&&h&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let g=this.width/2*a;r={left:p.left,right:p.right,top:m-g,bottom:m+g}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*o;r={left:f.left-h,right:f.left+h,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",e),this.element.classList.toggle("prosemirror-dropcursor-inline",!e);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let f=l.getBoundingClientRect(),h=f.width/l.offsetWidth,d=f.height/l.offsetHeight;c=f.left-l.scrollLeft*h,u=f.top-l.scrollTop*d}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,e,t):i;if(e&&!s){let o=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=rm(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class ct extends j{constructor(t){super(t,t)}map(t,e){let r=t.resolve(e.map(this.head));return ct.valid(r)?new ct(r):j.near(r)}content(){return R.empty}eq(t){return t instanceof ct&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ct(t.resolve(e.pos))}getBookmark(){return new Kc(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!aE(t)||!lE(t))return!1;let r=e.type.spec.allowGapCursor;if(r!=null)return r;let i=e.contentMatchAt(t.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(t,e,r=!1){t:for(;;){if(!r&&ct.valid(t))return t;let i=t.pos,s=null;for(let o=t.depth;;o--){let a=t.node(o);if(e>0?t.indexAfter(o)<a.childCount:t.index(o)>0){s=a.child(e>0?t.indexAfter(o):t.index(o)-1);break}else if(o==0)return null;i+=e;let l=t.doc.resolve(i);if(ct.valid(l))return l}for(;;){let o=e>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!B.isSelectable(s)){t=t.doc.resolve(i+s.nodeSize*e),r=!1;continue t}break}s=o,i+=e;let a=t.doc.resolve(i);if(ct.valid(a))return a}return null}}}ct.prototype.visible=!1;ct.findFrom=ct.findGapCursorFrom;j.jsonID("gapcursor",ct);class Kc{constructor(t){this.pos=t}map(t){return new Kc(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return ct.valid(e)?new ct(e):j.near(e)}}function ry(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function aE(n){for(let t=n.depth;t>=0;t--){let e=n.index(t),r=n.node(t);if(e==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||ry(i.type))return!0;if(i.inlineContent)return!1}}return!0}function lE(n){for(let t=n.depth;t>=0;t--){let e=n.indexAfter(t),r=n.node(t);if(e==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||ry(i.type))return!0;if(i.inlineContent)return!1}}return!0}function cE(){return new ot({props:{decorations:dE,createSelectionBetween(n,t,e){return t.pos==e.pos&&ct.valid(e)?new ct(e):null},handleClick:fE,handleKeyDown:uE,handleDOMEvents:{beforeinput:hE}}})}const uE=ig({ArrowLeft:as("horiz",-1),ArrowRight:as("horiz",1),ArrowUp:as("vert",-1),ArrowDown:as("vert",1)});function as(n,t){const e=n=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,i,s){let o=r.selection,a=t>0?o.$to:o.$from,l=o.empty;if(o instanceof H){if(!s.endOfTextblock(e)||a.depth==0)return!1;l=!1,a=r.doc.resolve(t>0?a.after():a.before())}let c=ct.findGapCursorFrom(a,t,l);return c?(i&&i(r.tr.setSelection(new ct(c))),!0):!1}}function fE(n,t,e){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(t);if(!ct.valid(r))return!1;let i=n.posAtCoords({left:e.clientX,top:e.clientY});return i&&i.inside>-1&&B.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ct(r))),!0)}function hE(n,t){if(t.inputType!="insertCompositionText"||!(n.state.selection instanceof ct))return!1;let{$from:e}=n.state.selection,r=e.parent.contentMatchAt(e.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=O.empty;for(let o=r.length-1;o>=0;o--)i=O.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(e.pos,e.pos,new R(i,0,0));return s.setSelection(H.near(s.doc.resolve(e.pos+1))),n.dispatch(s),!1}function dE(n){if(!(n.selection instanceof ct))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",st.create(n.doc,[It.widget(n.selection.head,t,{key:"gapcursor"})])}var vo=200,wt=function(){};wt.prototype.append=function(t){return t.length?(t=wt.from(t),!this.length&&t||t.length<vo&&this.leafAppend(t)||this.length<vo&&t.leafPrepend(this)||this.appendInner(t)):this};wt.prototype.prepend=function(t){return t.length?wt.from(t).append(this):this};wt.prototype.appendInner=function(t){return new pE(this,t)};wt.prototype.slice=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=this.length),t>=e?wt.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))};wt.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};wt.prototype.forEach=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length),e<=r?this.forEachInner(t,e,r,0):this.forEachInvertedInner(t,e,r,0)};wt.prototype.map=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(t(s,o))},e,r),i};wt.from=function(t){return t instanceof wt?t:t&&t.length?new iy(t):wt.empty};var iy=function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new t(this.values.slice(i,s))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(i(this.values[l],a+l)===!1)return!1},t.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(i(this.values[l],a+l)===!1)return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=vo)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=vo)return new t(i.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t}(wt);wt.empty=new iy([]);var pE=function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(s,a),o)===!1||s>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(i,a),s,o)===!1)return!1},t.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(wt);const mE=500;class ne{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;e&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=t.tr,a,l,c=[],u=[];return this.items.forEach((f,h)=>{if(!f.step){i||(i=this.remapping(r,h+1),s=i.maps.length),s--,u.push(f);return}if(i){u.push(new de(f.map));let d=f.step.map(i.slice(s)),p;d&&o.maybeStep(d).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new de(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(f.step);if(f.selection)return a=i?f.selection.map(i.slice(s)):f.selection,l=new ne(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(t,e,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<t.steps.length;u++){let f=t.steps[u].invert(t.docs[u]),h=new de(t.mapping.maps[u],f,e),d;(d=l&&l.merge(h))&&(h=d,u?s.pop():a=a.slice(0,a.length-1)),s.push(h),e&&(o++,e=void 0),i||(l=h)}let c=o-r.depth;return c>yE&&(a=gE(a,c),o-=c),new ne(a.append(s),o)}remapping(t,e){let r=new yi;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},t,e),r}addMaps(t){return this.eventCount==0?this:new ne(this.items.append(t.map(e=>new de(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-e),s=t.mapping,o=t.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},i);let l=e;this.items.forEach(h=>{let d=s.getMirror(--l);if(d==null)return;o=Math.min(o,d);let p=s.maps[d];if(h.step){let m=t.steps[d].invert(t.docs[d]),g=h.selection&&h.selection.map(s.slice(l+1,d));g&&a++,r.push(new de(p,m,g))}else r.push(new de(p))},i);let c=[];for(let h=e;h<o;h++)c.push(new de(s.maps[h]));let u=this.items.slice(0,i).append(c).append(r),f=new ne(u,a);return f.emptyItemCount()>mE&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=t)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(e.slice(r)),c=l&&l.getMap();if(r--,c&&e.appendMap(c,r),l){let u=o.selection&&o.selection.map(e.slice(r));u&&s++;let f=new de(c.invert(),l,u),h,d=i.length-1;(h=i.length&&i[d].merge(f))?i[d]=h:i.push(f)}}else o.map&&r--},this.items.length,0),new ne(wt.from(i.reverse()),s)}}ne.empty=new ne(wt.empty,0);function gE(n,t){let e;return n.forEach((r,i)=>{if(r.selection&&t--==0)return e=i,!1}),n.slice(e)}class de{constructor(t,e,r,i){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new de(e.getMap().invert(),e,this.selection)}}}class Fe{constructor(t,e,r,i,s){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const yE=20;function bE(n,t,e,r){let i=e.getMeta(Pn),s;if(i)return i.historyState;e.getMeta(kE)&&(n=new Fe(n.done,n.undone,null,0,-1));let o=e.getMeta("appendedTransaction");if(e.steps.length==0)return n;if(o&&o.getMeta(Pn))return o.getMeta(Pn).redo?new Fe(n.done.addTransform(e,void 0,r,bs(t)),n.undone,od(e.mapping.maps),n.prevTime,n.prevComposition):new Fe(n.done,n.undone.addTransform(e,void 0,r,bs(t)),null,n.prevTime,n.prevComposition);if(e.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=e.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(e.time||0)-r.newGroupDelay||!xE(e,n.prevRanges)),c=o?Ya(n.prevRanges,e.mapping):od(e.mapping.maps);return new Fe(n.done.addTransform(e,l?t.selection.getBookmark():void 0,r,bs(t)),ne.empty,c,e.time,a??n.prevComposition)}else return(s=e.getMeta("rebased"))?new Fe(n.done.rebased(e,s),n.undone.rebased(e,s),Ya(n.prevRanges,e.mapping),n.prevTime,n.prevComposition):new Fe(n.done.addMaps(e.mapping.maps),n.undone.addMaps(e.mapping.maps),Ya(n.prevRanges,e.mapping),n.prevTime,n.prevComposition)}function xE(n,t){if(!t)return!1;if(!n.docChanged)return!0;let e=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<t.length;s+=2)r<=t[s+1]&&i>=t[s]&&(e=!0)}),e}function od(n){let t=[];for(let e=n.length-1;e>=0&&t.length==0;e--)n[e].forEach((r,i,s,o)=>t.push(s,o));return t}function Ya(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let i=t.map(n[r],1),s=t.map(n[r+1],-1);i<=s&&e.push(i,s)}return e}function vE(n,t,e){let r=bs(t),i=Pn.get(t).spec.config,s=(e?n.undone:n.done).popEvent(t,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(e?n.done:n.undone).addTransform(s.transform,t.selection.getBookmark(),i,r),l=new Fe(e?a:s.remaining,e?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(Pn,{redo:e,historyState:l})}let Ga=!1,ad=null;function bs(n){let t=n.plugins;if(ad!=t){Ga=!1,ad=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){Ga=!0;break}}return Ga}const Pn=new yt("history"),kE=new yt("closeHistory");function SE(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new ot({key:Pn,state:{init(){return new Fe(ne.empty,ne.empty,null,0,-1)},apply(t,e,r){return bE(e,r,t,n)}},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,i=r=="historyUndo"?oy:r=="historyRedo"?ay:null;return!i||!t.editable?!1:(e.preventDefault(),i(t.state,t.dispatch))}}}})}function sy(n,t){return(e,r)=>{let i=Pn.getState(e);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let s=vE(i,e,n);s&&r(t?s.scrollIntoView():s)}return!0}}const oy=sy(!1,!0),ay=sy(!0,!0);ft.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const t=(n==null?void 0:n.node)||this.editor.state.doc;if(((n==null?void 0:n.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=n=>{const t=(n==null?void 0:n.node)||this.editor.state.doc,e=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(e)}},addProseMirrorPlugins(){let n=!1;return[new ot({key:new yt("characterCount"),appendTransaction:(t,e,r)=>{if(n)return;const i=this.options.limit;if(i==null||i===0){n=!0;return}const s=this.storage.characters({node:r.doc});if(s>i){const o=s-i,a=0,l=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(a,l);return n=!0,c}n=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:e.doc}),s=this.storage.characters({node:t.doc});if(s<=r||i>r&&s>r&&s<=i)return!0;if(i>r&&s>r&&s>i||!t.getMeta("paste"))return!1;const a=t.selection.$head.pos,l=s-r,c=a-l,u=a;return t.deleteRange(c,u),!(this.storage.characters({node:t.doc})>r)}})]}});var wE=ft.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[sE(this.options)]}});ft.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new ot({key:new yt("focus"),props:{decorations:({doc:n,selection:t})=>{const{isEditable:e,isFocused:r}=this.editor,{anchor:i}=t,s=[];if(!e||!r)return st.create(n,[]);let o=0;this.options.mode==="deepest"&&n.descendants((l,c)=>{if(l.isText)return;if(!(i>=c&&i<=c+l.nodeSize-1))return!1;o+=1});let a=0;return n.descendants((l,c)=>{if(l.isText||!(i>=c&&i<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&o-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";s.push(It.node(c,c+l.nodeSize,{class:this.options.className}))}),st.create(n,s)}}})]}});var ME=ft.create({name:"gapCursor",addProseMirrorPlugins(){return[cE()]},extendNodeSchema(n){var t;const e={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(t=G(L(n,"allowGapCursor",e)))!=null?t:null}}}),ld="placeholder";function CE(n){return n.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var TE=ft.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:ld,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const n=this.options.dataAttribute?`data-${CE(this.options.dataAttribute)}`:`data-${ld}`;return[new ot({key:new yt("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,s=[];if(!r)return null;const o=this.editor.isEmpty;return t.descendants((a,l)=>{const c=i>=l&&i<=l+a.nodeSize,u=!a.isLeaf&&Wo(a);if((c||!this.options.showOnlyCurrent)&&u){const f=[this.options.emptyNodeClass];o&&f.push(this.options.emptyEditorClass);const h=It.node(l,l+a.nodeSize,{class:f.join(" "),[n]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:l,hasAnchor:c}):this.options.placeholder});s.push(h)}return this.options.includeChildren}),st.create(t,s)}}})]}});ft.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:t}=this;return[new ot({key:new yt("selection"),props:{decorations(e){return e.selection.empty||n.isFocused||!n.isEditable||vg(e.selection)||n.view.dragging?null:st.create(e.doc,[It.inline(e.selection.from,e.selection.to,{class:t.className})])}}})]}});function cd({types:n,node:t}){return t&&Array.isArray(n)&&n.includes(t.type)||(t==null?void 0:t.type)===n}var OE=ft.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const t=new yt(this.name),e=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(e).includes(i.name));return[new ot({key:t,appendTransaction:(i,s,o)=>{const{doc:a,tr:l,schema:c}=o,u=t.getState(o),f=a.content.size,h=c.nodes[e];if(u)return l.insert(f,h.create())},state:{init:(i,s)=>{const o=s.tr.doc.lastChild;return!cd({node:o,types:r})},apply:(i,s)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return s;const o=i.doc.lastChild;return!cd({node:o,types:r})}}})]}}),_E=ft.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:t})=>oy(n,t),redo:()=>({state:n,dispatch:t})=>ay(n,t)}},addProseMirrorPlugins(){return[SE(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),EE=ft.create({name:"starterKit",addExtensions(){var n,t,e,r;const i=[];return this.options.bold!==!1&&i.push(ZO.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(JO.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(qg.configure(this.options.bulletList)),this.options.code!==!1&&i.push(n_.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(s_.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(o_.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(wE.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(ME.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(a_.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(l_.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(_E.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(c_.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(p_.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Jg.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(ty.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&i.push(z_.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&i.push(ny.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(Z_.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(nE.configure(this.options.strike)),this.options.text!==!1&&i.push(rE.configure(this.options.text)),this.options.underline!==!1&&i.push(iE.configure((e=this.options)==null?void 0:e.underline)),this.options.trailingNode!==!1&&i.push(OE.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),UE=EE,KE=TE;export{gn as C,WE as E,ba as L,NE as N,Sa as P,BE as a,Af as b,Pe as c,RE as d,Pf as e,kn as f,yr as g,HE as h,LE as i,zE as j,$E as k,PE as l,VE as m,UE as n,DE as o,FE as p,KE as q,IE as r};
