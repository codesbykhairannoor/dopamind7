import{T as Y,y as N,N as S,z as E,r as V,k as R,c as _,b as i,t as v,u as D,j as q,n as I,F as z,p as L,o as k,h as O,q as P}from"./app-Cbyo9c8T.js";import{u as A}from"./useFinanceFormat-CzVGBJm8.js";import{d as T}from"./dayjs.min-BsXsFhVL.js";import{S as C}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";function J(){const{cleanAmount:x}=A(),o=(e,s)=>{const p=N(e);return p!==e?p:s},c=(e,s)=>{C.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,background:"#4f46e5",iconColor:"#ffffff",icon:e,title:`<span style="color: white; font-weight: 900; font-size: 14px; line-height: 1.2;">${s}</span>`,customClass:{container:"!fixed !top-5 !right-5 !p-0 !z-[100000] !items-start !justify-end",popup:"!flex !items-center !gap-3 !py-3 !px-6 !rounded-full !shadow-2xl !border-none !m-0 !w-auto !min-w-[280px]",timerProgressBar:"!bg-white/40 !h-1 !rounded-b-full"}})},y={customClass:{popup:"rounded-[2.5rem] p-8 border border-slate-100 shadow-2xl",title:"text-2xl font-black text-slate-800 mb-2 font-sans",confirmButton:"bg-indigo-600 text-white font-bold py-3.5 px-8 rounded-2xl shadow-xl active:scale-95 transition-all outline-none mx-2 tracking-wide",cancelButton:"bg-slate-50 text-slate-400 font-bold py-3.5 px-8 rounded-2xl hover:bg-slate-100 active:scale-95 transition-all outline-none mx-2 tracking-wide",actions:"mt-6 gap-3"},buttonsStyling:!1,focusConfirm:!1},m=(e,s)=>C.fire({...y,title:o(e,s),icon:"warning",showCancelButton:!0,confirmButtonText:o("btn_yes_delete","Yes, Delete!"),cancelButtonText:o("btn_cancel","Cancel"),customClass:{...y.customClass,confirmButton:"bg-rose-500 text-white font-bold py-3.5 px-8 rounded-2xl shadow-xl shadow-rose-200"}}),a=Y({id:null,title:"",amount:"",type:"expense",category:"",date:T().format("YYYY-MM-DD"),notes:""}),w=e=>{a.id=e.id,a.title=e.title??"",a.amount=e.amount,a.type=e.type,a.category=e.category,a.date=e.date,a.notes=e.notes??""},F=({onOptimistic:e,onSuccess:s,onError:p})=>{if(!a.title||a.title.trim()==="")return c("warning",o("warn_empty_title","Title is required!"));if(!a.amount||x(a.amount)<=0)return c("warning",o("warn_empty_amount","Amount required!"));if(!a.category)return c("warning",o("warn_empty_category","Please select a category!"));const l={...a.data()},d=!!l.id,f=d?l.id:"temp_"+Date.now(),g=d?route("finance.transaction.update",l.id):route("finance.transaction.store"),h=d?"patch":"post";e&&e({...l,id:f,amount:x(l.amount),created_at:new Date().toISOString()},d),c("success",o("success_saved","Saved successfully!")),a.transform(b=>({...b,amount:x(b.amount)}))[h](g,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{a.reset(),a.date=T().format("YYYY-MM-DD"),s&&s()},onError:b=>{p&&p(f,d),c("error",Object.values(b)[0])}})},M=(e,{onOptimistic:s,onSuccess:p,onError:l})=>{m("delete_trx_title","Delete Transaction?").then(d=>{d.isConfirmed&&(s&&s(e),c("success",o("success_deleted","Deleted!")),S.delete(route("finance.transaction.destroy",e),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{p&&p()},onError:()=>{l&&l(e),c("error","Failed to delete data")}}))})},t=Y({id:null,category:"",name:"",icon:"ðŸ’¸",limit_amount:"",month:""}),n=(e,{onOptimistic:s,onSuccess:p,onError:l})=>{if(t.month=e,!t.name)return c("warning",o("warn_empty_budget_name","Enter budget name!"));const d=x(t.limit_amount);if(!d||d<=0)return c("warning",o("warn_empty_amount","Valid amount required!"));!t.category&&t.name&&(t.category=t.name.toLowerCase().replace(/\s+/g,"_"));const f={...t.data()},g=!!f.id,h=g?f.id:"temp_"+Date.now(),b=g?route("finance.budget.update",f.id):route("finance.budget.store"),$=g?"put":"post";s&&s({...f,id:h,limit_amount:d},g),c("success",o("success_saved","Budget updated!")),t.transform(B=>({...B,limit_amount:x(B.limit_amount)}))[$](b,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{t.reset(),p&&p()},onError:B=>{l&&l(h,g),c("error",Object.values(B)[0])}})},r=(e,{onOptimistic:s,onSuccess:p,onError:l})=>{m("delete_budget_title","Delete Budget?").then(d=>{d.isConfirmed&&(s&&s(e),c("success",o("success_deleted","Budget removed!")),S.delete(route("finance.budget.destroy",e),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{p&&p()},onError:()=>{l&&l(e),c("error","Failed to delete budget")}}))})},u=Y({id:null,name:"",icon:"ðŸ’°",type:"income",slug:""});return{transactionForm:a,setEditTransaction:w,submitTransaction:F,deleteTransaction:M,budgetForm:t,submitBudget:n,deleteBudget:r,categoryForm:u,setEditCategory:e=>{u.id=e.id,u.name=e.name,u.icon=e.icon,u.type=e.type,u.slug=e.slug},submitCategory:({onOptimistic:e,onSuccess:s,onError:p})=>{if(!u.name)return c("warning",o("warn_empty_category_name","Name required!"));const l={...u.data()},d=!!l.id,f=d?l.id:"temp_"+Date.now(),g=d?route("finance.categories.update",l.id):route("finance.categories.store"),h=d?"put":"post";d||(l.slug=l.name.toLowerCase().replace(/\s+/g,"_")),e&&e({...l,id:f},d),c("success",o("success_saved","Category saved!")),u[h](g,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{u.reset(),s&&s()},onError:b=>{p&&p(f,d),c("error",Object.values(b)[0])}})},deleteCategory:(e,{onOptimistic:s,onSuccess:p,onError:l})=>{m("confirm_delete_title","Are you sure?").then(d=>{d.isConfirmed&&(s&&s(e.id),c("success",o("success_deleted","Deleted!")),S.delete(route("finance.categories.destroy",e.id),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{p&&p()},onError:()=>{l&&l(e.id),c("error","Failed to delete data")}}))})},updateIncomeTarget:(e,s)=>{S.post(route("finance.income-target.update"),{month:e,amount:s},{preserveScroll:!0,preserveState:!0,progress:!1})},t:o}}const K={class:"mt-6 space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-700"},Q={class:"bg-indigo-900 rounded-[2.5rem] p-1 shadow-2xl shadow-indigo-200/50 relative overflow-hidden group"},W={class:"relative z-10 p-6"},G={class:"flex justify-between items-start mb-6"},H={class:"text-2xl font-black text-white tracking-tighter"},X={key:0,class:"space-y-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-1"},Z={class:"flex-1 min-w-0 mr-3"},ee={class:"flex items-center gap-2 mb-1"},te={class:"text-xs font-black text-white truncate"},ae={class:"text-[9px] font-bold px-1.5 py-0.5 rounded bg-white/10 text-white/70"},oe={class:"flex items-center gap-2"},se=["onUpdate:modelValue"],ne={class:"text-right"},re=["onClick"],le={key:1,class:"py-8 text-center border-2 border-dashed border-white/10 rounded-3xl opacity-50"},ie={__name:"FinanceInsights",props:{expenseStats:{type:Object,default:()=>({})},incomeStats:{type:Object,default:()=>({})},budgets:{type:Array,default:()=>[]}},setup(x){const{formatMoney:o,cleanAmount:c}=A(),{submitTransaction:y,transactionForm:m}=J(),a=V([]);E(()=>{const t=localStorage.getItem("OneForMind_assets");t&&(a.value=JSON.parse(t))}),R(a,t=>localStorage.setItem("OneForMind_assets",JSON.stringify(t)),{deep:!0});const w=q(()=>{const t=a.value.reduce((r,u)=>r+Number(u.capital)*(1+Number(u.percent)/100),0),n=a.value.reduce((r,u)=>r+Number(u.capital),0);return{currentValue:t,totalReturn:t-n}}),F=()=>{C.fire({title:'<span class="text-xl font-black text-slate-800">Alokasi Aset Baru</span>',html:`
            <div class="flex flex-col gap-3 text-left">
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1">Nama Aset</label>
                    <input id="swal-name" class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm font-bold text-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all" placeholder="Contoh: Saham BBCA">
                </div>
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1">Modal (Rp)</label>
                    <input id="swal-capital" type="number" class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm font-bold text-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all" placeholder="0">
                    <p class="text-[10px] text-rose-500 mt-1 font-bold italic">*Akan tercatat sebagai Pengeluaran.</p>
                </div>
            </div>
        `,showCancelButton:!0,confirmButtonText:"Konfirmasi & Bayar",cancelButtonText:"Batal",customClass:{popup:"!rounded-[2.5rem] !p-8 !border !border-slate-100 !shadow-2xl",confirmButton:"!bg-indigo-600 !text-white !font-bold !py-3 !px-6 !rounded-xl !shadow-lg !shadow-indigo-200 !text-xs !uppercase !tracking-widest",cancelButton:"!bg-slate-100 !text-slate-500 !font-bold !py-3 !px-6 !rounded-xl !text-xs !uppercase !tracking-widest",actions:"!mt-6 !gap-2"},backdrop:"rgba(15, 23, 42, 0.6) backdrop-blur-sm",preConfirm:()=>{const t=document.getElementById("swal-name").value,n=document.getElementById("swal-capital").value,r=c(n);return!t||r<=0?(C.showValidationMessage("Nama dan Modal wajib diisi!"),!1):{name:t,capital:r}}}).then(t=>{if(t.isConfirmed){const{name:n,capital:r}=t.value;m.reset(),m.title=`Invest: ${n}`,m.amount=r,m.type="expense",m.category="investment",m.date=T().format("YYYY-MM-DD"),m.notes=`Modal awal investasi ${n}`,y(()=>{a.value.push({id:Date.now(),name:n,capital:r,percent:0})})}})},M=t=>{const n=t.capital*(1+t.percent/100),r=n-t.capital;C.fire({title:'<span class="text-xl font-black text-slate-800">Withdraw Aset?</span>',html:`
            <div class="bg-slate-50 rounded-2xl p-4 border border-slate-100 mb-2">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-bold text-slate-400 uppercase">Modal Awal</span>
                    <span class="text-xs font-black text-slate-600">${o(t.capital)}</span>
                </div>
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-bold text-slate-400 uppercase">Return (${t.percent}%)</span>
                    <span class="text-xs font-black ${t.percent>=0?"text-emerald-500":"text-rose-500"}">
                        ${t.percent>=0?"+":""}${o(r)}
                    </span>
                </div>
                <div class="border-t border-slate-200 my-2"></div>
                <div class="flex justify-between items-center">
                    <span class="text-[10px] font-bold text-slate-800 uppercase">Total Cair</span>
                    <span class="text-sm font-black text-indigo-600">${o(n)}</span>
                </div>
            </div>
            <p class="text-xs font-bold text-slate-400">Dana akan dikembalikan ke saldo utama.</p>
        `,icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Cairkan",cancelButtonText:"Batal",customClass:{popup:"!rounded-[2.5rem] !p-8 !border !border-slate-100 !shadow-2xl",confirmButton:"!bg-rose-500 !text-white !font-bold !py-3 !px-6 !rounded-xl !shadow-lg !shadow-rose-200 !text-xs !uppercase !tracking-widest",cancelButton:"!bg-slate-100 !text-slate-500 !font-bold !py-3 !px-6 !rounded-xl !text-xs !uppercase !tracking-widest",actions:"!mt-4 !gap-2"},backdrop:"rgba(15, 23, 42, 0.6) backdrop-blur-sm"}).then(u=>{u.isConfirmed&&(m.reset(),m.title=`Withdraw: ${t.name}`,m.amount=n,m.type="income",m.category="investment",m.date=T().format("YYYY-MM-DD"),m.notes=`Return: ${o(r)} (${t.percent}%)`,y(()=>{a.value=a.value.filter(j=>j.id!==t.id)}))})};return(t,n)=>(k(),_("div",K,[i("div",Q,[n[3]||(n[3]=i("div",{class:"absolute inset-0 bg-gradient-to-br from-indigo-600 to-indigo-900"},null,-1)),n[4]||(n[4]=i("div",{class:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-3xl group-hover:bg-white/20 transition-all duration-1000"},null,-1)),i("div",W,[i("div",G,[i("div",null,[n[0]||(n[0]=i("div",{class:"flex items-center gap-2 mb-1"},[i("span",{class:"text-lg"},"ðŸ§ª"),i("p",{class:"text-indigo-200 text-[10px] font-black uppercase tracking-[0.2em]"},"Investment Lab")],-1)),i("h4",H,v(D(o)(w.value.currentValue)),1),i("p",{class:I(["text-[10px] font-bold mt-1",w.value.totalReturn>=0?"text-emerald-300":"text-rose-300"])},v(w.value.totalReturn>=0?"+":"")+v(D(o)(w.value.totalReturn))+" (Total P/L) ",3)]),i("button",{onClick:F,class:"w-10 h-10 rounded-2xl bg-white/10 hover:bg-white/20 backdrop-blur-md flex items-center justify-center text-xl text-white border border-white/10 transition-all active:scale-95 shadow-lg"}," ï¼‹ ")]),a.value.length>0?(k(),_("div",X,[(k(!0),_(z,null,L(a.value,r=>(k(),_("div",{key:r.id,class:"bg-indigo-800/40 border border-indigo-500/20 rounded-2xl p-3 flex items-center justify-between group/card hover:bg-indigo-800/60 transition-colors"},[i("div",Z,[i("div",ee,[i("h5",te,v(r.name),1),i("span",ae,v(D(o)(r.capital)),1)]),i("div",oe,[O(i("input",{type:"number","onUpdate:modelValue":u=>r.percent=u,class:"w-10 bg-transparent border-b border-white/20 text-[10px] font-black text-center text-yellow-300 focus:outline-none focus:border-yellow-300 p-0"},null,8,se),[[P,r.percent]]),n[1]||(n[1]=i("span",{class:"text-[9px] text-indigo-300"},"% Growth",-1))])]),i("div",ne,[i("p",{class:I(["text-sm font-black tracking-tight mb-1",r.percent>=0?"text-emerald-400":"text-rose-400"])},v(D(o)(r.capital*(1+r.percent/100))),3),i("button",{onClick:u=>M(r),class:"text-[9px] font-bold text-white bg-rose-500/80 hover:bg-rose-500 px-3 py-1 rounded-lg transition-all shadow-md active:scale-95 opacity-60 group-hover/card:opacity-100"}," QUIT ",8,re)])]))),128))])):(k(),_("div",le,[...n[2]||(n[2]=[i("p",{class:"text-[10px] font-bold text-white uppercase tracking-widest"},"Lab Kosong",-1)])]))])])]))}},de=U(ie,[["__scopeId","data-v-4f7bd725"]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));export{de as F,we as a,J as u};
