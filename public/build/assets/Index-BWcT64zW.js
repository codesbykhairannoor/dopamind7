import{r as h,p as Y,q as B,s as le,a as v,b as u,d as o,u as a,Z as ne,k as re,m as k,e as r,x as T,l as ie,w as ce,o as m,y as de,F as A,z as ue}from"./vendor-vue-CkFWKx2i.js";import{_ as me}from"./AuthenticatedLayout-DJdtT3XK.js";import{d as j}from"./vendor-core-Dt3pqkYV.js";import ge from"./FinanceHeader-DC4nsu02.js";import ve from"./FinanceStats-DEhO1QmP.js";import fe from"./BudgetSidebar-BsC-tZLk.js";import pe from"./TransactionModal-u-wcIwj8.js";import he from"./BudgetModal-Dbf3mdtL.js";import be from"./CategoryModal-HU890abC.js";import xe from"./DailyTrendChart-BA-cmh6S.js";import ye from"./ArchiveModal-6WzWVMC3.js";import{u as _e,F as we}from"./FinanceInsights-oW4Utbrb.js";import Me from"./FinanceDatePicker-FsSAqhIU.js";import{N as Ce}from"./vendor-inertia-CzGZ5YH6.js";import"./vendor-utils-2VVJO3Sv.js";import{u as N}from"./useFinanceFormat-DelejsVz.js";import{u as ke}from"./useFinanceHistory-CEhLqKe1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-BPGVzs3g.js";function De(c){const{activeLocale:d}=N(),l=h(j(c)),n=Y(()=>!d||!d.value?"en":d.value.split("-")[0]),i=M=>{let g;M==="next"?g=l.value.add(1,"month"):M==="prev"?g=l.value.subtract(1,"month"):g=j(`${M}-01`),l.value=g,Ce.get(route("finance.index"),{date:g.format("YYYY-MM-DD")},{preserveState:!0,preserveScroll:!0,replace:!0,only:["transactions","budgets","stats","filters"]})},D=Y(()=>l.value.locale(n.value).format("MMMM YYYY")),$=Y(()=>l.value.format("YYYY-MM"));return{currentDate:l,changeMonth:i,formattedMonth:D,currentMonthKey:$}}const $e={class:"w-full min-h-screen bg-slate-50/50 px-4 sm:px-6 lg:px-8 py-8"},Fe={class:"mb-8"},Oe={class:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start"},Ye={class:"lg:col-span-3 space-y-8 w-full"},Be={class:"space-y-4"},je={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},Ee={class:"flex items-center gap-2"},Te={class:"text-lg font-bold text-slate-800"},Ae={key:0,class:"text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded-lg"},Ne={key:1,class:"text-[10px] font-bold text-indigo-500 bg-indigo-50 px-2 py-1 rounded-lg"},Se={class:"relative z-30"},ze={class:"flex items-center gap-2"},Le={class:"absolute right-3 text-slate-400 text-[10px]"},Ie={key:0,class:"absolute right-0 top-full mt-2 z-50 origin-top-right"},Ve={key:0,class:"text-center py-12 bg-white rounded-3xl border border-dashed border-slate-200"},Ke={class:"text-slate-400 text-sm font-medium"},Pe={key:1,class:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden divide-y divide-slate-50"},Ue=["onClick"],He={class:"flex items-center gap-4"},qe={class:"w-12 h-12 rounded-xl bg-slate-50 border border-slate-100 flex flex-col items-center justify-center group-hover:bg-white transition-all shadow-sm"},Ze={class:"text-[10px] uppercase font-black text-slate-400 leading-none"},Ge={class:"text-xl font-black leading-none text-slate-700 mt-0.5"},Je={class:"font-bold text-slate-700 text-sm capitalize"},Qe={class:"text-[11px] text-slate-400 font-bold bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100 mt-1 inline-block"},Re={class:"flex items-center gap-6"},We={class:"pl-4 border-l border-slate-100 text-right"},Xe={class:"block text-[9px] font-bold text-slate-400 uppercase tracking-wider"},et={key:0,class:"bg-slate-50/50 p-2.5 text-center border-t border-slate-100"},tt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},st={class:"lg:col-span-2 w-full md:sticky md:top-24 h-fit space-y-6"},wt=Object.assign({layout:me},{__name:"Index",props:{transactions:Array,budgets:Array,stats:Object,filters:Object,categories:Array},setup(c){const d=c,l=h([...d.transactions]),n=h([...d.budgets]),i=h([...d.categories]);B(()=>d.transactions,e=>l.value=[...e],{deep:!0}),B(()=>d.budgets,e=>n.value=[...e],{deep:!0}),B(()=>d.categories,e=>i.value=[...e],{deep:!0});const D=le({...d,get transactions(){return l.value},get budgets(){return n.value},get categories(){return i.value}}),{formattedMonth:$,changeMonth:M,currentMonthKey:g}=De(d.filters.date),{transactionForm:F,setEditTransaction:S,submitTransaction:z,deleteTransaction:L,budgetForm:f,submitBudget:I,deleteBudget:V,categoryForm:C,setEditCategory:K,submitCategory:P,deleteCategory:U,updateIncomeTarget:H}=_e(),b=h(!1),x=h(!1),y=h(!1),_=h(!1),{visibleStats:E,filterDate:p,isArchiveOpen:O,selectedDayData:q,openDetail:Z}=ke(D),{formatMoney:G}=N(),J=e=>{S(e),b.value=!0},Q=e=>{const s=i.value.find(t=>t.slug===e.category);f.id=e.id,f.category=e.category,f.name=s?s.name:e.category,f.icon=s?s.icon:"ðŸ’¸",f.limit_amount=e.limit_amount,f.month=e.month||g.value,x.value=!0},R=e=>{C.id=e.id,K(e),y.value=!0},W=()=>{C.reset(),C.id=null,y.value=!0},X=()=>{b.value=!1,z({onOptimistic:(e,s)=>{if(s){const t=l.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(l.value[t],e)}else l.value.unshift(e)},onError:(e,s)=>{s||(l.value=l.value.filter(t=>t.id!==e)),b.value=!0}})},ee=e=>{O.value=!1,L(e,{onOptimistic:s=>{l.value=l.value.filter(t=>t.id!==s)}})},te=()=>{x.value=!1,I(g.value,{onOptimistic:(e,s)=>{if(s){const t=n.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(n.value[t],e)}else n.value.push(e)},onError:(e,s)=>{s||(n.value=n.value.filter(t=>t.id!==e)),x.value=!0}})},se=e=>{V(e,{onOptimistic:s=>{n.value=n.value.filter(t=>t.id!==s)}})},oe=()=>{y.value=!1,P({onOptimistic:(e,s)=>{if(s){const t=i.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(i.value[t],e)}else i.value.push(e)},onError:(e,s)=>{s||(i.value=i.value.filter(t=>t.id!==e)),y.value=!0}})},ae=e=>{U(e,{onOptimistic:s=>{i.value=i.value.filter(t=>t.id!==s)}})};return(e,s)=>(m(),v(A,null,[u(a(ne),{title:"Finance Plan"}),o("div",null,[u(ge,{currentMonth:a($),currentMonthKey:a(g),onChangeDate:t=>a(M)(t),onAddClick:()=>{a(F).reset(),a(F).id=null,b.value=!0}},null,8,["currentMonth","currentMonthKey","onChangeDate","onAddClick"]),o("div",$e,[o("div",Fe,[u(ve,{stats:c.stats,onUpdateTarget:t=>a(H)(a(g),t)},null,8,["stats","onUpdateTarget"])]),o("div",Oe,[o("div",Ye,[o("div",Be,[o("div",je,[o("div",Ee,[o("h3",Te,r(e.$t("daily_history")),1),a(p)?(m(),v("span",Ne,r(e.$t("search_result")),1)):(m(),v("span",Ae,r(e.$t("last_5")),1))]),o("div",Se,[o("div",ze,[o("button",{onClick:s[0]||(s[0]=t=>_.value=!_.value),class:T(["pl-3 pr-8 py-2 text-xs font-bold bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-300 hover:ring-2 hover:ring-indigo-500/10 transition-all flex items-center gap-2 min-w-[150px] relative",a(p)?"text-indigo-600 border-indigo-200":"text-slate-500"])},[s[5]||(s[5]=o("span",{class:"text-base"},"ðŸ“…",-1)),o("span",null,r(a(p)?a(j)(a(p)).locale(e.$page.props.locale).format("DD MMM YYYY"):e.$t("date_filter")),1),o("span",Le,r(_.value?"â–²":"â–¼"),1)],2),a(p)?(m(),v("button",{key:0,onClick:s[1]||(s[1]=ie(t=>p.value="",["stop"])),class:"text-slate-300 hover:text-rose-500 hover:bg-rose-50 p-1.5 rounded-lg transition-all border border-transparent hover:border-rose-100",title:"Hapus Filter"},[...s[6]||(s[6]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])):k("",!0)]),u(de,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:ce(()=>[_.value?(m(),v("div",Ie,[u(Me,{show:_.value,modelValue:a(p),transactions:l.value,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value=t),onClose:s[3]||(s[3]=t=>_.value=!1)},null,8,["show","modelValue","transactions"])])):k("",!0)]),_:1})])]),l.value.length===0?(m(),v("div",Ve,[s[7]||(s[7]=o("div",{class:"text-3xl mb-2"},"ðŸ“’",-1)),o("p",Ke,r(e.$t("no_transaction")),1)])):(m(),v("div",Pe,[(m(!0),v(A,null,ue(a(E),t=>(m(),v("div",{key:t.date,onClick:w=>a(Z)(t),class:"group p-4 flex items-center justify-between hover:bg-indigo-50/50 transition-colors cursor-pointer"},[o("div",He,[o("div",qe,[o("span",Ze,r(t.dateObj.format("MMM")),1),o("span",Ge,r(t.dateObj.format("DD")),1)]),o("div",null,[o("h4",Je,r(t.dateObj.format("dddd")),1),o("span",Qe,r(e.$t("transaction_count",{count:t.transactions.length})),1)])]),o("div",Re,[o("div",We,[o("span",Xe,r(e.$t("daily_net")),1),o("span",{class:T(["text-sm font-black font-mono",t.total_income-t.total_expense>=0?"text-indigo-600":"text-orange-500"])},r(t.total_income-t.total_expense>=0?"+":"")+r(a(G)(t.total_income-t.total_expense)),3)]),s[8]||(s[8]=o("span",{class:"text-slate-300 group-hover:text-indigo-400 transition-colors"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})])],-1))])],8,Ue))),128)),!a(p)&&a(E).length===5?(m(),v("div",et,[o("p",tt,r(e.$t("old_data_hint")),1)])):k("",!0)])),u(ye,{show:a(O),dayData:a(q),categories:c.categories,close:()=>O.value=!1,onDelete:ee,onEdit:J},null,8,["show","dayData","categories","close"])]),l.value.length?(m(),re(xe,{key:0,transactions:l.value,currentDate:c.filters.date},null,8,["transactions","currentDate"])):k("",!0)]),o("div",st,[u(fe,{budgets:n.value,categories:i.value,expenseStats:c.stats.expense_by_category,incomeStats:c.stats.income_by_category,onAdd:s[4]||(s[4]=()=>{a(f).reset(),a(f).id=null,x.value=!0}),onDeleteBudget:se,onEditBudget:Q,onAddCategory:W,onEditCategory:R,onDeleteCategory:ae},null,8,["budgets","categories","expenseStats","incomeStats"]),u(we,{"expense-stats":c.stats.expense_by_category,"income-stats":c.stats.income_by_category,budgets:n.value},null,8,["expense-stats","income-stats","budgets"])])]),u(pe,{show:b.value,form:a(F),budgets:n.value,categories:c.categories,close:()=>b.value=!1,submit:X},null,8,["show","form","budgets","categories","close"]),u(he,{show:x.value,form:a(f),categories:c.categories,close:()=>x.value=!1,submit:te},null,8,["show","form","categories","close"]),u(be,{show:y.value,form:a(C),close:()=>y.value=!1,submit:oe},null,8,["show","form","close"])])])],64))}});export{wt as default};
