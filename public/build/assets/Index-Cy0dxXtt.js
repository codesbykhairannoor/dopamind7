import{r as h,q as B,s as O,x as ne,a as v,b as u,u as a,Z as re,w as A,d as o,k as ie,n as C,e as r,o as m,y as T,m as ce,z as de,F as N,A as ue}from"./vendor-vue-BpYG_UOO.js";import{_ as me}from"./AuthenticatedLayout-SdOr0uNR.js";import{d as j}from"./vendor-core-Dt3pqkYV.js";import ge from"./FinanceHeader-BJ_UewdF.js";import ve from"./FinanceStats-C2997p-r.js";import fe from"./BudgetSidebar-DBDk8hOJ.js";import pe from"./TransactionModal-BWehazcf.js";import he from"./BudgetModal-CFPmFOFP.js";import xe from"./CategoryModal-w1HFxbJ-.js";import be from"./DailyTrendChart-B1NVyaLl.js";import _e from"./ArchiveModal-C9JJn0q2.js";import{u as ye,F as we}from"./FinanceInsights-DS4srtsu.js";import Me from"./FinanceDatePicker-CeoeQ8os.js";import{N as ke}from"./vendor-inertia-CzGZ5YH6.js";import"./vendor-utils-2VVJO3Sv.js";import{u as S}from"./useFinanceFormat-CCXEDe6t.js";import{u as Ce}from"./useFinanceHistory-sxrro2pW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-DJrBW_Uw.js";function De(c){const{activeLocale:d}=S(),l=h(j(c)),n=B(()=>!d||!d.value?"en":d.value.split("-")[0]),i=M=>{let g;M==="next"?g=l.value.add(1,"month"):M==="prev"?g=l.value.subtract(1,"month"):g=j(`${M}-01`),l.value=g,ke.get(route("finance.index"),{date:g.format("YYYY-MM-DD")},{preserveState:!0,preserveScroll:!0,replace:!0,only:["transactions","budgets","stats","filters"]})},D=B(()=>l.value.locale(n.value).format("MMMM YYYY")),$=B(()=>l.value.format("YYYY-MM"));return{currentDate:l,changeMonth:i,formattedMonth:D,currentMonthKey:$}}const $e={class:"w-full min-h-screen bg-slate-50/50 px-4 sm:px-6 lg:px-8 py-8"},Fe={class:"mb-8"},Ye={class:"grid grid-cols-1 lg:grid-cols-5 gap-8 items-start"},Be={class:"lg:col-span-3 space-y-8 w-full"},Oe={class:"space-y-4"},je={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},Ee={class:"flex items-center gap-2"},Ae={class:"text-lg font-bold text-slate-800"},Te={key:0,class:"text-[10px] font-bold text-slate-400 bg-slate-100 px-2 py-1 rounded-lg"},Ne={key:1,class:"text-[10px] font-bold text-indigo-500 bg-indigo-50 px-2 py-1 rounded-lg"},Se={class:"relative z-30"},ze={class:"flex items-center gap-2"},Le={class:"absolute right-3 text-slate-400 text-[10px]"},Ie={key:0,class:"absolute right-0 top-full mt-2 z-50 origin-top-right"},Ve={key:0,class:"text-center py-12 bg-white rounded-3xl border border-dashed border-slate-200"},Ke={class:"text-slate-400 text-sm font-medium"},He={key:1,class:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden divide-y divide-slate-50"},Pe=["onClick"],Ue={class:"flex items-center gap-4"},qe={class:"w-12 h-12 rounded-xl bg-slate-50 border border-slate-100 flex flex-col items-center justify-center group-hover:bg-white transition-all shadow-sm"},Ze={class:"text-[10px] uppercase font-black text-slate-400 leading-none"},Ge={class:"text-xl font-black leading-none text-slate-700 mt-0.5"},Je={class:"font-bold text-slate-700 text-sm capitalize"},Qe={class:"text-[11px] text-slate-400 font-bold bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100 mt-1 inline-block"},Re={class:"flex items-center gap-6"},We={class:"pl-4 border-l border-slate-100 text-right"},Xe={class:"block text-[9px] font-bold text-slate-400 uppercase tracking-wider"},et={key:0,class:"bg-slate-50/50 p-2.5 text-center border-t border-slate-100"},tt={class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},st={class:"lg:col-span-2 w-full md:sticky md:top-24 h-fit space-y-6"},wt={__name:"Index",props:{transactions:Array,budgets:Array,stats:Object,filters:Object,categories:Array},setup(c){const d=c,l=h([...d.transactions]),n=h([...d.budgets]),i=h([...d.categories]);O(()=>d.transactions,e=>l.value=[...e],{deep:!0}),O(()=>d.budgets,e=>n.value=[...e],{deep:!0}),O(()=>d.categories,e=>i.value=[...e],{deep:!0});const D=ne({...d,get transactions(){return l.value},get budgets(){return n.value},get categories(){return i.value}}),{formattedMonth:$,changeMonth:M,currentMonthKey:g}=De(d.filters.date),{transactionForm:F,setEditTransaction:z,submitTransaction:L,deleteTransaction:I,budgetForm:f,submitBudget:V,deleteBudget:K,categoryForm:k,setEditCategory:H,submitCategory:P,deleteCategory:U,updateIncomeTarget:q}=ye(),x=h(!1),b=h(!1),_=h(!1),y=h(!1),{visibleStats:E,filterDate:p,isArchiveOpen:Y,selectedDayData:Z,openDetail:G}=Ce(D),{formatMoney:J}=S(),Q=e=>{z(e),x.value=!0},R=e=>{const s=i.value.find(t=>t.slug===e.category);f.id=e.id,f.category=e.category,f.name=s?s.name:e.category,f.icon=s?s.icon:"ðŸ’¸",f.limit_amount=e.limit_amount,f.month=e.month||g.value,b.value=!0},W=e=>{k.id=e.id,H(e),_.value=!0},X=()=>{k.reset(),k.id=null,_.value=!0},ee=()=>{x.value=!1,L({onOptimistic:(e,s)=>{if(s){const t=l.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(l.value[t],e)}else l.value.unshift(e)},onError:(e,s)=>{s||(l.value=l.value.filter(t=>t.id!==e)),x.value=!0}})},te=e=>{Y.value=!1,I(e,{onOptimistic:s=>{l.value=l.value.filter(t=>t.id!==s)}})},se=()=>{b.value=!1,V(g.value,{onOptimistic:(e,s)=>{if(s){const t=n.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(n.value[t],e)}else n.value.push(e)},onError:(e,s)=>{s||(n.value=n.value.filter(t=>t.id!==e)),b.value=!0}})},oe=e=>{K(e,{onOptimistic:s=>{n.value=n.value.filter(t=>t.id!==s)}})},ae=()=>{_.value=!1,P({onOptimistic:(e,s)=>{if(s){const t=i.value.findIndex(w=>w.id===e.id);t!==-1&&Object.assign(i.value[t],e)}else i.value.push(e)},onError:(e,s)=>{s||(i.value=i.value.filter(t=>t.id!==e)),_.value=!0}})},le=e=>{U(e,{onOptimistic:s=>{i.value=i.value.filter(t=>t.id!==s)}})};return(e,s)=>(m(),v(N,null,[u(a(re),{title:"Finance Plan"}),u(me,null,{default:A(()=>[u(ge,{currentMonth:a($),currentMonthKey:a(g),onChangeDate:t=>a(M)(t),onAddClick:()=>{a(F).reset(),a(F).id=null,x.value=!0}},null,8,["currentMonth","currentMonthKey","onChangeDate","onAddClick"]),o("div",$e,[o("div",Fe,[u(ve,{stats:c.stats,onUpdateTarget:t=>a(q)(a(g),t)},null,8,["stats","onUpdateTarget"])]),o("div",Ye,[o("div",Be,[o("div",Oe,[o("div",je,[o("div",Ee,[o("h3",Ae,r(e.$t("daily_history")),1),a(p)?(m(),v("span",Ne,r(e.$t("search_result")),1)):(m(),v("span",Te,r(e.$t("last_5")),1))]),o("div",Se,[o("div",ze,[o("button",{onClick:s[0]||(s[0]=t=>y.value=!y.value),class:T(["pl-3 pr-8 py-2 text-xs font-bold bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-300 hover:ring-2 hover:ring-indigo-500/10 transition-all flex items-center gap-2 min-w-[150px] relative",a(p)?"text-indigo-600 border-indigo-200":"text-slate-500"])},[s[5]||(s[5]=o("span",{class:"text-base"},"ðŸ“…",-1)),o("span",null,r(a(p)?a(j)(a(p)).locale(e.$page.props.locale).format("DD MMM YYYY"):e.$t("date_filter")),1),o("span",Le,r(y.value?"â–²":"â–¼"),1)],2),a(p)?(m(),v("button",{key:0,onClick:s[1]||(s[1]=ce(t=>p.value="",["stop"])),class:"text-slate-300 hover:text-rose-500 hover:bg-rose-50 p-1.5 rounded-lg transition-all border border-transparent hover:border-rose-100",title:"Hapus Filter"},[...s[6]||(s[6]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])):C("",!0)]),u(de,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:A(()=>[y.value?(m(),v("div",Ie,[u(Me,{show:y.value,modelValue:a(p),transactions:l.value,"onUpdate:modelValue":s[2]||(s[2]=t=>p.value=t),onClose:s[3]||(s[3]=t=>y.value=!1)},null,8,["show","modelValue","transactions"])])):C("",!0)]),_:1})])]),l.value.length===0?(m(),v("div",Ve,[s[7]||(s[7]=o("div",{class:"text-3xl mb-2"},"ðŸ“’",-1)),o("p",Ke,r(e.$t("no_transaction")),1)])):(m(),v("div",He,[(m(!0),v(N,null,ue(a(E),t=>(m(),v("div",{key:t.date,onClick:w=>a(G)(t),class:"group p-4 flex items-center justify-between hover:bg-indigo-50/50 transition-colors cursor-pointer"},[o("div",Ue,[o("div",qe,[o("span",Ze,r(t.dateObj.format("MMM")),1),o("span",Ge,r(t.dateObj.format("DD")),1)]),o("div",null,[o("h4",Je,r(t.dateObj.format("dddd")),1),o("span",Qe,r(e.$t("transaction_count",{count:t.transactions.length})),1)])]),o("div",Re,[o("div",We,[o("span",Xe,r(e.$t("daily_net")),1),o("span",{class:T(["text-sm font-black font-mono",t.total_income-t.total_expense>=0?"text-indigo-600":"text-orange-500"])},r(t.total_income-t.total_expense>=0?"+":"")+r(a(J)(t.total_income-t.total_expense)),3)]),s[8]||(s[8]=o("span",{class:"text-slate-300 group-hover:text-indigo-400 transition-colors"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})])],-1))])],8,Pe))),128)),!a(p)&&a(E).length===5?(m(),v("div",et,[o("p",tt,r(e.$t("old_data_hint")),1)])):C("",!0)])),u(_e,{show:a(Y),dayData:a(Z),categories:c.categories,close:()=>Y.value=!1,onDelete:te,onEdit:Q},null,8,["show","dayData","categories","close"])]),l.value.length?(m(),ie(be,{key:0,transactions:l.value,currentDate:c.filters.date},null,8,["transactions","currentDate"])):C("",!0)]),o("div",st,[u(fe,{budgets:n.value,categories:i.value,expenseStats:c.stats.expense_by_category,incomeStats:c.stats.income_by_category,onAdd:s[4]||(s[4]=()=>{a(f).reset(),a(f).id=null,b.value=!0}),onDeleteBudget:oe,onEditBudget:R,onAddCategory:X,onEditCategory:W,onDeleteCategory:le},null,8,["budgets","categories","expenseStats","incomeStats"]),u(we,{"expense-stats":c.stats.expense_by_category,"income-stats":c.stats.income_by_category,budgets:n.value},null,8,["expense-stats","income-stats","budgets"])])]),u(pe,{show:x.value,form:a(F),budgets:n.value,categories:c.categories,close:()=>x.value=!1,submit:ee},null,8,["show","form","budgets","categories","close"]),u(he,{show:b.value,form:a(f),categories:c.categories,close:()=>b.value=!1,submit:se},null,8,["show","form","categories","close"]),u(xe,{show:_.value,form:a(k),close:()=>_.value=!1,submit:ae},null,8,["show","form","close"])])]),_:1})],64))}};export{wt as default};
