import{T as N,y as R,N as Y,r as q,z,k as P,h as A,c as _,b as l,t as y,u as I,n as $,F as L,p as U,o as k,j as J,q as K}from"./app-DBmEpP_-.js";import{u as O}from"./useFinanceFormat-CB7TYyOT.js";import{d as B}from"./dayjs.min-Z4LNoRjb.js";import{S as C}from"./sweetalert2.esm.all-AlKuj1Cq.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function W(){const{cleanAmount:b}=O(),i=(e,s)=>{const c=R(e);return c!==e?c:s},r=(e,s)=>{C.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,background:"#4f46e5",iconColor:"#ffffff",icon:e,title:`<span style="color: white; font-weight: 900; font-size: 14px; line-height: 1.2;">${s}</span>`,customClass:{container:"!fixed !top-5 !right-5 !p-0 !z-[100000] !items-start !justify-end",popup:"!flex !items-center !gap-3 !py-3 !px-6 !rounded-full !shadow-2xl !border-none !m-0 !w-auto !min-w-[280px]",timerProgressBar:"!bg-white/40 !h-1 !rounded-b-full"}})},S={customClass:{popup:"rounded-[2.5rem] p-8 border border-slate-100 shadow-2xl",title:"text-2xl font-black text-slate-800 mb-2 font-sans",confirmButton:"bg-indigo-600 text-white font-bold py-3.5 px-8 rounded-2xl shadow-xl active:scale-95 transition-all outline-none mx-2 tracking-wide",cancelButton:"bg-slate-50 text-slate-400 font-bold py-3.5 px-8 rounded-2xl hover:bg-slate-100 active:scale-95 transition-all outline-none mx-2 tracking-wide",actions:"mt-6 gap-3"},buttonsStyling:!1,focusConfirm:!1},h=(e,s)=>C.fire({...S,title:i(e,s),icon:"warning",showCancelButton:!0,confirmButtonText:i("btn_yes_delete","Yes, Delete!"),cancelButtonText:i("btn_cancel","Cancel"),customClass:{...S.customClass,confirmButton:"bg-rose-500 text-white font-bold py-3.5 px-8 rounded-2xl shadow-xl shadow-rose-200"}}),t=N({id:null,title:"",amount:"",type:"expense",category:"",date:B().format("YYYY-MM-DD"),notes:""}),f=e=>{t.id=e.id,t.title=e.title??"",t.amount=e.amount,t.type=e.type,t.category=e.category,t.date=e.date,t.notes=e.notes??""},w=({onOptimistic:e,onSuccess:s,onError:c})=>{if(!t.title||t.title.trim()==="")return r("warning",i("warn_empty_title","Title is required!"));if(!t.amount||b(t.amount)<=0)return r("warning",i("warn_empty_amount","Amount required!"));if(!t.category)return r("warning",i("warn_empty_category","Please select a category!"));const d={...t.data()},u=!!d.id,g=u?d.id:"temp_"+Date.now(),x=u?route("finance.transaction.update",d.id):route("finance.transaction.store"),T=u?"patch":"post";e&&e({...d,id:g,amount:b(d.amount),created_at:new Date().toISOString()},u),t.transform(v=>({...v,amount:b(v.amount)}))[T](x,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{t.reset(),t.date=B().format("YYYY-MM-DD"),s&&s(),r("success",i("success_saved","Saved successfully!"))},onError:v=>{c&&c(g,u),r("error",Object.values(v)[0])}})},M=(e,{onOptimistic:s,onSuccess:c,onError:d})=>{h("delete_trx_title","Delete Transaction?").then(u=>{u.isConfirmed&&(s&&s(e),Y.delete(route("finance.transaction.destroy",e),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{c&&c(),r("success",i("success_deleted","Deleted!"))},onError:()=>{d&&d(e),r("error","Failed to delete data")}}))})},p=N({id:null,category:"",name:"",icon:"ðŸ’¸",limit_amount:"",month:""}),o=(e,{onOptimistic:s,onSuccess:c,onError:d})=>{if(p.month=e,!p.name)return r("warning",i("warn_empty_budget_name","Enter budget name!"));const u=b(p.limit_amount);if(!u||u<=0)return r("warning",i("warn_empty_amount","Valid amount required!"));!p.category&&p.name&&(p.category=p.name.toLowerCase().replace(/\s+/g,"_"));const g={...p.data()},x=!!g.id,T=x?g.id:"temp_"+Date.now(),v=x?route("finance.budget.update",g.id):route("finance.budget.store"),E=x?"put":"post";s&&s({...g,id:T,limit_amount:u},x),p.transform(j=>({...j,limit_amount:b(j.limit_amount)}))[E](v,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{p.reset(),c&&c(),r("success",i("success_saved","Budget updated!"))},onError:j=>{d&&d(T,x),r("error",Object.values(j)[0])}})},n=(e,{onOptimistic:s,onSuccess:c,onError:d})=>{h("delete_budget_title","Delete Budget?").then(u=>{u.isConfirmed&&(s&&s(e),Y.delete(route("finance.budget.destroy",e),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{c&&c(),r("success",i("success_deleted","Budget removed!"))},onError:()=>{d&&d(e)}}))})},a=N({name:"",icon:"ðŸ’°",type:"income"});return{transactionForm:t,setEditTransaction:f,submitTransaction:w,deleteTransaction:M,budgetForm:p,submitBudget:o,deleteBudget:n,categoryForm:a,setEditCategory:e=>{a.name=e.name,a.icon=e.icon},submitCategory:(e,s)=>{if(!a.name)return r("warning",i("warn_empty_category_name","Name required!"));const c=e?route("finance.categories.update",e.id):route("finance.categories.store");a[e?"put":"post"](c,{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{a.reset(),s&&s(),r("success",i("success_saved","Category saved!"))},onError:u=>r("error",Object.values(u)[0])})},deleteCategory:(e,s)=>{h("confirm_delete_title","Are you sure?").then(c=>{c.isConfirmed&&Y.delete(route("finance.categories.destroy",e),{preserveScroll:!0,preserveState:!0,progress:!1,onSuccess:()=>{s&&s(),r("success",i("success_deleted","Deleted!"))}})})},updateIncomeTarget:(e,s)=>{Y.post(route("finance.income-target.update"),{month:e,amount:s},{preserveScroll:!0,preserveState:!0,progress:!1})},t:i}}const G={class:"mt-6 space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-700"},H={class:"bg-indigo-900 rounded-[2.5rem] p-1 shadow-2xl shadow-indigo-200/50 relative overflow-hidden group"},X={class:"relative z-10 p-6"},Z={class:"flex justify-between items-start mb-6"},ee={class:"text-2xl font-black text-white tracking-tighter"},te={key:0,class:"space-y-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-1"},ae={class:"flex-1 min-w-0 mr-3"},oe={class:"flex items-center gap-2 mb-1"},se={class:"text-xs font-black text-white truncate"},ne={class:"text-[9px] font-bold px-1.5 py-0.5 rounded bg-white/10 text-white/70"},re={class:"flex items-center gap-2"},le=["onUpdate:modelValue"],ie={class:"text-right"},ce=["onClick"],de={key:1,class:"py-8 text-center border-2 border-dashed border-white/10 rounded-3xl opacity-50"},ue={__name:"FinanceInsights",props:{expenseStats:{type:Object,default:()=>({})},incomeStats:{type:Object,default:()=>({})},budgets:{type:Array,default:()=>[]}},setup(b){const i=b,{formatMoney:r,cleanAmount:S}=O(),{submitTransaction:h,transactionForm:t}=W(),f=q([]);z(()=>{const o=localStorage.getItem("OneForMind_assets");o&&(f.value=JSON.parse(o))}),P(f,o=>localStorage.setItem("OneForMind_assets",JSON.stringify(o)),{deep:!0}),A(()=>{const o=B(),n=o.endOf("month").date(),a=n-o.date()+1,m=Object.values(i.incomeStats).reduce((e,s)=>Number(e)+Number(s),0)||0,D=Object.values(i.expenseStats).reduce((e,s)=>Number(e)+Number(s),0)||0,F=m-D;return{safeDaily:F>0?F/a:0,remainingDays:a,progress:o.date()/n*100}});const w=A(()=>{const o=f.value.reduce((a,m)=>a+Number(m.capital)*(1+Number(m.percent)/100),0),n=f.value.reduce((a,m)=>a+Number(m.capital),0);return{currentValue:o,totalReturn:o-n}}),M=()=>{C.fire({title:'<span class="text-xl font-black text-slate-800">Alokasi Aset Baru</span>',html:`
            <div class="flex flex-col gap-3 text-left">
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1">Nama Aset</label>
                    <input id="swal-name" class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm font-bold text-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all" placeholder="Contoh: Saham BBCA">
                </div>
                <div>
                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-1">Modal (Rp)</label>
                    <input id="swal-capital" type="number" class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm font-bold text-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all" placeholder="0">
                    <p class="text-[10px] text-rose-500 mt-1 font-bold italic">*Akan tercatat sebagai Pengeluaran.</p>
                </div>
            </div>
        `,showCancelButton:!0,confirmButtonText:"Konfirmasi & Bayar",cancelButtonText:"Batal",customClass:{popup:"!rounded-[2.5rem] !p-8 !border !border-slate-100 !shadow-2xl",confirmButton:"!bg-indigo-600 !text-white !font-bold !py-3 !px-6 !rounded-xl !shadow-lg !shadow-indigo-200 !text-xs !uppercase !tracking-widest",cancelButton:"!bg-slate-100 !text-slate-500 !font-bold !py-3 !px-6 !rounded-xl !text-xs !uppercase !tracking-widest",actions:"!mt-6 !gap-2"},backdrop:"rgba(15, 23, 42, 0.6) backdrop-blur-sm",preConfirm:()=>{const o=document.getElementById("swal-name").value,n=document.getElementById("swal-capital").value,a=S(n);return!o||a<=0?(C.showValidationMessage("Nama dan Modal wajib diisi!"),!1):{name:o,capital:a}}}).then(o=>{if(o.isConfirmed){const{name:n,capital:a}=o.value;t.reset(),t.title=`Invest: ${n}`,t.amount=a,t.type="expense",t.category="investment",t.date=B().format("YYYY-MM-DD"),t.notes=`Modal awal investasi ${n}`,h(()=>{f.value.push({id:Date.now(),name:n,capital:a,percent:0})})}})},p=o=>{const n=o.capital*(1+o.percent/100),a=n-o.capital;C.fire({title:'<span class="text-xl font-black text-slate-800">Withdraw Aset?</span>',html:`
            <div class="bg-slate-50 rounded-2xl p-4 border border-slate-100 mb-2">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-bold text-slate-400 uppercase">Modal Awal</span>
                    <span class="text-xs font-black text-slate-600">${r(o.capital)}</span>
                </div>
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-bold text-slate-400 uppercase">Return (${o.percent}%)</span>
                    <span class="text-xs font-black ${o.percent>=0?"text-emerald-500":"text-rose-500"}">
                        ${o.percent>=0?"+":""}${r(a)}
                    </span>
                </div>
                <div class="border-t border-slate-200 my-2"></div>
                <div class="flex justify-between items-center">
                    <span class="text-[10px] font-bold text-slate-800 uppercase">Total Cair</span>
                    <span class="text-sm font-black text-indigo-600">${r(n)}</span>
                </div>
            </div>
            <p class="text-xs font-bold text-slate-400">Dana akan dikembalikan ke saldo utama.</p>
        `,icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Cairkan",cancelButtonText:"Batal",customClass:{popup:"!rounded-[2.5rem] !p-8 !border !border-slate-100 !shadow-2xl",confirmButton:"!bg-rose-500 !text-white !font-bold !py-3 !px-6 !rounded-xl !shadow-lg !shadow-rose-200 !text-xs !uppercase !tracking-widest",cancelButton:"!bg-slate-100 !text-slate-500 !font-bold !py-3 !px-6 !rounded-xl !text-xs !uppercase !tracking-widest",actions:"!mt-4 !gap-2"},backdrop:"rgba(15, 23, 42, 0.6) backdrop-blur-sm"}).then(m=>{m.isConfirmed&&(t.reset(),t.title=`Withdraw: ${o.name}`,t.amount=n,t.type="income",t.category="investment",t.date=B().format("YYYY-MM-DD"),t.notes=`Return: ${r(a)} (${o.percent}%)`,h(()=>{f.value=f.value.filter(D=>D.id!==o.id)}))})};return(o,n)=>(k(),_("div",G,[l("div",H,[n[3]||(n[3]=l("div",{class:"absolute inset-0 bg-gradient-to-br from-indigo-600 to-indigo-900"},null,-1)),n[4]||(n[4]=l("div",{class:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-3xl group-hover:bg-white/20 transition-all duration-1000"},null,-1)),l("div",X,[l("div",Z,[l("div",null,[n[0]||(n[0]=l("div",{class:"flex items-center gap-2 mb-1"},[l("span",{class:"text-lg"},"ðŸ§ª"),l("p",{class:"text-indigo-200 text-[10px] font-black uppercase tracking-[0.2em]"},"Investment Lab")],-1)),l("h4",ee,y(I(r)(w.value.currentValue)),1),l("p",{class:$(["text-[10px] font-bold mt-1",w.value.totalReturn>=0?"text-emerald-300":"text-rose-300"])},y(w.value.totalReturn>=0?"+":"")+y(I(r)(w.value.totalReturn))+" (Total P/L) ",3)]),l("button",{onClick:M,class:"w-10 h-10 rounded-2xl bg-white/10 hover:bg-white/20 backdrop-blur-md flex items-center justify-center text-xl text-white border border-white/10 transition-all active:scale-95 shadow-lg"}," ï¼‹ ")]),f.value.length>0?(k(),_("div",te,[(k(!0),_(L,null,U(f.value,a=>(k(),_("div",{key:a.id,class:"bg-indigo-800/40 border border-indigo-500/20 rounded-2xl p-3 flex items-center justify-between group/card hover:bg-indigo-800/60 transition-colors"},[l("div",ae,[l("div",oe,[l("h5",se,y(a.name),1),l("span",ne,y(I(r)(a.capital)),1)]),l("div",re,[J(l("input",{type:"number","onUpdate:modelValue":m=>a.percent=m,class:"w-10 bg-transparent border-b border-white/20 text-[10px] font-black text-center text-yellow-300 focus:outline-none focus:border-yellow-300 p-0"},null,8,le),[[K,a.percent]]),n[1]||(n[1]=l("span",{class:"text-[9px] text-indigo-300"},"% Growth",-1))])]),l("div",ie,[l("p",{class:$(["text-sm font-black tracking-tight mb-1",a.percent>=0?"text-emerald-400":"text-rose-400"])},y(I(r)(a.capital*(1+a.percent/100))),3),l("button",{onClick:m=>p(a),class:"text-[9px] font-bold text-white bg-rose-500/80 hover:bg-rose-500 px-3 py-1 rounded-lg transition-all shadow-md active:scale-95 opacity-60 group-hover/card:opacity-100"}," QUIT ",8,ce)])]))),128))])):(k(),_("div",de,[...n[2]||(n[2]=[l("p",{class:"text-[10px] font-bold text-white uppercase tracking-widest"},"Lab Kosong",-1)])]))])])]))}},pe=Q(ue,[["__scopeId","data-v-8db54104"]]),he=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{pe as F,he as a,W as u};
